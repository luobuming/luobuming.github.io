<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        网鼎杯第一场RE - 萝卜
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
     你若盛开，清风自来！ 
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            萝卜
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#beijing"><span class="toc-text">beijing</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#拿到题目后发现是一个ELF文件，然后放到Linux上运行，发现返回的是乱码。"><span class="toc-text">拿到题目后发现是一个ELF文件，然后放到Linux上运行，发现返回的是乱码。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#放进IDA中-f5查看main伪代码："><span class="toc-text">放进IDA中,f5查看main伪代码：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#发现都是经过sub-8048460-加密后再输出的。然后查看sub-8048460"><span class="toc-text">发现都是经过sub_8048460()加密后再输出的。然后查看sub_8048460():</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#当我在做题的时候我以为是将flag的每一位传进这个加密函数进行加密，谁知到了最后不是这样的，经过我们队大师指点后才知道这是一个脑洞题，其实flag就藏在被异或的数据里面，通过一段数据将flag藏在里面，其中有3位数据是没有的，需要才出来，数据如下："><span class="toc-text">当我在做题的时候我以为是将flag的每一位传进这个加密函数进行加密，谁知到了最后不是这样的，经过我们队大师指点后才知道这是一个脑洞题，其实flag就藏在被异或的数据里面，通过一段数据将flag藏在里面，其中有3位数据是没有的，需要才出来，数据如下：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#最后的解体脚本如下："><span class="toc-text">最后的解体脚本如下：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag：flag-amazing-beijing"><span class="toc-text">flag：flag{amazing_beijing}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#advanced"><span class="toc-text">advanced</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#在Linux上运行一下发现返回的是一串数字。"><span class="toc-text">在Linux上运行一下发现返回的是一串数字。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#一开始怎么想也想不到这是将flag异或之后返回的结果，可能这就是经验吧，flag的前四位肯定是flag，所以来寻找规律。"><span class="toc-text">一开始怎么想也想不到这是将flag异或之后返回的结果，可能这就是经验吧，flag的前四位肯定是flag，所以来寻找规律。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#发现字符串索引为偶数的是和45进行异或，奇数是与44异或，这就是规律。解题脚本："><span class="toc-text">发现字符串索引为偶数的是和45进行异或，奇数是与44异或，这就是规律。解题脚本：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag-flag-d-with-a-template-phew"><span class="toc-text">flag: flag{d_with_a_template_phew}</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 你若盛开，清风自来！ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        网鼎杯第一场RE
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2018-09-02 13:04:28</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#WP" title="WP">WP</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <p>200强！哈哈<br><a id="more"></a></p>
<h3 id="beijing"><a href="#beijing" class="headerlink" title="beijing"></a>beijing</h3><h4 id="拿到题目后发现是一个ELF文件，然后放到Linux上运行，发现返回的是乱码。"><a href="#拿到题目后发现是一个ELF文件，然后放到Linux上运行，发现返回的是乱码。" class="headerlink" title="拿到题目后发现是一个ELF文件，然后放到Linux上运行，发现返回的是乱码。"></a>拿到题目后发现是一个ELF文件，然后放到Linux上运行，发现返回的是乱码。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/tools# ./beijing </span><br><span class="line">R-&gt;�-�-�@,o@�@,&gt;�</span><br></pre></td></tr></table></figure>
<h4 id="放进IDA中-f5查看main伪代码："><a href="#放进IDA中-f5查看main伪代码：" class="headerlink" title="放进IDA中,f5查看main伪代码："></a>放进IDA中,f5查看main伪代码：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main()</span><br><span class="line">&#123;</span><br><span class="line">  char v0; // al</span><br><span class="line">  char v1; // al</span><br><span class="line">  char v2; // al</span><br><span class="line">  char v3; // al</span><br><span class="line">  char v4; // al</span><br><span class="line">  char v5; // al</span><br><span class="line">  char v6; // al</span><br><span class="line">  char v7; // al</span><br><span class="line">  char v8; // al</span><br><span class="line">  char v9; // al</span><br><span class="line">  char v10; // al</span><br><span class="line">  char v11; // al</span><br><span class="line">  char v12; // al</span><br><span class="line">  char v13; // al</span><br><span class="line">  char v14; // al</span><br><span class="line">  char v15; // al</span><br><span class="line">  char v16; // al</span><br><span class="line">  char v17; // al</span><br><span class="line">  char v18; // al</span><br><span class="line">  char v19; // al</span><br><span class="line">  char v20; // al</span><br><span class="line"></span><br><span class="line">  v0 = sub_8048460(dword_804A03C);</span><br><span class="line">  printf(&quot;%c&quot;, v0);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v1 = sub_8048460(dword_804A044);</span><br><span class="line">  printf(&quot;%c&quot;, v1);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v2 = sub_8048460(dword_804A0E0);</span><br><span class="line">  printf(&quot;%c&quot;, v2);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v3 = sub_8048460(dword_804A050);</span><br><span class="line">  printf(&quot;%c&quot;, v3);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v4 = sub_8048460(dword_804A058);</span><br><span class="line">  printf(&quot;%c&quot;, v4);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v5 = sub_8048460(dword_804A0E4);</span><br><span class="line">  printf(&quot;%c&quot;, v5);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v6 = sub_8048460(dword_804A064);</span><br><span class="line">  printf(&quot;%c&quot;, v6);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v7 = sub_8048460(dword_804A0E8);</span><br><span class="line">  printf(&quot;%c&quot;, v7);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v8 = sub_8048460(dword_804A070);</span><br><span class="line">  printf(&quot;%c&quot;, v8);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v9 = sub_8048460(dword_804A078);</span><br><span class="line">  printf(&quot;%c&quot;, v9);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v10 = sub_8048460(dword_804A080);</span><br><span class="line">  printf(&quot;%c&quot;, v10);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v11 = sub_8048460(dword_804A088);</span><br><span class="line">  printf(&quot;%c&quot;, v11);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v12 = sub_8048460(dword_804A090);</span><br><span class="line">  printf(&quot;%c&quot;, v12);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v13 = sub_8048460(dword_804A098);</span><br><span class="line">  printf(&quot;%c&quot;, v13);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v14 = sub_8048460(dword_804A0A0);</span><br><span class="line">  printf(&quot;%c&quot;, v14);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v15 = sub_8048460(dword_804A0A8);</span><br><span class="line">  printf(&quot;%c&quot;, v15);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v16 = sub_8048460(dword_804A0B0);</span><br><span class="line">  printf(&quot;%c&quot;, v16);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v17 = sub_8048460(dword_804A0B8);</span><br><span class="line">  printf(&quot;%c&quot;, v17);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v18 = sub_8048460(dword_804A0C0);</span><br><span class="line">  printf(&quot;%c&quot;, v18);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v19 = sub_8048460(dword_804A0C8);</span><br><span class="line">  printf(&quot;%c&quot;, v19);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  v20 = sub_8048460(dword_804A0D0);</span><br><span class="line">  printf(&quot;%c&quot;, v20);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">  printf(&quot;\n&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="发现都是经过sub-8048460-加密后再输出的。然后查看sub-8048460"><a href="#发现都是经过sub-8048460-加密后再输出的。然后查看sub-8048460" class="headerlink" title="发现都是经过sub_8048460()加密后再输出的。然后查看sub_8048460():"></a>发现都是经过sub_8048460()加密后再输出的。然后查看sub_8048460():</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl sub_8048460(int a1)</span><br><span class="line">&#123;</span><br><span class="line">  char v2; // [esp+Fh] [ebp-1h]</span><br><span class="line"></span><br><span class="line">  switch ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    case 0:</span><br><span class="line">      v2 = byte_804A021 ^ byte_804A020;</span><br><span class="line">      break;</span><br><span class="line">    case 1:</span><br><span class="line">      v2 = byte_804A023 ^ byte_804A022;</span><br><span class="line">      break;</span><br><span class="line">    case 2:</span><br><span class="line">      v2 = byte_804A025 ^ byte_804A024;</span><br><span class="line">      break;</span><br><span class="line">    case 3:</span><br><span class="line">      v2 = byte_804A027 ^ byte_804A026;</span><br><span class="line">      break;</span><br><span class="line">    case 4:</span><br><span class="line">      v2 = byte_804A029 ^ byte_804A028;</span><br><span class="line">      break;</span><br><span class="line">    case 5:</span><br><span class="line">      v2 = byte_804A02B ^ byte_804A02A;</span><br><span class="line">      break;</span><br><span class="line">    case 6:</span><br><span class="line">      v2 = byte_804A02D ^ byte_804A02C;</span><br><span class="line">      break;</span><br><span class="line">    case 7:</span><br><span class="line">      v2 = byte_804A02F ^ byte_804A02E;</span><br><span class="line">      break;</span><br><span class="line">    case 8:</span><br><span class="line">      v2 = byte_804A031 ^ byte_804A030;</span><br><span class="line">      break;</span><br><span class="line">    case 9:</span><br><span class="line">      v2 = byte_804A033 ^ byte_804A032;</span><br><span class="line">      break;</span><br><span class="line">    case 10:</span><br><span class="line">      v2 = byte_804A035 ^ byte_804A034;</span><br><span class="line">      break;</span><br><span class="line">    case 11:</span><br><span class="line">      v2 = byte_804A037 ^ byte_804A036;</span><br><span class="line">      break;</span><br><span class="line">    case 12:</span><br><span class="line">      v2 = byte_804A039 ^ byte_804A038;</span><br><span class="line">      break;</span><br><span class="line">    case 13:</span><br><span class="line">      v2 = byte_804A03B ^ byte_804A03A;</span><br><span class="line">      break;</span><br><span class="line">    default:</span><br><span class="line">      v2 = 0;</span><br><span class="line">      break;</span><br><span class="line">  &#125;</span><br><span class="line">  return v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="当我在做题的时候我以为是将flag的每一位传进这个加密函数进行加密，谁知到了最后不是这样的，经过我们队大师指点后才知道这是一个脑洞题，其实flag就藏在被异或的数据里面，通过一段数据将flag藏在里面，其中有3位数据是没有的，需要才出来，数据如下："><a href="#当我在做题的时候我以为是将flag的每一位传进这个加密函数进行加密，谁知到了最后不是这样的，经过我们队大师指点后才知道这是一个脑洞题，其实flag就藏在被异或的数据里面，通过一段数据将flag藏在里面，其中有3位数据是没有的，需要才出来，数据如下：" class="headerlink" title="当我在做题的时候我以为是将flag的每一位传进这个加密函数进行加密，谁知到了最后不是这样的，经过我们队大师指点后才知道这是一个脑洞题，其实flag就藏在被异或的数据里面，通过一段数据将flag藏在里面，其中有3位数据是没有的，需要才出来，数据如下："></a>当我在做题的时候我以为是将flag的每一位传进这个加密函数进行加密，谁知到了最后不是这样的，经过我们队大师指点后才知道这是一个脑洞题，其实flag就藏在被异或的数据里面，通过一段数据将flag藏在里面，其中有3位数据是没有的，需要才出来，数据如下：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">.data:0804A020 byte_804A020    db 61h                  ; DATA XREF: sub_8048460:loc_804848Cr</span><br><span class="line">.data:0804A021 byte_804A021    db 4Ch                  ; DATA XREF: sub_8048460+33r</span><br><span class="line">.data:0804A022 byte_804A022    db 67h                  ; DATA XREF: sub_8048460:loc_80484A6r</span><br><span class="line">.data:0804A023 byte_804A023    db 59h                  ; DATA XREF: sub_8048460+4Dr</span><br><span class="line">.data:0804A024 byte_804A024    db 69h                  ; DATA XREF: sub_8048460:loc_80484C0r</span><br><span class="line">.data:0804A025 byte_804A025    db 29h                  ; DATA XREF: sub_8048460+67r</span><br><span class="line">.data:0804A026 byte_804A026    db 6Eh                  ; DATA XREF: sub_8048460:loc_80484DAr</span><br><span class="line">.data:0804A027 byte_804A027    db 42h                  ; DATA XREF: sub_8048460+81r</span><br><span class="line">.data:0804A028 byte_804A028    db 62h                  ; DATA XREF: sub_8048460:loc_80484F4r</span><br><span class="line">.data:0804A029 byte_804A029    db 0Dh                  ; DATA XREF: sub_8048460+9Br</span><br><span class="line">.data:0804A02A byte_804A02A    db 65h                  ; DATA XREF: sub_8048460:loc_804850Er</span><br><span class="line">.data:0804A02B byte_804A02B    db 71h                  ; DATA XREF: sub_8048460+B5r</span><br><span class="line">.data:0804A02C byte_804A02C    db 66h                  ; DATA XREF: sub_8048460:loc_8048528r</span><br><span class="line">.data:0804A02D byte_804A02D    db 34h                  ; DATA XREF: sub_8048460+CFr</span><br><span class="line">.data:0804A02E byte_804A02E    db 6Ah                  ; DATA XREF: sub_8048460:loc_8048542r</span><br><span class="line">.data:0804A02F byte_804A02F    db C6h                 ; DATA XREF: sub_8048460+E9r</span><br><span class="line">.data:0804A030 byte_804A030    db 6Dh                  ; DATA XREF: sub_8048460:loc_804855Cr</span><br><span class="line">.data:0804A031 byte_804A031    db 8Ah                  ; DATA XREF: sub_8048460+103r</span><br><span class="line">.data:0804A032 byte_804A032    db 6Ch                  ; DATA XREF: sub_8048460:loc_8048576r</span><br><span class="line">.data:0804A033 byte_804A033    db 7Fh                  ; DATA XREF: sub_8048460+11Dr</span><br><span class="line">.data:0804A034 byte_804A034    db 7Bh                  ; DATA XREF: sub_8048460:loc_8048590r</span><br><span class="line">.data:0804A035 byte_804A035    db AEh                 ; DATA XREF: sub_8048460+137r</span><br><span class="line">.data:0804A036 byte_804A036    db 7Ah                  ; DATA XREF: sub_8048460:loc_80485AAr</span><br><span class="line">.data:0804A037 byte_804A037    db 92h                  ; DATA XREF: sub_8048460+151r</span><br><span class="line">.data:0804A038 byte_804A038    db 7Dh                  ; DATA XREF: sub_8048460:loc_80485C4r</span><br><span class="line">.data:0804A039 byte_804A039    db ECh                 ; DATA XREF: sub_8048460+16Br</span><br><span class="line">.data:0804A03A byte_804A03A    db 5Fh                  ; DATA XREF: sub_8048460:loc_80485DEr</span><br><span class="line">.data:0804A03B byte_804A03B    db 57h</span><br></pre></td></tr></table></figure>
<h4 id="最后的解体脚本如下："><a href="#最后的解体脚本如下：" class="headerlink" title="最后的解体脚本如下："></a>最后的解体脚本如下：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">f = open(&quot;data.txt&quot;,&quot;r&quot;)</span><br><span class="line">list_1 = []</span><br><span class="line">while True:</span><br><span class="line">	s1 = f.readline()</span><br><span class="line">	if not s1 :</span><br><span class="line">		break</span><br><span class="line">	list_1.append(s1[34:36])</span><br><span class="line"># print len(list_1)</span><br><span class="line">list_2 = []</span><br><span class="line">for x in list_1:</span><br><span class="line">	x = &quot;0x&quot;+x</span><br><span class="line">	x = eval(x)</span><br><span class="line">	list_2.append(x)</span><br><span class="line">#print list_2</span><br><span class="line">current = []</span><br><span class="line">for x in range(0,len(list_1),2):</span><br><span class="line">	current.append(list_2[x])</span><br><span class="line">#print current</span><br><span class="line">for x in range(len(current)):</span><br><span class="line">	current[x] = chr(current[x])</span><br><span class="line">#print current</span><br><span class="line">list_a1 = [6,9,0,1,10,0,8,0,11,2,3,1,13,4,5,2,7,2,3,1,12]</span><br><span class="line">#print len(list_a1)</span><br><span class="line">flag = []</span><br><span class="line">for x in list_a1:</span><br><span class="line">	if x==0:</span><br><span class="line">		flag.append(current[0])</span><br><span class="line">	elif x==1:</span><br><span class="line">		flag.append(current[1])</span><br><span class="line">	elif x==2:</span><br><span class="line">		flag.append(current[2])</span><br><span class="line">	elif x==3:</span><br><span class="line">		flag.append(current[3])</span><br><span class="line">	elif x==4:</span><br><span class="line">		flag.append(current[4])</span><br><span class="line">	elif x==5:</span><br><span class="line">		flag.append(current[5])</span><br><span class="line">	elif x==6:</span><br><span class="line">		flag.append(current[6])</span><br><span class="line">	elif x==7:</span><br><span class="line">		flag.append(current[7])</span><br><span class="line">	elif x==8:</span><br><span class="line">		flag.append(current[8])</span><br><span class="line">	elif x==9:</span><br><span class="line">		flag.append(current[9])</span><br><span class="line">	elif x==10:</span><br><span class="line">		flag.append(current[10])</span><br><span class="line">	elif x==11:</span><br><span class="line">		flag.append(current[11])</span><br><span class="line">	elif x==12:</span><br><span class="line">		flag.append(current[12])</span><br><span class="line">	elif x==13:</span><br><span class="line">		flag.append(current[13])</span><br><span class="line">	else:</span><br><span class="line">		flag.append(0)</span><br><span class="line">#print flag</span><br><span class="line"></span><br><span class="line">Answer = &quot;&quot;</span><br><span class="line">for x in flag:</span><br><span class="line">	Answer += x</span><br><span class="line">print Answer</span><br><span class="line"># a = 0x66 ^ 0x34</span><br><span class="line"># print ord(&quot;f&quot;)</span><br></pre></td></tr></table></figure>
<h4 id="flag：flag-amazing-beijing"><a href="#flag：flag-amazing-beijing" class="headerlink" title="flag：flag{amazing_beijing}"></a>flag：flag{amazing_beijing}</h4><h3 id="advanced"><a href="#advanced" class="headerlink" title="advanced"></a>advanced</h3><h4 id="在Linux上运行一下发现返回的是一串数字。"><a href="#在Linux上运行一下发现返回的是一串数字。" class="headerlink" title="在Linux上运行一下发现返回的是一串数字。"></a>在Linux上运行一下发现返回的是一串数字。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/tools/IDA# chmod 777 src</span><br><span class="line">root@kali:~/tools/IDA# ./src </span><br><span class="line">welcome, here is your identification, please keep it in your pocket: 4b404c4b5648725b445845734c735949405c414d5949725c45495a51</span><br></pre></td></tr></table></figure>
<h4 id="一开始怎么想也想不到这是将flag异或之后返回的结果，可能这就是经验吧，flag的前四位肯定是flag，所以来寻找规律。"><a href="#一开始怎么想也想不到这是将flag异或之后返回的结果，可能这就是经验吧，flag的前四位肯定是flag，所以来寻找规律。" class="headerlink" title="一开始怎么想也想不到这是将flag异或之后返回的结果，可能这就是经验吧，flag的前四位肯定是flag，所以来寻找规律。"></a>一开始怎么想也想不到这是将flag异或之后返回的结果，可能这就是经验吧，flag的前四位肯定是flag，所以来寻找规律。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a = 0x4b</span><br><span class="line">b = 0x40</span><br><span class="line">c = 0x4c</span><br><span class="line">d = 0x4b</span><br><span class="line">print ord(&apos;f&apos;)^a</span><br><span class="line">print ord(&apos;l&apos;)^b</span><br><span class="line">print ord(&apos;a&apos;)^c</span><br><span class="line">print ord(&apos;g&apos;)^d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">output：</span><br><span class="line">45</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">44</span><br><span class="line">[Finished in 0.1s]</span><br></pre></td></tr></table></figure>
<h4 id="发现字符串索引为偶数的是和45进行异或，奇数是与44异或，这就是规律。解题脚本："><a href="#发现字符串索引为偶数的是和45进行异或，奇数是与44异或，这就是规律。解题脚本：" class="headerlink" title="发现字符串索引为偶数的是和45进行异或，奇数是与44异或，这就是规律。解题脚本："></a>发现字符串索引为偶数的是和45进行异或，奇数是与44异或，这就是规律。解题脚本：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">s1 = &quot;4b404c4b5648725b445845734c735949405c414d5949725c45495a51&quot;</span><br><span class="line">list_1 = []</span><br><span class="line">for x in range(0,56,2):</span><br><span class="line">	list_1.append(eval(&quot;0x&quot;+s1[x:x+2]))</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for x in range(len(list_1)):</span><br><span class="line">	if x%2 ==0:</span><br><span class="line">		flag += chr(list_1[x]^45)</span><br><span class="line">	else :</span><br><span class="line">		flag += chr(list_1[x]^44)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
<h4 id="flag-flag-d-with-a-template-phew"><a href="#flag-flag-d-with-a-template-phew" class="headerlink" title="flag: flag{d_with_a_template_phew}"></a>flag: flag{d_with_a_template_phew}</h4>
        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        转发请备注<a href="“https://luobuming.github.io”">一筐萝卜</a>的个人博客 <br>
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
       </p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
