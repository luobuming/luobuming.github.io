<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        逆向VM题型 - 萝卜
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
     你若盛开，清风自来！ 
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            萝卜
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#介绍"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CTF-VM题目类型"><span class="toc-text">CTF VM题目类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#做题技巧"><span class="toc-text">做题技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-0x01：2018NCTF-WcyVM"><span class="toc-text">Example 0x01：2018NCTF  WcyVM</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag：nctf-3e1ce77b70e4cb9941d6800aec022c813d03e70a274ba96c722fed72783dddac"><span class="toc-text">flag：nctf{3e1ce77b70e4cb9941d6800aec022c813d03e70a274ba96c722fed72783dddac}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-0x01：2018X-NUCA-Code-Interpreter"><span class="toc-text">Example 0x01：2018X-NUCA  Code_Interpreter</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag：X-NUCA-5e5f5e5e5f5e5e5f5e5e5f5e"><span class="toc-text">flag：X-NUCA{5e5f5e5e5f5e5e5f5e5e5f5e}</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#《加密与解密》"><span class="toc-text">《加密与解密》</span></a>
</li></div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 你若盛开，清风自来！ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        逆向VM题型
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2018-12-11 17:29:28</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#逆向" title="逆向">逆向</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <p>在CTF的逆向中，VM类型的题目也挺多的，在这里总结一下。<br><a id="more"></a></p>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>提起VM，大家可能会想到VMware虚拟机之类的；没错，这个VM也就是虚拟机，但是这个虚拟机是在程序中用代码来实现一个虚拟系统，用这个虚拟系统来解释一串字节码；这样做的好处是安全一点，但是，也不是最安全的啦。</p>
<p>通俗的来说，VM就是自己设计一套指令集和一套解析这个虚拟指令集的引擎。</p>
<p>在这种情况下，就要对整个虚拟引擎结构进行逆向，理解程序的功能，还需要结合提供的字节码进行分析，整个程序逆向起来会十分的繁琐。这里粘出来freebuf上关于VM题目的一个图片：<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAscAAAFYCAYAAAC/LlElAAAgAElEQVR4nO3dB7gTVd7H8f+FS+9SpYiCDVFURFHUdRUVC4ru2ruirrquFbu7j69l7b333l/sYhexi4IogggoKkqXLh3u6+84575DSHKTm+Rmknw/z3Of25LJJHNm5jf/OXOmrOIPBgAAAMBq5XsGAAAAgKggHAMAAAABwjEAAAAQIBwDAAAAAcIxAAAAECAcAwAAAAHCMQAAABAgHAPIKoZOh9AOABSqMm4CAgAAAPyJyjEAAAAQKM/3DAAofJyAQiJlZWX5ngUASAvhGEDGVqxYYTNnzrRFixble1YQIe3atbNGjRoRkAEUFMIxgIyNGjXKBg4c6CrItWrVcmGIanLx0zL2yzo2AOtA6cADD7TzzjvPmjVrlqc5BID0EY4BZETB6Ndff7XGjRvbrbfeak2aNCEYlxB/QBRe5rVr17ZHHnnEJk+ebEuXLs3j3AFA+gjHADKmYNSwYUNbf/31K6uEBOTSEj5boJ/btm3rwjEAFBrCMYCMJOpPSj/T0sMyB1AMGMoNQEaoEAMAignhGEBWEZZLT3iZs/wBFDrCMYCMhQMRp9ZLT3iZs/wBFDrCMYCMEYgAAMWCcAwAAAAECMcAAABAgHAMAAAABAjHAAAAQIBwDAAAAAQIxwAAAECAcAwAAAAECMcAAABAgHAMAAAABAjHAAAAQIBwDAAAAAQIxwAAAECAcAwAAAAECMcAAABAgHAMAAAABAjHAAAAQIBwDAAAAAQIxwAQo6KiIt+zAADIE8IxAMQoKyur1vPSCdWJHkswB4D8IhwDQJakGqoVgBM9trrBHACQHeX5ngEAiAqF1nfeeccee+wxW3vtte3KK6+0UaNG2d13320bbLCBTZ482bp162ZHH3201alTx9566y279957rU+fPjZjxgybNGmSC7f16tWzvfbayw4++OC4r0MABoDoonIMACFdunSxlStXWps2bdzva621lm244YbWvXt3a968uT3zzDO2ePFiW7hwob3++us2ZcoU22abbaxWrVrWtm1bO/LII2233XazIUOG2PDhw/P8bgAA6aJyDAABVXQ7depke+65p02bNs39bfny5darVy/r2bOnzZo1y4YOHeoCccOGDe2rr76yzp0722abbWZjx4511eS+ffva77//bj///LN9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LrrIhUDC8f/zn0UphcLatWvbbbfdZiNGjLBVq1ZV/r2UPgMAhYtwDCArFHxUMdQXkiuFwFzM7w1AcSMcA0ANK4XgWArvEUBxosQDIGN0o6haqX1GvjtFqb1vAIWPcAwgY1QJq1Zqn5F/v6X2vgEUPsIxAAAAECAcAwAAAAHCMQAAABAgHAMAAAABwjEAAAAQIBwDAAAAAcIxAAAAECAcAwAAAAHCMQAAABAgHAMAAAABwjEAAAAQIBwDAAAAAcIxAAAAECAcAwAAAAHCMQAAABAgHAMAAAABwjEA/KGioiKnj8/28xNNMxfTBYBSQjgGgD+UlZWtESyTBU09vqrHVPV61VHVPFV3ugCAPxGOARS9VANsbLBMJWjGC9XZEm+6hF8AyC3CMYCil+tAmavp5zJ4AwDiIxwDKAqphsiVK1fac889Z++++66tWrUq7nTyEUjvvPNOe/TRR2358uWr/Z1KMQDUrPJ8zwAAZIMPkffcc4998skntmLFCqtfv77179/fBgwYUPk4hWMF4yZNmthf/vIXq1WrVtzp1LTy8nJ79dVXbf/997c6deokfazCO6EZAHKDcAygqPTq1ctuuukmu/DCC12IfOqpp2z+/Pl25JFHuv8rhJ511lnuf7Vr187ZfCxdutQmT57sQnjbtm3jPiYccvfcc08bNWpUStMmGANA7hCOARSVHj16WPPmzW2XXXaxtdde2xo3bmxvv/22qxKvs846tnDhQmvdurU1bNhwteeporxo0SJXcVY1uUGDBu774sWLXaBWF4xly5a5arS+FFD1u/6vkKvH6rX0d03r66+/tvfee8/22msvF5Dr1avnwrgeq+fouf51VCnW6+p/S5YscT/rNRs1alQZhDVv/jmad03LT0fT0O+///67+675AABUD32OARQlX5XdZJNNXJj9/vvvbcqUKXbiiSfaTjvtZEOGDFmtz/GXX35pxx57rO22224u0D799NM2fvx4+9vf/mbnn3++DRo0yP3vvPPOs9mzZ7vpv/HGG+6xu+++u+277772zTffuGD77LPP2vHHH2+33HKLHXrooe65em359ddf7eyzz658jubDmzt3rnvOrrvuaieccIKNGTPG/V2V70suucT22GMPO+SQQ2zYsGGuMq0Kee/eve3mm2+2F1980U3z8MMPd/MAAKgewjGAohMe71eVVl/N7dCh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SnUL2KFDh9pNN93kgqwG9VeXhSFDhtjo0aPdbWDlrLPOcreJ1XfdMlbhWXe9UiX5l19+cQH6iCOOcHfe0vPLy8tt+PDhdtFFF7kQrJ933XVXu+GGG9wtbH/44Qc78cQTXai++OKLXeBWFfv++++322+/3V5//XV744037J577nG3ttUXEO/SxgoAACAASURBVFVUkAuLv9U3BzXRQzgGkDeLFy+2p59+2gXggw8+2DbYYAO75ppr3E5D//voo4/s7rvvdlVhUTeILl262HfffWe9evVyd8xSFViBWXfcatmypbvt7GOPPea6YfTv39922GEH13dY1eWtt97atthiC3vkkUfca5599tmuH/J//vMf12VDNE1VqFVp/umnn9xz1NVjxIgRlTszzY8q0grn6sLRs2fPvH2GgChg6ayHug+9+uqr7gAT0aXlpa5bHNBEE+EYQF4oYKrKqx35p59+6qq56nf8zDPPuK4PCre6wM4HY1FQ/u2331wXjHHjxrlg2rt3b9ftYvr06S7QKlArJLRo0cL22muvuK/96KOP2sYbb5ywYqPuFqo2Kxy//PLL9uKLL7rpqhKtyrLmWfOq56vfc7xwzA0IUJMUhnXGRGdIHnzwwXzPDlKgs1s777yzO/uFaCEcA8gLhUddIHfaaae5qu0BBxzgQufHH39sRx55pPubqsjqKuH7/R544IEuCKt7hIKnQrD6HR9++OGuy8MhhxziQm88CrbqLrH99tu7aavvsp4fS+FXr6vKsDdgwAD3pXlWOP/mm29cFxB/69t4CMaoSTqroQM2nRnRGQ1En7ZJrVu3dt8RLSwRAHmh6vDDDz9sV111lRuZYv/997ctt9zSOnbs6EKoAnGrVq3caBG6ME7++te/2k477eT6AZ988snWtWtX1z1i4MCBLhComuxDrfoy33bbbe7iOr2GLtTbe++9ba211rLjjjvOjVahi/08X0VWyFCAVvcKVa7DfOCNdyqUSjHyTSFr/fXXz/dsAAWPcAwgL3yQVPVWw6+p/6/C7qRJk9zf1Z1CFWFdqHfJJZe4L9/PV/2RDzroIFclU4C94447Kke30PdZs2a5Idb0eE3z3HPPdRf16SI+dbeQ3Xff3d5+++015kehXP9Tf8BkYrtkxN48hKAMAIWJcAwgL3y41PdGjRq5aq26UKh6rH54qhar24K6M2hMY9GN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84b8UMFNxZBcHxxlHI4RHytxdsUbZqlU0JYSU3so5dOMmfBnvDzaWXLF/PmoHfizB1Haxvp5YR2Hp7agdpHrM/Slef4fAAAAiINwDAAAAAQIxwAAAECAcAwAAAAECMcAAABAgHAMAAAABAjHAAAAQIBwDAAAAAQIxwAAAECAcAwAAAAECMcAAABAgHAMAAAABAjHAAAAQIBwDAAAAAQIxwAAAEAgP+G4IsW/J3ocAAAAkAP5CcdloZ+DAFxRUbH632MfBwAAAORYjYbjuIXgIACXlZGEAQDZ4QouAFANNRqO48Zftl8AgCyj4AKguvJ/QV6S7RdH/gAAoFiRc6Ip/+E4CY78AQBAsSLnRFN5TbyIjot+njt9jUZQ8cevZRWr/1y/vI61adSiJmYLAAAAWE2NhGNF4nhHRwrDOqWg//0ZkmvZqorCO4patWqVex+1atVy3/W76Hd9Admi9rVy5Uq3ztSuXbuyvfn259YlKhEoMX4/Ilo/9Ht5+Z+7N60f+vLrBttkREW43Yb/5jOE38arTQvb+JqT963E6gv5jw1YreT9b/TfdPvoLF261ObPn28LFy50jW7JkiU2b948W7RoUVrTife6X375pR188MF233332fLly+3nn3+2v/71r7bnnnvaq6++mtb0k72upq0VxK80SF/s8stmXy8/Lb+s1L7U3rTMfPv7/fffM37NqVOn2lFHHWUXXXSRm+6vv/5qxx57rP3lL3+xJ554olrtIzxPml/N99y5c917WLFiRUbzG1Xhg4pcTjvT6cdrs4W+DdD8a11Q+1Ib1u8LFixwX8uWLavWNMP7kbvuust22GEH+/777930HnvsMdt2223ttNNOsylTpmTrbTjZaj9++47CoHalbbrarJabftc2U5kinTYRL+Qqn/z973+3U0891f3+448/2umnn25bbbWVPf30066tpCOTNhrvueF9XTHLeziuilsAoWXgmlKaR03PPvusa1j/+Mc/bNq0afbwww/blltuaZdcckla04nXkDfbbDPr37+/q1Ko0Xbs2NEef/xx97fp06enNf14FFR++OEHu/fee+2XX35ZbR6ysfPNhZqYp0RHzsleO/Y52Tz6Dk/riy++sG222caOOOIImzhxor344ou2/fbb25lnnumWZ6rivZf27dvb4Ycf7ioKam9rr722XXPNNXbCCSdUO3z7eddzdbB3/PHH22677ebm+cMPP0x7elGmHZnWy6+//treffddt3y0U8tGm9U0fvvtN/v222/tnXfecd9nz56dUegJLxuFSQW+9957z0aMGGEzZsyodpisaeHPV5/3Oeec47bB2tlreajAoDb3/vvvZ/w6Rx99tK2zzjrus6lbt64dcMABdv3111unTp3SLohUJdNtiIKQ9kkPPPCAffXVV1maK+Ta559/brvuuqvtu+++riD25ptv2uabb27nnXeeWy+96mxX6tevb5dddpmbjp6vTPHf//7XtevYg+NUph+vMl0V/5i4Z/xLpGpdI90qMhF34aQ5jb333ttVDxQqFC769etnw4cPtyOPPDLj+VMobt68eeUOVr/rNZo1a5aVSoB2gtqwjxs3zvr27bva/6LaSOPNV7KVLR1VHbXm+jOp6n3o7926dXNtS21ho402sg033NDuv/9+GzhwoDVp0iTl10r0GmpvderUqexa0aZNG2vZsmW1D8b8qT3tpHUgqfVD8//GG2/YPffc4+ZfbbpQ+fensKRArB3PqFGjXFW8UaNGNmDAABs0aJBtsskmGbUf7TCvvPJKe/vtt92Bi5bRjjvuaBdeeKGrXPrT/NXx3Xff2a233urCpA6wNJ/aGZ977rnuLFWDBg1We69RE56ntdZay22TdYpYZzzatm1rJ554or388ssucGT6Oo0bN7aGDRu6n/V56Ge9hv+MokQFD23f//d//9etaz179sz3LCEFKraprWq7qAMxbUdUDNHf1da86qyLek6rVq3ctl1BWNuRpk2buvVGf4t9bHWmX1OPKWSRD8eO8kgGy0E7JX2pkfnfVVHQl2hHqSqPGp6qC71793YVIP29c+fO7lS2gsPWW29t6667rtuoqyL02WefuVMrOrWthpsoFPq/q0owdOhQVwHSdHr16uUC9LBhw1zVT9VG7cA1XVWku3fv7nauetyhhx6atDFGdafoZWveUp1Orj6PVKap9lGvXr3Kvo2+n6Nvb9ohfvTRR27Dpw2rKmiaX1Vp1S7U9n766ScXshWA9HwFuddff92dhtbzfV+0ZPPmp6nHa+O91157ufamCpXORqg9az5VLe7QoYNr6+uvv77buGsdUXvUQWW6p/Gixn8uCsY6PTl+/PjK4KT17aGHHrKZM2fazTffbF27dnWPTbf9jB492p2210G3Xy5aVq+99pqb9m233eY+z+q0SR30XHDBBTZkyJDVKsXaTpx11lmubSngR3n9j6X2pbanbbLmX+3T7/i1LdR70/vWOrPddttZu3btXJVf22G1zwkTJrjPVwUDHSyK/qYDlNatW7vtclV9M7WcND1VqzUPW2yxhW2wwQauEjhy5EhXwVP3DK0fqjgr+Ci0xKPn6ABGB5Jjx451j9f6pf1JsnlQe7vzzjvdvOj9oDCorart6oDLb9v1sz8AVtv9+OOP3T5fbUZtWM/R9kFtWflBbUZteaeddnJtRMtfz1HFWGE4XCFO1Ib0mG+++cZ96aBQeUEFGBXVJk+e7DKE/q42rLao3/1+KNYnn3zivmt+1f5VdFEb1vNLUWGE4wy3+X4j+dRTT7md2KxZs1zDUaNWSFA3C+3AtIFWEFBg0QZaO0ttILUBU8DQRk+VGq0ACio6Xa5QrBVhl112Sfja4sONKgR6Ha1YqgApiGuDrtOwOhJVeNEpmk033dRuueWWygphKu8R/6+qA5Vcv7Y2dNrY+BCmfmPaOOoMw9VXX10ZONXO/vnPf7oKs0La4sWLbeONN3btUiFWG091ndBBlbrW6Ge1VZ1qq+p0mfq8qxKs9qp2pS+1MYUMVSG1wVYgVhBR+1a7U/cMT2FD4Vwb6kKnsPTMM8+4YCyxn5Wq5Kr4dunSpVoXvDz55JNuhxTvjIa62WhZ6IBXVcx0vfDCC+4gJ14XCh1E6X2pMq22UijbAc2n2uHtt99uLVq0cMHSH0xqu6rtobZ9+jzHjBnjDg5UwLjhhhvcQaO2y+pioh29urApaNxxxx2ukKEDPa1vyU4/63eFkGuvvdYFWa2Pmh/159f+QV1XtL3WWQYdyGpdVLe8Qw45JO77Udi5/PLLbb311nNhXdt2BRLN9wcffOAKLT7867W1TqngoTOMieYR0aY2o+2Glr2248oWqvwrEPu2qDat7a62+ypODB482G3bdRClIoj+p/asdVftXuu68oHPIrHdKGNp2/3ggw+619HjtZ3T+qDt3PPPP++2/com2rYrvKsLntaPeBTMdd3KHnvs4dYNZRa/zyhF0Q/HoaqxDzfzly+xZSuWW+2yVLpMr7Lfly62VfXKbbEtd8/9fdVyW1m3zBasWGrLFy+3/Q872Lp139hqWW276+Zb7ZefJ9tWW/dyjUSB+Oyzz3YbMQUHhR4Fa23wdLpU4eHGG29crRHHCy0KNKrC6RSaAomqQDo6U9VQG1BVO9Q4dTpbG+BJkyZVnppd4yOJeJU41xv56k4/3c8sk89Zz9XGRRvK2BFMFEr9mQD1e9dFQgo3Bx10kL3yyit2yimnuJ2/Qo/agXak6pbx73//251FeOmll9xGOdn7mzNnjgsYOtWnvpyqkOnAbuedd7bDDjvMzZvCoDZ8mhcFgfApO/XJ1YZXG/TwDrxQaZ3VTskfrMTS56EdikJNOl1fRDs+BbVk3ai049Q2QOt+urQsFNgSUTVKOzNVpAqJPnMFfq0j2tapkiw6AFTfTQUItWNdcKrlpiqW1hMF0GOOOcaFT22H1YbVVrWtfPTRR902WssyvJxjR6jQstL2Vq+vgK62r4NWTU/bX722lpnWTV0roINHrZOJqOqsyrKm85///Me1I52l8Bfoap4UVPx1Inrdqs78IPrUhrVs9RVe/9Ue1K9eVVft63V2+MADD3SZQgH5uOOOc5VcFS+0fuuskg7CtP9XNym1Zx24hdtIbPvQdkfTVYY4+eSTXUDXvkOVaE1HXT7OP/98t76oGKL2nKxrkfr9a5+hrk7qWqcuXJo3wnFUhdqDbxxzF81338PjJCezaNkiq6hTZvse8Dfr06ePq/TqVNbCP/7erl37PxrBk3b9rX8G3KnjJtnOO/3VhZkGjRq6yq5OL2gl8Bdz6IhPOysFY1FlOXxRT7ydrzauamgK2tqA6vmqUGvjr+qznqPX0kgX+r9O73mFthFNZf4yCZ419f7DF0Ol85p6vHb0u+++u1veosqfNp7awWpa2hBph60dvM4SiO+DqY2mqhFqg9qxKtiqQqb2IjrtpUpDsnahiqICmyoFGklFAUThTDt7VbY0L9qA+9Nwqph5OkWnjaSCiKoaUW9vqdD6G+8C1nBYThScq+KHCkvWDz6Tz7AYRzHQZ6UzJGeccYY7C6LKls6qiSrJ2pmrreq9++2ulqEOLrSd1HqkMKx2rVCgtq2zL/qbvnyfzfDrxVbhtO7pS2FYwVXbZ10X4CnY7Lfffm69S+WgRvOkYKL1SaMY6PV0pmCfffZxXyg8ybb9amfqO6+gq66S6jqlNuq38SeddJI7CNKBq7brvmCifbwCq6jdKVirCKLrRnTmStTmwgd08bYtqhIr8Kpbp850iM5Ca13QPkTPUUZRuNW6kKhi7Gld0+ureCN6DzqTme7nUiyiH46TSCUYJ6KFq8b98ssvurCrSoQawrvPD3EL3e2QVv3RmFetcEFFjVpHXVoJFFi0AVTg1cZPG28/lIu+67H60g5Tz9XGXo/TkZyqIJqOXl8rg/6mx6nxxl70pOeK5ksrnDa4+lu8Uy2xDVWBO5afXnU+K81rmD6zRCuH3ykp+Mf2Vw2vVPHmMRE/7/4CBX3WfuMRO2+pTiveCu7nKfw/vY9Ej4/Hj0gRO+SWftep908//dRtOLVh1EU4nt94xlJ7UQjwISnRkH7h8Kdwrg2kTuUr4Oo5+psP2H6ZxlbDdHpbVWkdRKpSp9PBulCtOt0BokTVyHg7h/BORyGtOl1I1GY0/UT0GupLXt0KvHZYPnDF8heA+n63hSR8QKF2r/VZQULtTwduGmVC66pOG/v27g9EwvQ8bRMUkuNN24v9XctNQVunof3/1efer0fajumMXjrXOYRfI50DLbpURFNVy95vr9XetI1VW1Rg1TZeZ+R0gKUzFP4iWvHjcIdfQ9thX4X2j4k3H+H50Wtpm6Z1RZVnPUcVZB+w/WABsRfxJRO7biW78LzYRX4ot2xQg1No9UdB+q4vhR71VdOOXwFA1ThV23QUpw20Nra+aqGfNR39ro2qKhM6SlMVWhfdqFLn++hog64dmVYIPV5VYu101YhF/ZL0uyojPlTrKFDfNU/hgOTHzNX86tRweAcgNTEgeLLhXJJ9r2oYGH1O1Q3sfvqZvPdkz81kCBstM99eRMFWP2v5ahmqjehUmE6D63GqXqlfqg449Ls/1aw2oeWuMxcKtjrVpr6Uam/qf6nH+AMwPy6xvuv1FZjUb00bYVWmdXZDp9+1EfbjfOuxqjL4DbGmo1N7eqwqG2qL/mLRQqfPUFUehdR4VM3RV3XplKmWaSy1GZ0F0lmE2ACbaiBSdxsdqMSj7YhCZFVVoahRu/briNqfH/NY20QFZB3Eqeqlv+tLlWWdQfHrhD47P3a4zqqosKD2rSqaHqt1Su1Zj1N799tkrWP6XYFBFTJ1tdEBpLorqb379dM/TttuvU5V9DqaL39grO9aj6tad/wZSb2W1m3NQ6GPY10KtGy13LR81V607NW+9DdlCrVlbXe1vdEyVX92beP1s9qTnq8vPx6+DszV9nXWTttkDe3np6c2op/9uqA2qdfUNk1nNDRNdelRvlDfeG3/fb7RtP3reYm2O3qsnuczj15T7bJU1b4k3cF+Q7TQtMPWwtLpp2TmLU1tB1v+x0arcZ3kQ+6kOi1Pp4i109fC1oZQfYB0mlsLXqccdLWyqhM64tt7135u46oKwiOPPOIaik7XPffcc+60myoUuoJZG2T1VdOFUgoiGmrNX5msK8jVyNVfWWFbpw9VpVM/Np0uvOmmm1wAV/8jVZXVp019PnW0qX7IOgpUlUkNVQFcF6Fox6D/6T0k2lGGw1u8vkWJTpEkmkZY7PSSTUufpz4frbD6XtXFcZpWVcMs+dfTMtDGQ2Pw+uekO0RTsnmv7ufm34++q/qqjZt2cro6WBdaKGRqmau/r0ZNUD91bcjUHrXRVBtTn3S1GbUnVWzVVtQ+FLp0QKVVVRd2KVRrWgrMCgVqb3oNTU9tSK+pA70ePXq4MbfVd+2tt95yXSdUgdR09Vpq72rXWgf0Or67kaalvnD+piLqfxbVyrE+b31W6mOqgfPj9dH3FFLVHrXzElVWdKCrz1Y3VVG1vLoHW9pJ6YBZ67uoqqN1WOu++h4qmMcO5ZbqaylUa94VnrTTVbBTRUo7VI2QoSEq010+mpbanbrOaLtVkxRUdfGp1glVubRtVH947Ud8Ffy6665z7U+hX21Q/1N7V9vVe9U8q12rDauwoQqwlquuA9Fnr8do36TT2brI6dJLL3UX9mnbr4NGPUfVfk1TXTvUp19hQ21I+wa1B01Pw8tpm6ttfjLaD+iCb4VztSdNz+8vFLwTUXvRaynYax+ibYdeKx/DzumgRBdxqeIZlTMRCoP6XP/2t7+55ZOvimXsWUOtO8oHaiPaH+viay1zhVB1oVG1WBfUq41rG6CDLm17tK3SdSXaRuuCPbVzrdPqjqO2r2nobKIygPb92mbofWvbr+2yzjwqK2j/p7+rkKFcoHavi4LVfrVOaf+i7nTaT2getP3wB9CJPkPlDK0zWndURLnqqqtc29e86rWSfR41SZ+l5tOPHpYrZRUZnM9RaFAD0EqtcJnMz/NmJP2/V++PjUnbhi2yMi3Pn/LQwvRX7utv/vbO/jSH/t+5edvK//mKRvgx+tmPPxi+paN+1rT9sFuefw0fnHzfR39Fqn98uHuEn47vdxo+xeL/X5VsdquINz0dlSZqOrpqWztvXcCo95gK/5kkuujFz7tCnXZyChx+ntLpnhGeVjyZfm7+1KpvbwpM4dvXatn55e0r375d+eXsL9zR49TW/Gkxf/VyuDqv54Xbj3++v5V5+H+ajn+dcHXKj4gS+3j/Gr49RpHeh4KWQowOBKoKiXrvClTayag6qJ2LdkTxRv9Il6atnZF2atpp6iBG4VMHxZLJ9PU+dVCo4KazVFpXtHPQAVB1blOvPoo6ENJFYzooqAnhA0jfznz7VkDQ/3xbD29bw+uKnufbY7zbROtv4WEO/bY63N79euBpvQpv2yV2G17VNlfT13Pi7WOSPdfPc7ztf03S66ugowu5FMKqc+FoLqita5hCbfcVXH3HQQAACcFJREFU0qKyHfKj/4jfXoczRng76tuwvvvuPr5NhNuM/92vF74tV7WN9/MSbjux23j/+FTek9+e+HmLXV/yTYVO5U5/8WGuFHSf41TF7jzCgUPCG6/w//xYhj74xk4zHFTC00tUvfKN1w+74ucpWbUr3o4v3sUl2d5oZDpSg5fKRU7+dVSlVyUnKhvA6vCB1S+zeMsv0fKO7RsW+3ui8SmTtbd4/4tty+Edc7K2WAz0mer0o+/ilO1p64yTvrLJ71h1NkCVoXj/j7rw9iReO/MjVXiJ+kmG/x67XiUKolUVFOKtV4nWtUTC45hLqjd8qc6BDWpWvH1hbIbwf/NS3cbHtrPw89LJFLHtzQf2eCNnJbtWKPyaVa0DxX5RHmtlCsIhOHYjX51p+Z1ZdSu5sRvTXDTQqkJtsv/Fu2Aw2fPCf/MXvxWyQttoJFtepSrdzyHeSBjZUlVbKoS2ls95zOVr52KZsw5GS7rtp7rLL9vLPZPrZsKSjcJTzEqicpwNiYZ7SnZKPzb8VneoqHiV4nS7ElQlG9MLz6d+Vr+12DFjM+naEUV+GL5E/aqjItXAXuwbPEn2WYRP4acjKn0hi1m23mu6FbVksjWdZNNEYanu8sv12eBUxO7Da+KC/6gq2cpxTYSZ2MAZb/pVhcWo7vzC85Sokh5vvvWZZDvY51ui5ZMsgKXyt2yKYhvKl3RHKUlXTR4UldJyzdZ7rU5FLZVlmq2uaCgNqZ59zXRa6Yi3Xy9VJRuOfWOK7R+bybRif5aqgmBVp7RTPeWdzY1rqjuCqh5f3XnSEGPFLFunu5LJtD2ws66+fFV8Ck0hzXOuz7qUehApVtkMwMnk6qC+kNbRbCvIbhXrNGtT9YNqUFVHW/5GIfGkE84LYQMar49xvPn2V+4iNzi1W1oKcXkV4jwD6SikNl4TRZtCEv3Kca4PXGrgwCjR8GSpqum+otmsgCSalg/G8cJ0pp9XvpTyUTYAAMUi+uE4ZI0glY2JhrJbTYSbql6jUE5tZDJPyfpZK0wXajgu5aNsAACKRfS7VYTyxhpVyWy/VI7CjW42kOrwb/Eqr+lcyKfH6o5T6Yo3Pd8lIl6/6USnYJKF5nivEe9q70KS7ucGAACiLfrhOGSN/qvKUVnMs7kaGSKToV3Cd5XK5WvFqs5n4e8C5+nCOt3sJB2p3lEvqqI6uggAAEhNQYVjHzqWrlzx560V//g9W5d0lSnU1K5t9Wqn/5EkC0TJKoupTDcTmQS1REPd5XoYrELsUpHpjWEAAEB0RD4cxwayFVZh0xf+GTgryhRqs/lqtWydZq3Sfla8QFRVv1ovlVPv1R1jM9M7+GXruamE9Op2B4mCeHdPBAAAhSny4XiNwFexMvRztl8t/Tp0VSE4fFvZXAanbHanqO5rZHKbST1Gn2Uh99MlGAMAUPgKarSKPxXGLIerqOFbMIYDVIsWLVKeVk3L14VxuboBiH8/S5Ysycn0Y18HAAAUpshXjgtVVXeNS6dCGm9a2a6wZmN6ibpVxB4oJAuQ8W4MEm8s5GSSdTEJh+NMupB4iT43QjIAAIWJcJwDPoj5oBcb1DINolE9fR8bCJs3b25NmjRZ7W/hbiiphtN0+1In+384fOcywEZ1GQEAgOQKo49CAfF9jH31MvbW0tmo0EaxKpnqPOn9+88g0XNy1bUiLN5r65bWAACgtFE5zrJ4FUOFLlVRw9IZ2UCP1TRqKhSnOrpEbPDPxutWh7pKaAi4dD7T2HnXc2OXEQAAKD2UymqATuXHVkPTCcbZ6BubjlRHl8hEor7J1ZnuokWLUpqnOXPmJJ2XTD7j8KgkAACgcBGOM5Som0RsUIsXkFMRtb6ryQJgquFQ/Y7D7yteX+VYDRs2TPia+tItupPRZx/7OtkYFzr83KgtKwAAkD7CcRbEC8jxgmJ1A3KUpHuHvPDnoFAcb1zoVPr6hu+cF3vTDf8Vb/r6vPW3eCNehP9WyOMrAwCA7Cm4PsdRrc4pXKl6WdX86bbXCmyZ9m9NdvMRPz/5mp4PrXqfy5cvX60vcLx+weGQmiwo++pxVTdVSXTL7rDq3B4bKCa0dXh0CQNWl1HluLorVCZ3jIvySpzo9sfhedZ7rqqCnIv3mKvPLVHf4US/x455HCvZQUO4epzotdPhX98H/3T6gQOFjn7y8Ko665dvUZoX5F9NHNjnpVtFojdWDOEkXoU13vtKFpBzcQFevDv0ZXO61XlO7HtMNMRbospydQ+uwq+vanSy14sX5Km4RU+6N4rBn2r6Yl8Ujihs52L3W7TV0hVvv5xLGYXjbI9YkOqbr+mVNt0FkawLQjicVRWQM5m3qv6ey51idYJK+DOr6kI5ddVIV3gjG75LoarRVVW6JdENXRAN2by4stQk2hYQREpP1NabVLrDoTTU9LLPWeW4Onc+S/V/NS3Vo9bYC7yqupWyKHRV1d83lXlL9e9eLvvXJgsq8arF1bkFc7NmzRKOYJHKtNLtk03lAoWsqu5P8bYFUdoGo2aE7yAaVWyDURPbpowvyFND1Tiz06dPdxebhYWD4MxF8ceYjVWndm1bWW9xwv+vsgqbtXieW4mz+QH5eS3/fcVqf1+2bJm7yYQXGyrD/4tn/vz5Kb1+vOmk+tyqpudvIjJv3rysTC923sLLuby83BYvXmyNGzeOOx3NR4sWLVJ6TT/d2J245mXatGm2YsWKytf1yyn8+NgDkaZNm1b+PGXKlJTmQZIth6qWP3JLy1dnXwhyycVbl3QGZtasWTZjxgy3LqF0qW3MnDkz37OxBs2X9vVqo9pvsJ6XNuULbbO0v8/5a2X05D9mtGPHjnbXXXdZ//79V/vfGqGmeYMqp+eeo4tE5i9N/KBaZVbWtH7i/2eoYm78YJ6s0ppqFTZXfYmjdCSt+VFwveCCC6xNmzZWr169jKcX1r59exs3bpwdeeSRVqdOnZyPMMEIFtGm5aODl379+lndunUr/8YyW1P4M9HFwzqwO++88xIeyKK0LF261F0Q3ahRo3zPSiW1Tc3TGWeckfG+BMVhwYIFtv766+d8+NU/smj1k5Weqg2s7jxW1emYqSlWjstr1bLW9Zut8TqVfT+twqYvyt1YwWs3TK2qmYpUgmvUwm021K5d23V7aNCgQcYXzcVSe1MFXEeOiU4FZ3qnO4JVYdHy0k5UZwZYdqnR+qOdjM7yxGIdKE1a5gqgCh2pjD1fE5QrlC/8WUGUnnj7dF0rpIyhAlnOXjeTcAwAAAAUk2gcHgIAAAARQDgGAAAAAoRjAAAAIEA4BgAAAAKEYwAAACBAOAYAAAAChGMAAAAgQDgGAAAAAoRjAAAAIPB/DMaIb1DqU1sAAAAASUVORK5CYII=" alt><br>从这个图上就可以看出来VM类型的题的题目大致结构啦</p>
<h3 id="CTF-VM题目类型"><a href="#CTF-VM题目类型" class="headerlink" title="CTF VM题目类型"></a>CTF VM题目类型</h3><ol>
<li>给出可执行程序和字节码，逆向虚拟引擎，结合题目提供的字节码，推出来flag</li>
<li>只给出可执行程序，逆向虚拟引擎，构造字节码，读取flag（这个可能比较骚，我还没见过了）</li>
</ol>
<h3 id="做题技巧"><a href="#做题技巧" class="headerlink" title="做题技巧"></a>做题技巧</h3><p>当在打CTF拿到一个VM题的时候，思路一定清晰，不能盲目的去分析；</p>
<ol>
<li>分析虚拟机入口，找出来题目提供的字节码</li>
<li>理清虚拟机的结构，逆向处各个handler的意思</li>
<li>根据各个handler来将字节码还原成汇编代码</li>
<li>根据汇编代码推出flag</li>
</ol>
<p>如果动态调试分析的时候，可能会很复杂，跳来跳去的，所以建议先用IDA来静态分析。</p>
<h3 id="Example-0x01：2018NCTF-WcyVM"><a href="#Example-0x01：2018NCTF-WcyVM" class="headerlink" title="Example 0x01：2018NCTF  WcyVM"></a>Example 0x01：2018NCTF  WcyVM</h3><p>当时这道题我也没做出来，emmmmmm，赛后自己有做了一遍。<br>题目提供了一个64位的ELF文件，拖入IDA中，静态分析一波，main函数还挺简单的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(__int64 a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  setbuf(stdin, 0LL);</span><br><span class="line">  setbuf(stdout, 0LL);</span><br><span class="line">  printf(&quot;This is a %s\nplz input your flag:&quot;, aWcyvm1);</span><br><span class="line">  if ( sub_400DAB() )</span><br><span class="line">    puts(&quot;flag is your input&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;didixingwei&quot;);</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>mian函数中先让输入一个flag，然后进入syb_400DAB函数中，若这个函数返回1，则我们输入的flag是对的，若返回0，则我们的输入是错的，接下里进入到syb_400DAB函数中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">__int64 sub_400DAB()</span><br><span class="line">&#123;</span><br><span class="line">  int v1; // [rsp+Ch] [rbp-54h]</span><br><span class="line">  void *dest; // [rsp+10h] [rbp-50h]</span><br><span class="line">  char *v3; // [rsp+18h] [rbp-48h]</span><br><span class="line">  int *v4; // [rsp+20h] [rbp-40h]</span><br><span class="line">  int *v5; // [rsp+28h] [rbp-38h]</span><br><span class="line">  int *v6; // [rsp+30h] [rbp-30h]</span><br><span class="line">  int *v7; // [rsp+38h] [rbp-28h]</span><br><span class="line">  char *v8; // [rsp+40h] [rbp-20h]</span><br><span class="line">  char *v9; // [rsp+48h] [rbp-18h]</span><br><span class="line">  _DWORD *v10; // [rsp+50h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v11; // [rsp+58h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v11 = __readfsqword(0x28u);</span><br><span class="line">  v1 = 0;</span><br><span class="line">  dest = malloc(0x200uLL);</span><br><span class="line">  v3 = malloc(0x1400uLL);</span><br><span class="line">  memset(&amp;v4, 0, 0x30uLL);</span><br><span class="line">  memcpy(dest, &amp;unk_6021C0, 0x190uLL);</span><br><span class="line">  v4 = malloc(0x38uLL);                         // rax</span><br><span class="line">  v5 = v4 + 1;                                  // rbx</span><br><span class="line">  v6 = v4 + 2;                                  // rcx</span><br><span class="line">  v7 = v4 + 3;                                  // rdx</span><br><span class="line">  v8 = v3 + 5120;                               // rsp</span><br><span class="line">  v9 = v3 + 5120;                               // rbp</span><br><span class="line">  v10 = dest;</span><br><span class="line">LABEL_26:</span><br><span class="line">  while ( *v10 )</span><br><span class="line">  &#123;</span><br><span class="line">    switch ( *v10 )</span><br><span class="line">    &#123;</span><br><span class="line">      case 8:</span><br><span class="line">        sub_40082B((&amp;v4)[v10[1] - 1], v10[2], &amp;v10);// mov v4[v10[1]-1],v10[2]</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 9:</span><br><span class="line">        sub_40096D((&amp;v4)[v10[1] - 1], &amp;v8, &amp;v10);// pop v4[v10[1]-1]</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 10:</span><br><span class="line">        sub_400927((&amp;v4)[v10[1] - 1], &amp;v8, &amp;v10);// push v4[v[10]-1]</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 11:</span><br><span class="line">        get(v4, &amp;v10);                          // 接收一个字符到v4寄存器中</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 12:</span><br><span class="line">        print(v4, &amp;v10);                        // 输出一个字符从v4中</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 13:</span><br><span class="line">        sub_400B5D(&amp;v1, (&amp;v4)[v10[1] - 1], (&amp;v4)[v10[2] - 1], &amp;v10);// 比较(&amp;v4)[v10[1] - 1]和(&amp;v4)[v10[2] - 1]的大小而进行三中不同的运算</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 14:</span><br><span class="line">        sub_400A34(&amp;v10, v10[1], dest);         // 跳转 jmp v10[1]</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 15:</span><br><span class="line">        sub_400AAF(v1, &amp;v10, v10[1], dest);     // 如果v1和0x80相等的话，就向下跳转2，如果不相等，则跳到v10[1]</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 16:</span><br><span class="line">        sub_400A61(v1, &amp;v10, v10[1], dest);     // 如果v1和0x80相等的话，就跳到v10[1]，如果不相等，则向下跳转2，</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 17:</span><br><span class="line">        sub_400AFD((&amp;v4)[v10[1] - 1], &amp;v10);    // (&amp;v4)[v10[1] - 1]寄存器自增</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 18:</span><br><span class="line">        sub_400B2D((&amp;v4)[v10[1] - 1], &amp;v10);    // (&amp;v4)[v10[1] - 1]寄存器自减</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 19:</span><br><span class="line">        sub_400C0E((&amp;v4)[v10[1] - 1], v10[2], &amp;v10);// +</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 20:</span><br><span class="line">        sub_400C43((&amp;v4)[v10[1] - 1], (&amp;v4)[v10[2] - 1], &amp;v10);// -</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 21:</span><br><span class="line">        sub_400C7C((&amp;v4)[v10[1] - 1], v10[2], &amp;v10);// ^</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 22:</span><br><span class="line">        sub_400CB1((&amp;v4)[v10[1] - 1], (&amp;v4)[v10[2] - 1], &amp;v10);// &amp;</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 23:</span><br><span class="line">        sub_400CEA((&amp;v4)[v10[1] - 1], (&amp;v4)[v10[2] - 1], &amp;v10);// |</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 25:</span><br><span class="line">        sub_400858((&amp;v4)[v10[1] - 1], (&amp;v4)[v10[2] - 1], &amp;v10);// 将第二个寄存器中的值传给第一个寄存器中</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 26:</span><br><span class="line">        sub_400889((&amp;v4)[v10[1] - 1], (&amp;v4)[v10[2] - 1], &amp;v10);// 将第二个寄存器的地址传给第一个寄存器中</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 27:</span><br><span class="line">        sub_4008BA((&amp;v4)[v10[1] - 1], (&amp;v4)[v10[2] - 1], &amp;v10);// 将第二个寄存器中存的地址中的值传给第一个寄存器</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 28:</span><br><span class="line">        sub_4008EF((&amp;v4)[v10[1] - 1], (&amp;v4)[v10[2] - 1], &amp;v10);// 将 (&amp;v4)[v10[2] - 1] 的值赋值给 (&amp;v4)[v10[1] - 1]中的地址</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 29:</span><br><span class="line">        sub_400D23((&amp;v4)[v10[1] - 1], v10[2], &amp;v10);// (&amp;v4)[v10[1] - 1]*v10[2]</span><br><span class="line">        goto LABEL_26;</span><br><span class="line">      case 100:</span><br><span class="line">        return sub_400D59(v9);</span><br><span class="line">      default:</span><br><span class="line">        sub_400A17(&amp;v10);</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return 1LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现while套switch了，哈哈，很明显的VM题好不好。然后一步一步的去分析，<br>字节码是在unk_6021C0变量里面，前面的几个赋值分别是几个寄存器，switch中级各个handler，一个一个的分析处它们的意思，然后将字节码与虚拟引擎结合一起来翻译出汇编代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">0  | 8 ,1 ,0 ,		mov r1,0;</span><br><span class="line">3  | 8 ,3 ,70 ,		mov r3,70;</span><br><span class="line">6  | 14 ,21 ,		jmp 21;</span><br><span class="line">8  | 10 ,1 ,		push r1;&lt;-------------------</span><br><span class="line">10 | 9 ,2 ,			pop r2;					   |</span><br><span class="line">12 | 11 ,			call getchar;   	       | #存到r1</span><br><span class="line">13 | 10 ,1 ,		push r1;				   |</span><br><span class="line">15 | 10 ,2 ,		push r2;				   |</span><br><span class="line">17 | 9 ,1 ,			pop r1;					   |</span><br><span class="line">19 | 17 ,1 ,		inc r1;					   |</span><br><span class="line">21 | 13 ,1 ,3 ,		cmp r1,r3;				   |</span><br><span class="line">24 | 15 ,8 ,		判断v1的值     ---------------</span><br><span class="line">26 | 8 ,1 ,0 , 		mov r1,0</span><br><span class="line">29 | 8 ,3 ,71 ,		mov r3,71;</span><br><span class="line">32 | 14 ,70 ,		jmp 70;				   	   </span><br><span class="line">34 | 10 ,1 ,		push r1;  &lt;----------------|</span><br><span class="line">36 | 26 ,2 ,6 ,		lea r2,r6;				   |</span><br><span class="line">39 | 29 ,1 ,4 ,		mul r1,r4;				   |</span><br><span class="line">42 | 20 ,2 ,1 ,		sub r2-r1;				   |</span><br><span class="line">45 | 25 ,1 ,2 ,		mov r1,r2 				   |</span><br><span class="line">48 | 27 ,1 ,1 ,		lea r1,r1;				   |</span><br><span class="line">51 | 29 ,1 ,110,	mul r1,110;				   |</span><br><span class="line">54 | 19 ,1 ,99 ,	add r1,99				   |</span><br><span class="line">57 | 21 ,1 ,116,	xor r1,116				   |</span><br><span class="line">60 | 19 ,1 ,102,	add r1,102				   |</span><br><span class="line">63 | 28 ,2 ,1 ,		mov offset r1,r2   		   |</span><br><span class="line">66 | 9 ,1 ,			pop r1;					   |</span><br><span class="line">68 | 17 ,1 ,		inc r1;					   |</span><br><span class="line">70 | 13 ,1 ,3 ,		cmp r1,r3				   |</span><br><span class="line">73 | 15 ,34 ,		判断v1的值	---------------|</span><br><span class="line">75 | 100			ret</span><br></pre></td></tr></table></figure>
<p>汇编功底不是太强，翻译的可能不是太准确。翻译的时候要注意最前面一列的序数，之前我还以为是行数，谁知道这是通过字节码所在的顺序排的，尴尬了哦。</p>
<p>这段字节码的意思：接收一串字符串（也就是我们输入的flag），然后对flag进行处理，最后再与正确的数据进行作比较，通过case100我们可以找到正确的对比数据，写一个简单的IDC脚本将数据提取出来：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">auto i,start,end,num;</span><br><span class="line">start = 0x6020a0;</span><br><span class="line">end = 0x6021BF;</span><br><span class="line">Message(&quot;\n---------\n&quot;);</span><br><span class="line">for(i=start;i&lt;end;i=i+4)</span><br><span class="line">&#123;</span><br><span class="line">    Message(&quot;%d,&quot;,Dword(i));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out：</span><br><span class="line">14035,11007,10955,11157,11157,11157,5791,6253,6359,5649,6359,11157,11299,11433,5649,5649,6359,11007,6217,6395,10955,10865,5941,6359,5649,10955,5597,6359,11299,5791,5597,11157,5791,5483,6253,11007,5649,5649,5597,11007,11299,10955,5597,5597,6253,6217,11157,5483,5941,6395,6395,10865,11007,5941,11299,5597,6359,10865,6359,6359,11299,11007,5483,11299,5791,13743,11433,12981,11007,12345</span><br></pre></td></tr></table></figure>
<p>通过分析我们翻译出来的字节码可以发现，程序将我们输入的加密规则是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((flag[i]*110+99)^116)+102</span><br></pre></td></tr></table></figure>
<p>逆着运算就是：(((flag[i]-102)^116)-99)/110，所以解密脚本也就很好写了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">current = [14035,11007,10955,11157,11157,11157,5791,6253,6359,5649,6359,11157,11299,11433,5649,5649,6359,11007,6217,6395,10955,10865,5941,6359,5649,10955,5597,6359,11299,5791,5597,11157,5791,5483,6253,11007,5649,5649,5597,11007,11299,10955,5597,5597,6253,6217,11157,5483,5941,6395,6395,10865,11007,5941,11299,5597,6359,10865,6359,6359,11299,11007,5483,11299,5791,13743,11433,12981,11007,12345]</span><br><span class="line"></span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for x in range(len(current)):</span><br><span class="line">	flag+= chr((((current[x]-102)^116)-99)/110)</span><br><span class="line">print flag[::-1]</span><br></pre></td></tr></table></figure>
<h4 id="flag：nctf-3e1ce77b70e4cb9941d6800aec022c813d03e70a274ba96c722fed72783dddac"><a href="#flag：nctf-3e1ce77b70e4cb9941d6800aec022c813d03e70a274ba96c722fed72783dddac" class="headerlink" title="flag：nctf{3e1ce77b70e4cb9941d6800aec022c813d03e70a274ba96c722fed72783dddac}"></a>flag：nctf{3e1ce77b70e4cb9941d6800aec022c813d03e70a274ba96c722fed72783dddac}</h4><h3 id="Example-0x01：2018X-NUCA-Code-Interpreter"><a href="#Example-0x01：2018X-NUCA-Code-Interpreter" class="headerlink" title="Example 0x01：2018X-NUCA  Code_Interpreter"></a>Example 0x01：2018X-NUCA  Code_Interpreter</h3><p>题目给了两个文件，一个ELF可执行文件，一个code，一开始我还不知道code是一个什么文件，file一下显示是code: data，我也听懵逼的。</p>
<p>将二进制文件载入IDA中发现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall main(signed int a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  signed __int64 result; // rax</span><br><span class="line">  int v4; // [rsp+14h] [rbp-Ch]</span><br><span class="line">  FILE *stream; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  if ( a1 &gt; 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    stream = fopen(a2[1], &quot;rb&quot;);</span><br><span class="line">    if ( !stream )</span><br><span class="line">    &#123;</span><br><span class="line">      fprintf(stderr, &quot;Could not open file %s\n&quot;, a2[1], a2);</span><br><span class="line">      exit(1);</span><br><span class="line">    &#125;</span><br><span class="line">    fseek(stream, 0LL, 2);                      // 将文件指针指向文件的结尾</span><br><span class="line">    v4 = ftell(stream);                         // 返回文件指针到文件首的字节数，也就是说，这两句是求打开文件的字节数</span><br><span class="line">    fseek(stream, 0LL, 0);                      // 将文件指针移动到文件首</span><br><span class="line">    ptr = malloc(v4);</span><br><span class="line">    if ( fread(ptr, v4, 1uLL, stream) != 1 )    // 将文件的内容赋值到内存中（ptr）</span><br><span class="line">    &#123;</span><br><span class="line">      fprintf(stderr, &quot;Error reading file %s\n&quot;, a2[1], a2);</span><br><span class="line">      exit(1);</span><br><span class="line">    &#125;</span><br><span class="line">    puts(&quot;Play a game, prepare three number: &quot;);</span><br><span class="line">    printf(&quot;First: &quot;, v4, a2);</span><br><span class="line">    __isoc99_scanf(&quot;%d&quot;, &amp;one);</span><br><span class="line">    printf(&quot;Second: &quot;, &amp;one);</span><br><span class="line">    __isoc99_scanf(&quot;%d&quot;, &amp;two);</span><br><span class="line">    printf(&quot;Third: &quot;, &amp;two);</span><br><span class="line">    __isoc99_scanf(&quot;%d&quot;, &amp;three);               // 输入三个数字</span><br><span class="line">    sub_400806(ptr);</span><br><span class="line">    if ( A0_4_ || one != &apos;^&apos; || (two &amp; 0xFF0000) != 0x5E0000 || three != &apos;^&apos; )</span><br><span class="line">      puts(&quot;Try again.&quot;);</span><br><span class="line">    else</span><br><span class="line">      printf(&quot;Congratulations! \nflag is: X-NUCA&#123;%x%x%x&#125;\n&quot;, one, two, three);</span><br><span class="line">    result = 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    printf(&quot;usage: ./%s &lt;code&gt;\n&quot;, *a2, a3, a2);</span><br><span class="line">    result = 0xFFFFFFFFLL;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>main函数中使用fopen打开了code文件，将打开的文件流当做参数传进了sub_400806，并在此之前程序要求输入了三个数字，跟进去sub_400806发现了while套switch，emmm，这个上的handler比上一个要少，分析起来相对简单一些：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_400806(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  unsigned int v2; // eax</span><br><span class="line">  int v3; // ST1C_4</span><br><span class="line">  unsigned int v4; // eax</span><br><span class="line">  int v5; // ST1C_4</span><br><span class="line">  unsigned int v6; // eax</span><br><span class="line">  int v7; // ST1C_4</span><br><span class="line">  unsigned __int8 v8; // ST1A_1</span><br><span class="line">  unsigned __int8 v9; // ST1A_1</span><br><span class="line">  unsigned __int8 v10; // ST1A_1</span><br><span class="line">  unsigned __int8 v11; // ST1A_1</span><br><span class="line">  unsigned __int8 v12; // ST1A_1</span><br><span class="line">  unsigned __int8 v13; // ST1A_1</span><br><span class="line">  unsigned __int8 v14; // ST1A_1</span><br><span class="line">  unsigned __int8 v15; // ST1A_1</span><br><span class="line">  char v16; // [rsp+19h] [rbp-7h]</span><br><span class="line"></span><br><span class="line">  A0_0_[0] = one;</span><br><span class="line">  A0_1_ = two;                                  // dword_6020A0[0]=one    dword_6020A0[1] = two   dword_6020A0[2] = three</span><br><span class="line">  result = three;</span><br><span class="line">  A0_2_ = three;</span><br><span class="line">  A0_7_ = 0;</span><br><span class="line">  A0_6_ = 2;</span><br><span class="line">  A0_5_ = 0;                                    // 相对偏移</span><br><span class="line">  v16 = 1;</span><br><span class="line">  while ( v16 )</span><br><span class="line">  &#123;</span><br><span class="line">    switch ( *(A0_5_ + a1) )</span><br><span class="line">    &#123;</span><br><span class="line">      case 0u:                                  // ret</span><br><span class="line">        v16 = 0;</span><br><span class="line">        break;</span><br><span class="line">      case 1u:</span><br><span class="line">        v2 = ++A0_5_;</span><br><span class="line">        ++A0_5_;</span><br><span class="line">        v3 = *(v2 + a1);</span><br><span class="line">        v4 = A0_5_++;</span><br><span class="line">        v5 = (*(v4 + a1) &lt;&lt; 8) + v3;</span><br><span class="line">        v6 = A0_5_++;</span><br><span class="line">        v7 = (*(A0_5_ + a1) &lt;&lt; 24) + (*(v6 + a1) &lt;&lt; 16) + v5;</span><br><span class="line">        A0_0_[++A0_6_] = v7;</span><br><span class="line">        break;</span><br><span class="line">      case 2u:</span><br><span class="line">        --A0_6_;                                // 自减</span><br><span class="line">        break;</span><br><span class="line">      case 3u:</span><br><span class="line">        v8 = *(++A0_5_ + a1);</span><br><span class="line">        dword_6024A0[v8] += dword_6024A0[*(++A0_5_ + a1)];// r1 += r2 </span><br><span class="line">        break;</span><br><span class="line">      case 4u:</span><br><span class="line">        v9 = *(++A0_5_ + a1);</span><br><span class="line">        dword_6024A0[v9] -= dword_6024A0[*(++A0_5_ + a1)];// r1 -= r2</span><br><span class="line">        break;</span><br><span class="line">      case 5u:</span><br><span class="line">        v10 = *(++A0_5_ + a1);</span><br><span class="line">        dword_6024A0[v10] *= *(++A0_5_ + a1);   // r1 *= 第二个参数</span><br><span class="line">        break;</span><br><span class="line">      case 6u:</span><br><span class="line">        v11 = *(++A0_5_ + a1);</span><br><span class="line">        dword_6024A0[v11] = dword_6024A0[v11] &gt;&gt; *(++A0_5_ + a1);// r1 = r1 &gt;&gt; 第二个参数</span><br><span class="line">        break;</span><br><span class="line">      case 7u:</span><br><span class="line">        v12 = *(++A0_5_ + a1);</span><br><span class="line">        dword_6024A0[v12] = dword_6024A0[*(++A0_5_ + a1)];// mov r1,r2</span><br><span class="line">        break;</span><br><span class="line">      case 8u:</span><br><span class="line">        v13 = *(++A0_5_ + a1);</span><br><span class="line">        dword_6024A0[v13] = A0_0_[A0_7_ + *(++A0_5_ + a1)];// mov r1,input[i]</span><br><span class="line">        break;</span><br><span class="line">      case 9u:</span><br><span class="line">        v14 = *(++A0_5_ + a1);</span><br><span class="line">        dword_6024A0[v14] ^= dword_6024A0[*(++A0_5_ + a1)];// xor r1,r2</span><br><span class="line">        break;</span><br><span class="line">      case 10u:</span><br><span class="line">        v15 = *(++A0_5_ + a1);</span><br><span class="line">        dword_6024A0[v15] |= dword_6024A0[*(++A0_5_ + a1)];// r1 |= r2</span><br><span class="line">        break;</span><br><span class="line">      default:</span><br><span class="line">        fprintf(stderr, &quot;Invalid opcode. %d\n&quot;, *(A0_5_ + a1));</span><br><span class="line">        exit(1);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">    result = (A0_5_++ + 1);</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里我分析的时候将case8分析错了，我分析成了mov 寄存器,寄存器；后来发现是mov 寄存器，值;这个可把我坑坏了，然后通过题目给出的code文件和各个handler的意思，翻译出汇编代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">初始状态：</span><br><span class="line">寄存器：r0,r1,r2,r3,r4</span><br><span class="line">输入：A[0],A[1],A[2]	分别对应输入的三个数字</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">汇编代码：</span><br><span class="line">09 04 04 					xor r4,r4;</span><br><span class="line">09 00 00 					xor r0,r0;</span><br><span class="line">08 01 00 					mov r1,A[0];</span><br><span class="line">08 02 01 					mov r2,A[1];</span><br><span class="line">08 03 02 					mov r3,A[2];</span><br><span class="line">06 01 04 					r1 = r1&gt;&gt;4</span><br><span class="line">05 01 15 					r1 = r1*15</span><br><span class="line">07 00 01 					mov r0,r1;</span><br><span class="line">04 00 03 					r0 = r0-r3</span><br><span class="line">01 6b cc 7e 1d 				A[3] = 6b+(cc&lt;&lt;8)+(7e&lt;&lt;16)+(1d&lt;&lt;24)</span><br><span class="line">08 01 03 					mov r1,A[3];</span><br><span class="line">04 00 01 					r0 = r0-r1</span><br><span class="line">02 							--dword_6024B8;</span><br><span class="line">0a 04 00 					r4 |= r0;</span><br><span class="line">09 00 00 					xor r0,r0;</span><br><span class="line">08 01 00 					mov r1,A[0];</span><br><span class="line">08 02 01 					mov r2,A[1];</span><br><span class="line">08 03 02 					mov r3,A[2];</span><br><span class="line">06 03 08 					r3 = r3&gt;&gt;8;</span><br><span class="line">05 03 03 					r3 = r3*3;</span><br><span class="line">07 00 03 					mov r0,r3;</span><br><span class="line">03 00 02 					r3 += r2;</span><br><span class="line">01 7c 79 79 60 				A[3] = 7c+(79&lt;&lt;8)+(79&lt;&lt;16)+(60&lt;&lt;24)</span><br><span class="line">08 01 03 					mov r1,A[3];</span><br><span class="line">04 00 01 					r0 -= r1;</span><br><span class="line">02 							dword_6024B8--;</span><br><span class="line">0a 04 00 					r4 |= r0;</span><br><span class="line">09 00 00 					xor r0,r0;</span><br><span class="line">08 01 00 					mov r1,A[0];</span><br><span class="line">08 02 01 					mov r2,A[1];</span><br><span class="line">08 03 02 					mov r3,A[2];</span><br><span class="line">06 01 08 					r1 = r1&gt;&gt;8;</span><br><span class="line">07 00 01 					mov r0,r1;</span><br><span class="line">03 00 02 					r0 += r2;</span><br><span class="line">01 bd bd bc 5f 				A[3] = bd+(bd&lt;&lt;8)+(bc&lt;&lt;16)+(5f&lt;&lt;24)</span><br><span class="line">08 01 03 					mov r1,A[3];</span><br><span class="line">04 00 01 					r1 -= r2;</span><br><span class="line">02 							dword_6024B8--;</span><br><span class="line">0a 04 00 					r4 |= r0;</span><br><span class="line">00 							ret;</span><br></pre></td></tr></table></figure>
<p>结合main函数最后的限制：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if ( A0_4_ || one != 5Eh || (two &amp; 0xFF0000) != 0x5E0000 || three != 5Eh )</span><br><span class="line">      puts(&quot;Try again.&quot;);</span><br><span class="line">    else</span><br><span class="line">      printf(&quot;Congratulations! \nflag is: X-NUCA&#123;%x%x%x&#125;\n&quot;, one, two, three);</span><br><span class="line">    result = 0LL；</span><br></pre></td></tr></table></figure>
<p>最后合一分析出这段字节码的意思是接一个三元一次方程组，我们的输入分别代表这X、Y、Z；根据翻译的汇编代码列出来方程组：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x/(2**4)*0x15-z==0x1d7ecc6b</span><br><span class="line">(z/2**8)*3+y==0x6079797c</span><br><span class="line">x/(2**8)+y==0x5fbcbdbd</span><br></pre></td></tr></table></figure>
<p>很显然这要人工去算是有些不可能的，那么现在就用到前两天学习的Z3库，写脚本应注意的是，该方程中含有模运算，所以我们要把最后的结果进行一下限制：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">x = BitVec(&apos;x&apos;,32)</span><br><span class="line">y = BitVec(&apos;y&apos;,32)</span><br><span class="line">z = BitVec(&apos;z&apos;,32)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(x/(2**4)*0x15-z==0x1d7ecc6b)</span><br><span class="line">s.add((z/2**8)*3+y==0x6079797c)</span><br><span class="line">s.add(x/(2**8)+y==0x5fbcbdbd)</span><br><span class="line">s.add(x&amp;0xff==0x5e)</span><br><span class="line">s.add(y&amp;0xff0000==0x5e0000)</span><br><span class="line">s.add(z&amp;0xff==0x5e)</span><br><span class="line">if s.check()==sat:</span><br><span class="line">	a=s.model()</span><br><span class="line">	print a</span><br><span class="line">else:</span><br><span class="line">	print &quot;NO result!&quot;</span><br><span class="line"></span><br><span class="line">print &quot;X-NUCA&#123;%x%x%x&#125;&quot; % (1583308382,1600020063,1583243102)</span><br></pre></td></tr></table></figure>
<h4 id="flag：X-NUCA-5e5f5e5e5f5e5e5f5e5e5f5e"><a href="#flag：X-NUCA-5e5f5e5e5f5e5e5f5e5e5f5e" class="headerlink" title="flag：X-NUCA{5e5f5e5e5f5e5e5f5e5e5f5e}"></a>flag：X-NUCA{5e5f5e5e5f5e5e5f5e5e5f5e}</h4><h2 id="《加密与解密》"><a href="#《加密与解密》" class="headerlink" title="《加密与解密》"></a>《加密与解密》</h2><p>这本书上有一章讲的虚拟机保护，正在学习……</p>

        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        转发请备注<a href="“https://luobuming.github.io”">一筐萝卜</a>的个人博客 <br>
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
       </p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
