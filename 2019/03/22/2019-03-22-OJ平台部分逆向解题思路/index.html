<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        Jarvis OJ部分逆向解题思路 - 一筐萝卜
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 你若盛开，清风自来！ </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            <i>一筐萝卜</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#login-exe"><span class="toc-text">login.exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Evil-Exe"><span class="toc-text">Evil Exe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 你若盛开，清风自来！ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        Jarvis OJ部分逆向解题思路
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2019-03-22 21:03:28</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#WP" title="WP">WP</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <p>……<br><a id="more"></a></p>
<h3 id="login-exe"><a href="#login-exe" class="headerlink" title="login.exe"></a>login.exe</h3><p>用DIE查看发现没有加什么壳</p>
<p>拖入IDA中发现函数很多，查看字符串发现存在大量以“py”开头的，怀疑是用python写的程序，那么之前做安恒赛的时候碰见过一次，可以使用pyinstxtractor.py这个脚本来将exe文件进行分解成打包前的文件</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">➜  py_exe转源码 python pyinstxtractor.py login.exe </span><br><span class="line">[*] Processing login.exe</span><br><span class="line">[*] Pyinstaller version: 2.1+</span><br><span class="line">[*] Python version: 35</span><br><span class="line">[*] Length of package: 3798016 bytes</span><br><span class="line">[*] Found 34 files <span class="keyword">in</span> CArchive</span><br><span class="line">[*] Beginning extraction<span class="built_in">..</span>.please standby</span><br><span class="line">[+] Possible entry point: pyiboot01_bootstrap</span><br><span class="line">[+] Possible entry point: main</span><br><span class="line">[!] Warning: The<span class="built_in"> script </span>is running <span class="keyword">in</span> a different python version than the one used <span class="keyword">to</span> build the executable</span><br><span class="line">    <span class="builtin-name">Run</span> this<span class="built_in"> script </span><span class="keyword">in</span> Python35 <span class="keyword">to</span> prevent extraction errors(<span class="keyword">if</span> any) during unmarshalling</span><br><span class="line">[!] Unmarshalling FAILED. Cannot extract out00-PYZ.pyz. Extracting remaining files.</span><br><span class="line">[*] Successfully extracted pyinstaller archive: login.exe</span><br><span class="line"></span><br><span class="line">You can now use a python decompiler on the pyc files within the extracted directory</span><br><span class="line">➜  py_exe转源码</span><br></pre></td></tr></table></figure>
<p>可以看到多了一个文件夹：<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"> api-ms-win-crt-conio-l1-<span class="number">1</span>-<span class="number">0</span>.dll         main</span><br><span class="line"> api-ms-win-crt-convert-l1-<span class="number">1</span>-<span class="number">0</span>.dll       main.<span class="keyword">exe</span>.manifest</span><br><span class="line"> api-ms-win-crt-environment-l1-<span class="number">1</span>-<span class="number">0</span>.dll   out00-PYZ.pyz</span><br><span class="line"> api-ms-win-crt-filesystem-l1-<span class="number">1</span>-<span class="number">0</span>.dll    out00-PYZ.pyz_extracted</span><br><span class="line"> api-ms-win-crt-heap-l1-<span class="number">1</span>-<span class="number">0</span>.dll          pyexpat.cp35-win32.<span class="keyword">pyd</span></span><br><span class="line"> api-ms-win-crt-locale-l1-<span class="number">1</span>-<span class="number">0</span>.dll        pyiboot01_bootstrap</span><br><span class="line"> api-ms-win-crt-math-l1-<span class="number">1</span>-<span class="number">0</span>.dll          pyimod01_os_path</span><br><span class="line"> api-ms-win-crt-process-l1-<span class="number">1</span>-<span class="number">0</span>.dll       pyimod02_archive</span><br><span class="line"> api-ms-win-crt-<span class="keyword">runtime</span>-l1-<span class="number">1</span>-<span class="number">0</span>.dll       pyimod03_importers</span><br><span class="line"> api-ms-win-crt-stdio-l1-<span class="number">1</span>-<span class="number">0</span>.dll        <span class="string">'pyi-windows-manifest-filename main.exe.manifest'</span></span><br><span class="line"> api-ms-win-crt-<span class="built_in">string</span>-l1-<span class="number">1</span>-<span class="number">0</span>.dll        python35.dll</span><br><span class="line"> api-ms-win-crt-time-l1-<span class="number">1</span>-<span class="number">0</span>.dll          select.cp35-win32.<span class="keyword">pyd</span></span><br><span class="line"> api-ms-win-crt-utility-l1-<span class="number">1</span>-<span class="number">0</span>.dll       _socket.cp35-win32.<span class="keyword">pyd</span></span><br><span class="line"> base_library.zip                        _ssl.cp35-win32.<span class="keyword">pyd</span></span><br><span class="line"> _bz2.cp35-win32.<span class="keyword">pyd</span>                     struct</span><br><span class="line"> _ctypes.cp35-win32.<span class="keyword">pyd</span>                  unicodedata.cp35-win32.<span class="keyword">pyd</span></span><br><span class="line"> _hashlib.cp35-win32.<span class="keyword">pyd</span>                 VCRUNTIME140.dll</span><br><span class="line"> _lzma.cp35-win32.<span class="keyword">pyd</span></span><br><span class="line">➜  login.exe_extracted <span class="keyword">file</span> *</span><br><span class="line">api-ms-win-crt-conio-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>                 PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-convert-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>               PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-environment-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>           PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-filesystem-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>            PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-heap-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>                  PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-locale-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>                PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-math-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>                  PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-process-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>               PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-<span class="keyword">runtime</span>-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>               PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-stdio-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>                 PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-<span class="built_in">string</span>-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>                PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-time-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>                  PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">api-ms-win-crt-utility-l1-<span class="number">1</span>-<span class="number">0</span>.<span class="keyword">dl</span><span class="variable">l:</span>               PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows</span><br><span class="line">base_library.zip:                                Zip archive data, at least v2.<span class="number">0</span> <span class="keyword">to</span> extract</span><br><span class="line">_bz2.cp35-win32.<span class="keyword">pyd</span>:                             PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">_ctypes.cp35-win32.<span class="keyword">pyd</span>:                          PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">_hashlib.cp35-win32.<span class="keyword">pyd</span>:                         PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">_lzma.cp35-win32.<span class="keyword">pyd</span>:                            PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">main:                                            data</span><br><span class="line">main.<span class="keyword">exe</span>.manifes<span class="variable">t:</span>                               XML <span class="number">1.0</span> document, ASCII text, with CRLF <span class="built_in">line</span> terminators</span><br><span class="line">out00-PYZ.pyz:                                   data</span><br><span class="line">out00-PYZ.pyz_extracted:                         directory</span><br><span class="line">pyexpat.cp35-win32.<span class="keyword">pyd</span>:                          PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">pyiboot01_bootstrap:                             data</span><br><span class="line">pyimod01_os_path:                                <span class="keyword">python</span> <span class="number">3.5</span>.<span class="number">1</span>- byte-compiled</span><br><span class="line">pyimod02_archive:                                <span class="keyword">python</span> <span class="number">3.5</span>.<span class="number">1</span>- byte-compiled</span><br><span class="line">pyimod03_importer<span class="variable">s:</span>                              <span class="keyword">python</span> <span class="number">3.5</span>.<span class="number">1</span>- byte-compiled</span><br><span class="line">pyi-windows-manifest-filename main.<span class="keyword">exe</span>.manifes<span class="variable">t:</span> <span class="built_in">empty</span></span><br><span class="line">python35.<span class="keyword">dl</span><span class="variable">l:</span>                                    PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">select.cp35-win32.<span class="keyword">pyd</span>:                           PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">_socket.cp35-win32.<span class="keyword">pyd</span>:                          PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">_ssl.cp35-win32.<span class="keyword">pyd</span>:                             PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">struc<span class="variable">t:</span>                                          <span class="keyword">python</span> <span class="number">3.5</span>.<span class="number">1</span>- byte-compiled</span><br><span class="line">unicodedata.cp35-win32.<span class="keyword">pyd</span>:                      PE32 <span class="built_in">executable</span> (DLL) (GUI) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br><span class="line">VCRUNTIME140.<span class="keyword">dl</span><span class="variable">l:</span>                                PE32 <span class="built_in">executable</span> (DLL) (console) Intel <span class="number">80386</span>, <span class="keyword">for</span> MS Windows, UPX compressed</span><br></pre></td></tr></table></figure></p>
<p>file全部文件发现存在upx加壳的dll文件，那么一个一个去壳，经过测试发现python35.dll中有关键字符串</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  upx-<span class="number">3.91</span>-amd64_linux strings python35.dll| <span class="keyword">grep</span> <span class="string">'assword'</span> </span><br><span class="line">Password: </span><br><span class="line">➜  upx-<span class="number">3.91</span>-amd64_linux strings python35.dll| <span class="keyword">grep</span> <span class="string">'UserName'</span></span><br><span class="line">GetUserNameW</span><br><span class="line">➜  upx-<span class="number">3.91</span>-amd64_linux strings python35.dll| <span class="keyword">grep</span> <span class="string">'Access Denied!'</span></span><br><span class="line">Access Denied!</span><br></pre></td></tr></table></figure>
<p>把python35.dll拖入IDA，通过字符串来定位到关键代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_1E183D20</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> *Str2; <span class="comment">// [esp+4h] [ebp-40Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+8h] [ebp-408h]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [esp+Ch] [ebp-404h]</span></span><br><span class="line">  <span class="keyword">char</span> Dst[<span class="number">512</span>]; <span class="comment">// [esp+20Ch] [ebp-204h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(Dst, <span class="number">0</span>, <span class="number">0x200</span>u);</span><br><span class="line">  result = PyArg_ParseTuple(a2, <span class="string">"is"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;v7);</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_1E04E550(<span class="string">"Password: "</span>, (<span class="keyword">char</span>)Str2);</span><br><span class="line">    sub_1E183CF0(<span class="string">"%s"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)Dst);</span><br><span class="line">    <span class="keyword">if</span> ( v7 == <span class="number">4946</span> &amp;&amp; <span class="built_in">strlen</span>(Dst) == <span class="number">16</span> &amp;&amp; !<span class="built_in">strncmp</span>(<span class="string">"HXB_Admin"</span>, Str2, <span class="number">9u</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = Dst[v3];</span><br><span class="line">        v5 = v3 ^ v4 ^ byte_1E253040[v3];</span><br><span class="line">        <span class="keyword">if</span> ( v3 != (v4 ^ byte_1E253040[v3]) )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> ( ++v3 &gt;= <span class="number">16</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">memset</span>(&amp;v8, v5, <span class="number">0x200</span>u);</span><br><span class="line">          sub_1E03CD40(&amp;v8, <span class="string">"Congratulations!\nflag&#123;%s&#125;."</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)Dst);</span><br><span class="line">          <span class="keyword">return</span> Py_BuildValue(<span class="string">"s"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;v8);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    result = Py_BuildValue(<span class="string">"s"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="string">"Access Denied!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关键代码的流程很简单，用户名必须是HXB_Admin，然后密码的长度是16，然后在while循环中一位一位的比较密码，对应的解密脚本：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x50</span>,<span class="number">0x78</span>,<span class="number">0x76</span>,<span class="number">0x6B</span>,<span class="number">0x34</span>,<span class="number">0x6B</span>,<span class="number">0x59</span>,<span class="number">0x63</span>,<span class="number">0x49</span>,<span class="number">0x56</span>,<span class="number">0x6C</span>,<span class="number">0x4A</span>,<span class="number">0x53</span>,<span class="number">0x65</span>,<span class="number">0x4F</span>,<span class="number">0x3F</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line">for x <span class="keyword">in</span> xrange(len(a)):</span><br><span class="line">	flag+= chr(a[x]^x)</span><br><span class="line">print <span class="string">"flag&#123;"</span>+flag+<span class="string">"&#125;"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="symbol">out:</span></span><br><span class="line">flag&#123;Pyth0n_dA_fA_hA0&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Evil-Exe"><a href="#Evil-Exe" class="headerlink" title="Evil Exe"></a>Evil Exe</h3><p>readme.txt中的内容：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">挑战：《恶意软件分析》</span><br><span class="line"></span><br><span class="line">赛题背景： 员工小<span class="keyword">A</span>收到了一封邮件，带一个文档附件，小<span class="keyword">A</span>随手打开了附件。随后IT部门发现小<span class="keyword">A</span>的电脑发出了异常网络访问请求，进一步调查发现小<span class="keyword">A</span>当时所打开的附件其实是一个伪装成word文档的恶意可执行文件。</span><br><span class="line"></span><br><span class="line">赛题描述： 请在试着分析evil.exe和其所下载的x.jpg, 从中找出key.</span><br><span class="line"></span><br><span class="line">评分标准： 密钥正确则可进入下一题。</span><br></pre></td></tr></table></figure>
<p>对evil.exe查壳发现是upx，但是换了好几个UPX脱壳机都没办法正常脱壳，只好手动脱壳了</p>
<p>首先载入OD中<br><img src="https://s2.ax1x.com/2019/03/22/A8fLp6.png" alt><br>流程很简单，但是我不知道为什么pushad和ret有两个断点，害的我全程f9，当eax等于0的时候跳转到了0x43dab0<br><img src="https://s2.ax1x.com/2019/03/22/A8fX6O.png" alt><br><img src="https://s2.ax1x.com/2019/03/22/A8fz0H.png" alt><br>跳转过来之后的第一条汇编代码就是pushad，那么我们在执行过这一句之后对esp下断点：<br><img src="https://s2.ax1x.com/2019/03/22/A8h9AA.png" alt><br>然后f9运行，直接来到popad处，<br><img src="https://s2.ax1x.com/2019/03/22/A8hF9P.png" alt><br>jmp则是跳转到真正的代码处<br><img src="https://s2.ax1x.com/2019/03/22/A8hAc8.png" alt> </p>
<p>此时将程序dump下来，再放入到IDA中我们可以发现成功的载入并且分析<br><img src="https://s2.ax1x.com/2019/03/22/A8hZng.png" alt><br>搜索字符串发现一个路径“<a href="http://www.ddctf.com/x.jpg”，跟踪找到关键代码" target="_blank" rel="noopener">http://www.ddctf.com/x.jpg”，跟踪找到关键代码</a></p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">void</span> *__cdecl <span class="keyword">sub_4018F0(unsigned </span>int *<span class="built_in">a1</span>)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int <span class="built_in">v2</span><span class="comment">; // [esp+0h] [ebp-18h]</span></span><br><span class="line">  DWORD dwNumberOfBytesRead<span class="comment">; // [esp+4h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">BOOL </span><span class="built_in">v4</span><span class="comment">; // [esp+8h] [ebp-10h]</span></span><br><span class="line">  void *<span class="built_in">v5</span><span class="comment">; // [esp+Ch] [ebp-Ch]</span></span><br><span class="line">  HINTERNET hFile<span class="comment">; // [esp+10h] [ebp-8h]</span></span><br><span class="line">  HINTERNET hInternet<span class="comment">; // [esp+14h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  dwNumberOfBytesRead = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">  <span class="built_in">v2</span> = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">  hInternet = InternetOpenA(<span class="string">"DDCTF"</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)<span class="comment">;</span></span><br><span class="line">  hFile = InternetOpenUrlA(hInternet, <span class="string">"http://www.ddctf.com/x.jpg"</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0x4000000</span>u, <span class="number">0</span>)<span class="comment">;</span></span><br><span class="line">  <span class="meta">if</span> ( !hFile )</span><br><span class="line">    return <span class="number">0</span><span class="comment">;</span></span><br><span class="line">  <span class="built_in">v5</span> = malloc(<span class="number">0x100000</span>u)<span class="comment">;</span></span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">v4</span> = InternetReadFile(hFile, (char *)<span class="built_in">v5</span> + <span class="built_in">v2</span>, <span class="number">0x100000</span> - <span class="built_in">v2</span>, &amp;dwNumberOfBytesRead)<span class="comment">;</span></span><br><span class="line">    <span class="meta">if</span> ( !<span class="built_in">v4</span> )</span><br><span class="line">      <span class="keyword">break;</span></span><br><span class="line"><span class="keyword"> </span>   <span class="built_in">v2</span> += dwNumberOfBytesRead<span class="comment">;</span></span><br><span class="line">    <span class="meta">if</span> ( !dwNumberOfBytesRead )</span><br><span class="line">      <span class="keyword">break;</span></span><br><span class="line"><span class="keyword"> </span> &#125;</span><br><span class="line">  <span class="meta">while</span> ( <span class="built_in">v2</span> &lt; <span class="number">0x100000</span> )<span class="comment">;</span></span><br><span class="line">  InternetCloseHandle(hFile)<span class="comment">;</span></span><br><span class="line">  <span class="meta">if</span> ( <span class="built_in">v2</span> &lt;= <span class="number">0x100000</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *<span class="built_in">a1</span> = <span class="built_in">v2</span><span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    free(<span class="built_in">v5</span>)<span class="comment">;</span></span><br><span class="line">    <span class="built_in">v5</span> = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">  return <span class="built_in">v5</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出来，打开一个URL，将存储的信息的地址最后存在a1的参数中然后返回，对该函数名查看交叉引用：<br><img src="https://s2.ax1x.com/2019/03/22/A8heBQ.png" alt><br>发现就一处，那就好办了，这个就是更关键的代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">stdcall <span class="title">WinMain</span><span class="params">(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, <span class="keyword">int</span> nShowCmd)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">void</span> *v5; <span class="comment">// ST10_4</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [esp+4h] [ebp-118h]</span></span><br><span class="line">  <span class="keyword">size_t</span> dwSize; <span class="comment">// [esp+114h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">void</span> *v8; <span class="comment">// [esp+118h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( sub_401370(hInstance) == <span class="number">6</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  sub_401620();</span><br><span class="line">  v8 = sub_4018F0(&amp;dwSize);                     <span class="comment">// 获取图片数据</span></span><br><span class="line">  <span class="keyword">if</span> ( v8 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( dwSize )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = <span class="built_in">malloc</span>(dwSize);</span><br><span class="line">      sub_401740(&amp;v6, <span class="number">-176926348</span>, <span class="number">4884308</span>);</span><br><span class="line">      sub_401800(&amp;v6, v8, v5, dwSize);</span><br><span class="line">      sub_401220(v5, dwSize);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(v8);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先分配一个和图片数据大小一样的空间</p>
<p>函数sub_401740是初始化了一个数组：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl <span class="keyword">sub_401740(_DWORD </span>*<span class="built_in">a1</span>, unsigned __int64 <span class="built_in">a2</span>)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned __int64 v2<span class="comment">; // rax</span></span><br><span class="line">  char v4[<span class="number">8</span>]<span class="comment">; // [esp+0h] [ebp-10h]</span></span><br><span class="line">  int i<span class="comment">; // [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  LODWORD(v2) = <span class="built_in">a1</span><span class="comment">;</span></span><br><span class="line">  *<span class="built_in">a1</span> = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">  <span class="built_in">a1</span>[<span class="number">1</span>] = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">  for ( i = <span class="number">0</span><span class="comment">; i &lt; 8; ++i )</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4[i] = <span class="built_in">a2</span><span class="comment">;</span></span><br><span class="line">    v2 = <span class="built_in">a2</span> &gt;&gt; <span class="number">8</span><span class="comment">;</span></span><br><span class="line">    <span class="built_in">a2</span> &gt;&gt;= <span class="number">8</span><span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">  for ( i = <span class="number">0</span><span class="comment">; i &lt; 256; ++i )</span></span><br><span class="line">  &#123;</span><br><span class="line">    *((_BYTE *)<span class="built_in">a1</span> + i + <span class="number">8</span>) = i + v4[i % <span class="number">8</span>]<span class="comment">;</span></span><br><span class="line">    LODWORD(v2) = i + <span class="number">1</span><span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">  return v2<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数sub_401800是根据上一个函数生成的数组和图片的数据生成新数据存在malloc申请的空间中</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">void __cdecl <span class="keyword">sub_401800(int </span>*<span class="built_in">a1</span>, int <span class="built_in">a2</span>, int <span class="built_in">a3</span>, unsigned int <span class="built_in">a4</span>)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned __int8 v4<span class="comment">; // ST02_1</span></span><br><span class="line">  unsigned __int8 v5<span class="comment">; // ST03_1</span></span><br><span class="line">  unsigned int i<span class="comment">; // [esp+4h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  for ( i = <span class="number">0</span><span class="comment">; i &lt; a4; ++i )</span></span><br><span class="line">  &#123;</span><br><span class="line">    *<span class="built_in">a1</span> = (*<span class="built_in">a1</span> + <span class="number">1</span>) % <span class="number">256</span><span class="comment">;</span></span><br><span class="line">    <span class="built_in">a1</span>[<span class="number">1</span>] = (*(<span class="built_in">a1</span> + *<span class="built_in">a1</span> + <span class="number">8</span>) + <span class="built_in">a1</span>[<span class="number">1</span>]) % <span class="number">256</span><span class="comment">;</span></span><br><span class="line">    v4 = *(<span class="built_in">a1</span> + *<span class="built_in">a1</span> + <span class="number">8</span>)<span class="comment">;</span></span><br><span class="line">    v5 = *(<span class="built_in">a1</span> + <span class="built_in">a1</span>[<span class="number">1</span>] + <span class="number">8</span>)<span class="comment">;</span></span><br><span class="line">    *(<span class="built_in">a1</span> + *<span class="built_in">a1</span> + <span class="number">8</span>) = v5<span class="comment">;</span></span><br><span class="line">    *(<span class="built_in">a1</span> + <span class="built_in">a1</span>[<span class="number">1</span>] + <span class="number">8</span>) = v4<span class="comment">;</span></span><br><span class="line">    *(i + <span class="built_in">a3</span>) = *(<span class="built_in">a1</span> + (v5 + v4) % <span class="number">256</span> + <span class="number">8</span>) ^ *(i + <span class="built_in">a2</span>)<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数sub_401220是用VirtualAlloc申请了一个新的内存页，然后定义了一个指针指向这个内存页，随后用memcpy将刚刚的新数据拷贝到这个新的内存页中，然后来了一个for循环，对每一位都和自己的索引进行异或，最后再执行了这段数据</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *__cdecl sub_401220(<span class="name">void</span> *a1, SIZE_T dwSize)</span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *result<span class="comment">; // eax</span></span><br><span class="line">  _DWORD *lpAddress; // [esp+0h] [ebp-8h]</span><br><span class="line">  SIZE_T i; // [esp+4h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  result = VirtualAlloc(0, dwSize, 0x1000u, 0x40u);</span><br><span class="line">  lpAddress = result;</span><br><span class="line">  if ( result )</span><br><span class="line">  &#123;</span><br><span class="line">    memcpy(result, a1, dwSize);</span><br><span class="line">    for ( i = 0; i &lt; dwSize; ++i )</span><br><span class="line">      *(<span class="name">lpAddress</span> + i) ^= i<span class="comment">;</span></span><br><span class="line">    if ( <span class="name">_time32</span>(<span class="number">0</span>) - *lpAddress &gt;= 0 &amp;&amp; _time32(0) - *lpAddress &lt;= <span class="number">1800</span> )</span><br><span class="line">      result = ((<span class="name">lpAddress</span> + <span class="number">1</span>))()<span class="comment">;</span></span><br><span class="line">    else</span><br><span class="line">      result = VirtualFree(<span class="name">lpAddress</span>, dwSize, <span class="number">0</span>x4000u)<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">  return result<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过我们已经获得到的信息我们可以得知，解密出来的数据是一个可以执行的代码</p>
<p>然后我们一步一步的解密数据：</p>
<ul>
<li>初始化数组：<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v4 = [<span class="number">0x74,0x51</span>,<span class="number">0</span>x74,<span class="number">0</span>xf5,<span class="number">0x54,0x87</span>,<span class="number">0</span>x4a,<span class="number">0</span>x00]</span><br><span class="line">arr2 = [<span class="number">0,0,0,0</span>,<span class="number">0,0,0,0</span>]</span><br><span class="line">for x in range(<span class="number">256</span>):</span><br><span class="line">  arr2.append((x+v4[x%<span class="number">8</span>])&amp;<span class="number">0</span>xff)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>然后根据数组和图片数据生成新数据：<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">"x.jpg"</span>,<span class="string">"r"</span>)</span><br><span class="line">data = f.read()</span><br><span class="line">new_data = [<span class="string">""</span> for x <span class="keyword">in</span> range(len(data))]</span><br><span class="line">for x <span class="keyword">in</span> xrange(len(data)):</span><br><span class="line">    arr2[<span class="number">0</span>]=(arr2[<span class="number">0</span>]+<span class="number">1</span>)<span class="subst">%256</span></span><br><span class="line">    arr2[<span class="number">1</span>]=(arr2[arr2[<span class="number">0</span>]+<span class="number">8</span>]+arr2[<span class="number">1</span>])<span class="subst">%256</span></span><br><span class="line">    v4 = arr2[arr2[<span class="number">0</span>]+<span class="number">8</span>]</span><br><span class="line">    v5 = arr2[arr2[<span class="number">1</span>]+<span class="number">8</span>]</span><br><span class="line">    arr2[arr2[<span class="number">0</span>]+<span class="number">8</span>] = v5</span><br><span class="line">    arr2[arr2[<span class="number">1</span>]+<span class="number">8</span>] = v4</span><br><span class="line">    new_data[x] = ((arr2[(v5+v4)<span class="subst">%256</span>+<span class="number">8</span>]^ord(data[x]))&amp;<span class="number">0xff</span>^x)&amp;<span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">for x <span class="keyword">in</span> range(len(new_data)):</span><br><span class="line">    print hex(new_data[x]),</span><br><span class="line"></span><br><span class="line"><span class="keyword">out</span>：</span><br><span class="line"><span class="number">0xee</span> <span class="number">0x55</span> <span class="number">0xd</span> <span class="number">0x59</span> <span class="number">0xd9</span> <span class="number">0xeb</span> <span class="number">0x9b</span> <span class="number">0xd9</span> <span class="number">0x74</span> <span class="number">0x24</span> <span class="number">0xf4</span> <span class="number">0x31</span> <span class="number">0xd2</span> <span class="number">0xb2</span> <span class="number">0x77</span> <span class="number">0x31</span> <span class="number">0xc9</span> <span class="number">0x64</span> <span class="number">0x8b</span> <span class="number">0x71</span> <span class="number">0x30</span> <span class="number">0x8b</span> <span class="number">0x76</span> <span class="number">0xc</span> <span class="number">0x8b</span> <span class="number">0x76</span> <span class="number">0x1c</span> <span class="number">0x8b</span> <span class="number">0x46</span> <span class="number">0x8</span> <span class="number">0x8b</span> <span class="number">0x7e</span> <span class="number">0x20</span> <span class="number">0x8b</span> <span class="number">0x36</span> <span class="number">0x38</span> <span class="number">0x4f</span> <span class="number">0x18</span> <span class="number">0x75</span> <span class="number">0xf3</span> <span class="number">0x59</span> <span class="number">0x1</span> <span class="number">0xd1</span> <span class="number">0xff</span> <span class="number">0xe1</span> <span class="number">0x60</span> <span class="number">0x8b</span> <span class="number">0x6c</span> <span class="number">0x24</span> <span class="number">0x24</span> <span class="number">0x8b</span> <span class="number">0x45</span> <span class="number">0x3c</span> <span class="number">0x8b</span> <span class="number">0x54</span> <span class="number">0x28</span> <span class="number">0x78</span> <span class="number">0x1</span> <span class="number">0xea</span> <span class="number">0x8b</span> <span class="number">0x4a</span> <span class="number">0x18</span> <span class="number">0x8b</span> <span class="number">0x5a</span> <span class="number">0x20</span> <span class="number">0x1</span> <span class="number">0xeb</span> <span class="number">0xe3</span> <span class="number">0x34</span> <span class="number">0x49</span> <span class="number">0x8b</span> <span class="number">0x34</span> <span class="number">0x8b</span> <span class="number">0x1</span> <span class="number">0xee</span> <span class="number">0x31</span> <span class="number">0xff</span> <span class="number">0x31</span> <span class="number">0xc0</span> <span class="number">0xfc</span> <span class="number">0xac</span> <span class="number">0x84</span> <span class="number">0xc0</span> <span class="number">0x74</span> <span class="number">0x7</span> <span class="number">0xc1</span> <span class="number">0xcf</span> <span class="number">0xd</span> <span class="number">0x1</span> <span class="number">0xc7</span> <span class="number">0xeb</span> <span class="number">0xf4</span> <span class="number">0x3b</span> <span class="number">0x7c</span> <span class="number">0x24</span> <span class="number">0x28</span> <span class="number">0x75</span> <span class="number">0xe1</span> <span class="number">0x8b</span> <span class="number">0x5a</span> <span class="number">0x24</span> <span class="number">0x1</span> <span class="number">0xeb</span> <span class="number">0x66</span> <span class="number">0x8b</span> <span class="number">0xc</span> <span class="number">0x4b</span> <span class="number">0x8b</span> <span class="number">0x5a</span> <span class="number">0x1c</span> <span class="number">0x1</span> <span class="number">0xeb</span> <span class="number">0x8b</span> <span class="number">0x4</span> <span class="number">0x8b</span> <span class="number">0x1</span> <span class="number">0xe8</span> <span class="number">0x89</span> <span class="number">0x44</span> <span class="number">0x24</span> <span class="number">0x1c</span> <span class="number">0x61</span> <span class="number">0xc3</span> <span class="number">0xb2</span> <span class="number">0x8</span> <span class="number">0x29</span> <span class="number">0xd4</span> <span class="number">0x89</span> <span class="number">0xe5</span> <span class="number">0x89</span> <span class="number">0xc2</span> <span class="number">0x68</span> <span class="number">0x8e</span> <span class="number">0x4e</span> <span class="number">0xe</span> <span class="number">0xec</span> <span class="number">0x52</span> <span class="number">0xe8</span> <span class="number">0x9f</span> <span class="number">0xff</span> <span class="number">0xff</span> <span class="number">0xff</span> <span class="number">0x89</span> <span class="number">0x45</span> <span class="number">0x4</span> <span class="number">0xbb</span> <span class="number">0x7e</span> <span class="number">0xd8</span> <span class="number">0xe2</span> <span class="number">0x73</span> <span class="number">0x87</span> <span class="number">0x1c</span> <span class="number">0x24</span> <span class="number">0x52</span> <span class="number">0xe8</span> <span class="number">0x8e</span> <span class="number">0xff</span> <span class="number">0xff</span> <span class="number">0xff</span> <span class="number">0x89</span> <span class="number">0x45</span> <span class="number">0x8</span> <span class="number">0x68</span> <span class="number">0x6c</span> <span class="number">0x6c</span> <span class="number">0x20</span> <span class="number">0x41</span> <span class="number">0x68</span> <span class="number">0x33</span> <span class="number">0x32</span> <span class="number">0x2e</span> <span class="number">0x64</span> <span class="number">0x68</span> <span class="number">0x75</span> <span class="number">0x73</span> <span class="number">0x65</span> <span class="number">0x72</span> <span class="number">0x30</span> <span class="number">0xdb</span> <span class="number">0x88</span> <span class="number">0x5c</span> <span class="number">0x24</span> <span class="number">0xa</span> <span class="number">0x89</span> <span class="number">0xe6</span> <span class="number">0x56</span> <span class="number">0xff</span> <span class="number">0x55</span> <span class="number">0x4</span> <span class="number">0x89</span> <span class="number">0xc2</span> <span class="number">0x50</span> <span class="number">0xbb</span> <span class="number">0xa8</span> <span class="number">0xa2</span> <span class="number">0x4d</span> <span class="number">0xbc</span> <span class="number">0x87</span> <span class="number">0x1c</span> <span class="number">0x24</span> <span class="number">0x52</span> <span class="number">0xe8</span> <span class="number">0x5f</span> <span class="number">0xff</span> <span class="number">0xff</span> <span class="number">0xff</span> <span class="number">0x68</span> <span class="number">0x58</span> <span class="number">0x20</span> <span class="number">0x20</span> <span class="number">0x20</span> <span class="number">0x68</span> <span class="number">0x72</span> <span class="number">0x61</span> <span class="number">0x74</span> <span class="number">0x73</span> <span class="number">0x68</span> <span class="number">0x43</span> <span class="number">0x6f</span> <span class="number">0x6e</span> <span class="number">0x67</span> <span class="number">0x31</span> <span class="number">0xdb</span> <span class="number">0x88</span> <span class="number">0x5c</span> <span class="number">0x24</span> <span class="number">0x8</span> <span class="number">0x89</span> <span class="number">0xe3</span> <span class="number">0x68</span> <span class="number">0x63</span> <span class="number">0x6f</span> <span class="number">0x6d</span> <span class="number">0x58</span> <span class="number">0x68</span> <span class="number">0x69</span> <span class="number">0x6e</span> <span class="number">0x67</span> <span class="number">0x2e</span> <span class="number">0x68</span> <span class="number">0x63</span> <span class="number">0x68</span> <span class="number">0x75</span> <span class="number">0x78</span> <span class="number">0x68</span> <span class="number">0x64</span> <span class="number">0x69</span> <span class="number">0x64</span> <span class="number">0x69</span> <span class="number">0x68</span> <span class="number">0x61</span> <span class="number">0x64</span> <span class="number">0x65</span> <span class="number">0x40</span> <span class="number">0x68</span> <span class="number">0x64</span> <span class="number">0x39</span> <span class="number">0x65</span> <span class="number">0x39</span> <span class="number">0x68</span> <span class="number">0x37</span> <span class="number">0x31</span> <span class="number">0x37</span> <span class="number">0x33</span> <span class="number">0x68</span> <span class="number">0x64</span> <span class="number">0x34</span> <span class="number">0x61</span> <span class="number">0x65</span> <span class="number">0x68</span> <span class="number">0x64</span> <span class="number">0x36</span> <span class="number">0x39</span> <span class="number">0x62</span> <span class="number">0x68</span> <span class="number">0x62</span> <span class="number">0x31</span> <span class="number">0x63</span> <span class="number">0x34</span> <span class="number">0x68</span> <span class="number">0x61</span> <span class="number">0x64</span> <span class="number">0x61</span> <span class="number">0x63</span> <span class="number">0x68</span> <span class="number">0x63</span> <span class="number">0x34</span> <span class="number">0x39</span> <span class="number">0x62</span> <span class="number">0x68</span> <span class="number">0x54</span> <span class="number">0x46</span> <span class="number">0x2d</span> <span class="number">0x63</span> <span class="number">0x68</span> <span class="number">0x20</span> <span class="number">0x44</span> <span class="number">0x44</span> <span class="number">0x43</span> <span class="number">0x68</span> <span class="number">0x4b</span> <span class="number">0x65</span> <span class="number">0x79</span> <span class="number">0x3a</span> <span class="number">0x31</span> <span class="number">0xc9</span> <span class="number">0x88</span> <span class="number">0x4c</span> <span class="number">0x24</span> <span class="number">0x3b</span> <span class="number">0x89</span> <span class="number">0xe1</span> <span class="number">0x31</span> <span class="number">0xd2</span> <span class="number">0x52</span> <span class="number">0x53</span> <span class="number">0x51</span> <span class="number">0x52</span> <span class="number">0xff</span> <span class="number">0xd0</span> <span class="number">0x31</span> <span class="number">0xc0</span> <span class="number">0x50</span> <span class="number">0xff</span> <span class="number">0x55</span> <span class="number">0x8</span></span><br></pre></td></tr></table></figure></p>
<p>然后用一个神器AsmToMachineCode.exe：<br>现将数据转成\x表示的十六进制：<br><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">\x</span>ee<span class="symbol">\x</span>55<span class="symbol">\x</span>d<span class="symbol">\x</span>59<span class="symbol">\x</span>d9<span class="symbol">\x</span>eb<span class="symbol">\x</span>9b<span class="symbol">\x</span>d9<span class="symbol">\x</span>74<span class="symbol">\x</span>24<span class="symbol">\x</span>f4<span class="symbol">\x</span>31<span class="symbol">\x</span>d2<span class="symbol">\x</span>b2<span class="symbol">\x</span>77<span class="symbol">\x</span>31<span class="symbol">\x</span>c9<span class="symbol">\x</span>64<span class="symbol">\x</span>8b<span class="symbol">\x</span>71<span class="symbol">\x</span>30<span class="symbol">\x</span>8b<span class="symbol">\x</span>76<span class="symbol">\x</span>c<span class="symbol">\x</span>8b<span class="symbol">\x</span>76<span class="symbol">\x</span>1c<span class="symbol">\x</span>8b<span class="symbol">\x</span>46<span class="symbol">\x</span>8<span class="symbol">\x</span>8b<span class="symbol">\x</span>7e<span class="symbol">\x</span>20<span class="symbol">\x</span>8b<span class="symbol">\x</span>36<span class="symbol">\x</span>38<span class="symbol">\x</span>4f<span class="symbol">\x</span>18<span class="symbol">\x</span>75<span class="symbol">\x</span>f3<span class="symbol">\x</span>59<span class="symbol">\x</span>1<span class="symbol">\x</span>d1<span class="symbol">\x</span>ff<span class="symbol">\x</span>e1<span class="symbol">\x</span>60<span class="symbol">\x</span>8b<span class="symbol">\x</span>6c<span class="symbol">\x</span>24<span class="symbol">\x</span>24<span class="symbol">\x</span>8b<span class="symbol">\x</span>45<span class="symbol">\x</span>3c<span class="symbol">\x</span>8b<span class="symbol">\x</span>54<span class="symbol">\x</span>28<span class="symbol">\x</span>78<span class="symbol">\x</span>1<span class="symbol">\x</span>ea<span class="symbol">\x</span>8b<span class="symbol">\x</span>4a<span class="symbol">\x</span>18<span class="symbol">\x</span>8b<span class="symbol">\x</span>5a<span class="symbol">\x</span>20<span class="symbol">\x</span>1<span class="symbol">\x</span>eb<span class="symbol">\x</span>e3<span class="symbol">\x</span>34<span class="symbol">\x</span>49<span class="symbol">\x</span>8b<span class="symbol">\x</span>34<span class="symbol">\x</span>8b<span class="symbol">\x</span>1<span class="symbol">\x</span>ee<span class="symbol">\x</span>31<span class="symbol">\x</span>ff<span class="symbol">\x</span>31<span class="symbol">\x</span>c0<span class="symbol">\x</span>fc<span class="symbol">\x</span>ac<span class="symbol">\x</span>84<span class="symbol">\x</span>c0<span class="symbol">\x</span>74<span class="symbol">\x</span>7<span class="symbol">\x</span>c1<span class="symbol">\x</span>cf<span class="symbol">\x</span>d<span class="symbol">\x</span>1<span class="symbol">\x</span>c7<span class="symbol">\x</span>eb<span class="symbol">\x</span>f4<span class="symbol">\x</span>3b<span class="symbol">\x</span>7c<span class="symbol">\x</span>24<span class="symbol">\x</span>28<span class="symbol">\x</span>75<span class="symbol">\x</span>e1<span class="symbol">\x</span>8b<span class="symbol">\x</span>5a<span class="symbol">\x</span>24<span class="symbol">\x</span>1<span class="symbol">\x</span>eb<span class="symbol">\x</span>66<span class="symbol">\x</span>8b<span class="symbol">\x</span>c<span class="symbol">\x</span>4b<span class="symbol">\x</span>8b<span class="symbol">\x</span>5a<span class="symbol">\x</span>1c<span class="symbol">\x</span>1<span class="symbol">\x</span>eb<span class="symbol">\x</span>8b<span class="symbol">\x</span>4<span class="symbol">\x</span>8b<span class="symbol">\x</span>1<span class="symbol">\x</span>e8<span class="symbol">\x</span>89<span class="symbol">\x</span>44<span class="symbol">\x</span>24<span class="symbol">\x</span>1c<span class="symbol">\x</span>61<span class="symbol">\x</span>c3<span class="symbol">\x</span>b2<span class="symbol">\x</span>8<span class="symbol">\x</span>29<span class="symbol">\x</span>d4<span class="symbol">\x</span>89<span class="symbol">\x</span>e5<span class="symbol">\x</span>89<span class="symbol">\x</span>c2<span class="symbol">\x</span>68<span class="symbol">\x</span>8e<span class="symbol">\x</span>4e<span class="symbol">\x</span>e<span class="symbol">\x</span>ec<span class="symbol">\x</span>52<span class="symbol">\x</span>e8<span class="symbol">\x</span>9f<span class="symbol">\x</span>ff<span class="symbol">\x</span>ff<span class="symbol">\x</span>ff<span class="symbol">\x</span>89<span class="symbol">\x</span>45<span class="symbol">\x</span>4<span class="symbol">\x</span>bb<span class="symbol">\x</span>7e<span class="symbol">\x</span>d8<span class="symbol">\x</span>e2<span class="symbol">\x</span>73<span class="symbol">\x</span>87<span class="symbol">\x</span>1c<span class="symbol">\x</span>24<span class="symbol">\x</span>52<span class="symbol">\x</span>e8<span class="symbol">\x</span>8e<span class="symbol">\x</span>ff<span class="symbol">\x</span>ff<span class="symbol">\x</span>ff<span class="symbol">\x</span>89<span class="symbol">\x</span>45<span class="symbol">\x</span>8<span class="symbol">\x</span>68<span class="symbol">\x</span>6c<span class="symbol">\x</span>6c<span class="symbol">\x</span>20<span class="symbol">\x</span>41<span class="symbol">\x</span>68<span class="symbol">\x</span>33<span class="symbol">\x</span>32<span class="symbol">\x</span>2e<span class="symbol">\x</span>64<span class="symbol">\x</span>68<span class="symbol">\x</span>75<span class="symbol">\x</span>73<span class="symbol">\x</span>65<span class="symbol">\x</span>72<span class="symbol">\x</span>30<span class="symbol">\x</span>db<span class="symbol">\x</span>88<span class="symbol">\x</span>5c<span class="symbol">\x</span>24<span class="symbol">\x</span>a<span class="symbol">\x</span>89<span class="symbol">\x</span>e6<span class="symbol">\x</span>56<span class="symbol">\x</span>ff<span class="symbol">\x</span>55<span class="symbol">\x</span>4<span class="symbol">\x</span>89<span class="symbol">\x</span>c2<span class="symbol">\x</span>50<span class="symbol">\x</span>bb<span class="symbol">\x</span>a8<span class="symbol">\x</span>a2<span class="symbol">\x</span>4d<span class="symbol">\x</span>bc<span class="symbol">\x</span>87<span class="symbol">\x</span>1c<span class="symbol">\x</span>24<span class="symbol">\x</span>52<span class="symbol">\x</span>e8<span class="symbol">\x</span>5f<span class="symbol">\x</span>ff<span class="symbol">\x</span>ff<span class="symbol">\x</span>ff<span class="symbol">\x</span>68<span class="symbol">\x</span>58<span class="symbol">\x</span>20<span class="symbol">\x</span>20<span class="symbol">\x</span>20<span class="symbol">\x</span>68<span class="symbol">\x</span>72<span class="symbol">\x</span>61<span class="symbol">\x</span>74<span class="symbol">\x</span>73<span class="symbol">\x</span>68<span class="symbol">\x</span>43<span class="symbol">\x</span>6f<span class="symbol">\x</span>6e<span class="symbol">\x</span>67<span class="symbol">\x</span>31<span class="symbol">\x</span>db<span class="symbol">\x</span>88<span class="symbol">\x</span>5c<span class="symbol">\x</span>24<span class="symbol">\x</span>8<span class="symbol">\x</span>89<span class="symbol">\x</span>e3<span class="symbol">\x</span>68<span class="symbol">\x</span>63<span class="symbol">\x</span>6f<span class="symbol">\x</span>6d<span class="symbol">\x</span>58<span class="symbol">\x</span>68<span class="symbol">\x</span>69<span class="symbol">\x</span>6e<span class="symbol">\x</span>67<span class="symbol">\x</span>2e<span class="symbol">\x</span>68<span class="symbol">\x</span>63<span class="symbol">\x</span>68<span class="symbol">\x</span>75<span class="symbol">\x</span>78<span class="symbol">\x</span>68<span class="symbol">\x</span>64<span class="symbol">\x</span>69<span class="symbol">\x</span>64<span class="symbol">\x</span>69<span class="symbol">\x</span>68<span class="symbol">\x</span>61<span class="symbol">\x</span>64<span class="symbol">\x</span>65<span class="symbol">\x</span>40<span class="symbol">\x</span>68<span class="symbol">\x</span>64<span class="symbol">\x</span>39<span class="symbol">\x</span>65<span class="symbol">\x</span>39<span class="symbol">\x</span>68<span class="symbol">\x</span>37<span class="symbol">\x</span>31<span class="symbol">\x</span>37<span class="symbol">\x</span>33<span class="symbol">\x</span>68<span class="symbol">\x</span>64<span class="symbol">\x</span>34<span class="symbol">\x</span>61<span class="symbol">\x</span>65<span class="symbol">\x</span>68<span class="symbol">\x</span>64<span class="symbol">\x</span>36<span class="symbol">\x</span>39<span class="symbol">\x</span>62<span class="symbol">\x</span>68<span class="symbol">\x</span>62<span class="symbol">\x</span>31<span class="symbol">\x</span>63<span class="symbol">\x</span>34<span class="symbol">\x</span>68<span class="symbol">\x</span>61<span class="symbol">\x</span>64<span class="symbol">\x</span>61<span class="symbol">\x</span>63<span class="symbol">\x</span>68<span class="symbol">\x</span>63<span class="symbol">\x</span>34<span class="symbol">\x</span>39<span class="symbol">\x</span>62<span class="symbol">\x</span>68<span class="symbol">\x</span>54<span class="symbol">\x</span>46<span class="symbol">\x</span>2d<span class="symbol">\x</span>63<span class="symbol">\x</span>68<span class="symbol">\x</span>20<span class="symbol">\x</span>44<span class="symbol">\x</span>44<span class="symbol">\x</span>43<span class="symbol">\x</span>68<span class="symbol">\x</span>4b<span class="symbol">\x</span>65<span class="symbol">\x</span>79<span class="symbol">\x</span>3a<span class="symbol">\x</span>31<span class="symbol">\x</span>c9<span class="symbol">\x</span>88<span class="symbol">\x</span>4c<span class="symbol">\x</span>24<span class="symbol">\x</span>3b<span class="symbol">\x</span>89<span class="symbol">\x</span>e1<span class="symbol">\x</span>31<span class="symbol">\x</span>d2<span class="symbol">\x</span>52<span class="symbol">\x</span>53<span class="symbol">\x</span>51<span class="symbol">\x</span>52<span class="symbol">\x</span>ff<span class="symbol">\x</span>d0<span class="symbol">\x</span>31<span class="symbol">\x</span>c0<span class="symbol">\x</span>50<span class="symbol">\x</span>ff<span class="symbol">\x</span>55<span class="symbol">\x</span>8</span><br></pre></td></tr></table></figure></p>
<p>然后使用工具转成汇编代码：<br><img src="https://s2.ax1x.com/2019/03/22/A8hKNn.png" alt><br>我靠，这工具有点东西啊，对不对</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> 003FFFA4</span><br><span class="line"><span class="keyword">mov</span> [<span class="built_in">ebp</span>+<span class="number">65</span>],<span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">ebx</span>,73E2D87E</span><br><span class="line"><span class="keyword">xchg</span> [<span class="built_in">esp</span>],<span class="built_in">ebx</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">call</span> 003FFF93</span><br><span class="line"><span class="keyword">mov</span> [<span class="built_in">ebp</span>-5B],<span class="built_in">eax</span></span><br><span class="line"><span class="keyword">push</span> 41206C6C</span><br><span class="line"><span class="keyword">push</span> 642E3233</span><br><span class="line"><span class="keyword">push</span> <span class="number">72657375</span></span><br><span class="line"><span class="keyword">xor</span> <span class="built_in">bl</span>,<span class="built_in">bl</span></span><br><span class="line"><span class="keyword">mov</span> [<span class="built_in">esp</span>-3B],<span class="built_in">bl</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">esi</span>,<span class="built_in">esp</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">esi</span></span><br><span class="line"><span class="keyword">call</span> [<span class="built_in">ebp</span>+<span class="number">65</span>]</span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">edx</span>,<span class="built_in">eax</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">ebx</span>,BC4DA2A8</span><br><span class="line"><span class="keyword">xchg</span> [<span class="built_in">esp</span>],<span class="built_in">ebx</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">call</span> 003FFF64</span><br><span class="line"><span class="keyword">push</span> <span class="number">20202058</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">73746172</span></span><br><span class="line"><span class="keyword">push</span> 676E6F43</span><br><span class="line"><span class="keyword">xor</span> <span class="built_in">ebx</span>,<span class="built_in">ebx</span></span><br><span class="line"><span class="keyword">mov</span> [<span class="built_in">esp</span>-5B],<span class="built_in">bl</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">ebx</span>,<span class="built_in">esp</span></span><br><span class="line"><span class="keyword">push</span> 586D6F63</span><br><span class="line"><span class="keyword">push</span> 2E676E69</span><br><span class="line"><span class="keyword">push</span> <span class="number">78756863</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">69646964</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">40656461</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">39653964</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">33373137</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">65613464</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">62393664</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">34633162</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">63616461</span></span><br><span class="line"><span class="keyword">push</span> <span class="number">62393463</span></span><br><span class="line"><span class="keyword">push</span> 632D4654</span><br><span class="line"><span class="keyword">push</span> <span class="number">43444420</span></span><br><span class="line"><span class="keyword">push</span> 3A79654B</span><br><span class="line"><span class="keyword">xor</span> <span class="built_in">ecx</span>,<span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span> [<span class="built_in">esp</span>+3B],<span class="built_in">cl</span></span><br><span class="line"><span class="keyword">mov</span> <span class="built_in">ecx</span>,<span class="built_in">esp</span></span><br><span class="line"><span class="keyword">xor</span> <span class="built_in">edx</span>,<span class="built_in">edx</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">ebx</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">call</span> <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">xor</span> <span class="built_in">eax</span>,<span class="built_in">eax</span></span><br><span class="line"><span class="keyword">push</span> <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">call</span> [<span class="built_in">ebp</span>+<span class="number">49</span>]</span><br></pre></td></tr></table></figure>
<p>发现有一段push，压入栈中一些数据，那么我们把数据提取出来：<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> = [<span class="string">"586D6F63"</span>,<span class="string">"2E676E69"</span>,<span class="string">"78756863"</span>,<span class="string">"69646964"</span>,<span class="string">"40656461"</span>,<span class="string">"39653964"</span>,<span class="string">"33373137"</span>,<span class="string">"65613464"</span>,<span class="string">"62393664"</span>,<span class="string">"34633162"</span>,<span class="string">"63616461"</span>,<span class="string">"62393463"</span>,<span class="string">"632D4654"</span>,<span class="string">"43444420"</span>,<span class="string">"3A79654B"</span>]</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(<span class="keyword">data</span>)):</span><br><span class="line">	<span class="keyword">for</span> y <span class="keyword">in</span> range(len(<span class="keyword">data</span>[x])-<span class="number">2</span>,-<span class="number">2</span>,-<span class="number">2</span>):</span><br><span class="line">		flag += chr(eval(<span class="string">"0x"</span>+<span class="keyword">data</span>[len(<span class="keyword">data</span>)-<span class="number">1</span>-x][y:y+<span class="number">2</span>]))</span><br><span class="line">print flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">out</span>：</span><br><span class="line">Key: DDCTF-<span class="symbol">cc49badacb1c4d69bd4ae7173d9e9ade@</span>didichuxing.comX</span><br></pre></td></tr></table></figure></p>
<p>flag是去掉最后的X。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>通过这么长时间的做题发现，只要耐心的找到关键代码，再把关键代码看的通透，那么flag的离得不远了。</p>

        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        转发请备注<a href="“https://luobuming.github.io”">一筐萝卜</a>的个人博客 <br>
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
       </p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
