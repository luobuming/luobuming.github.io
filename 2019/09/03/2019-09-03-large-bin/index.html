<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        large-bin-attack - 萝卜
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
     你若盛开，清风自来！ 
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            萝卜
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献"><span class="toc-text">参考文献</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#unsortedbin中的chunk到largebin中的流程"><span class="toc-text">unsortedbin中的chunk到largebin中的流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#在largebin中的chunk是如何分配出去的"><span class="toc-text">在largebin中的chunk是如何分配出去的</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#利用方式"><span class="toc-text">利用方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#申请largebin的过程"><span class="toc-text">申请largebin的过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unsorted-bin中进入到largebin中的时候"><span class="toc-text">unsorted bin中进入到largebin中的时候</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#伪造fwd的bk-nextsize指针，"><span class="toc-text">伪造fwd的bk_nextsize指针，</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#伪造fwd的bk指针"><span class="toc-text">伪造fwd的bk指针</span></a></li></ol></li></ol></li>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 你若盛开，清风自来！ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        large-bin-attack
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2019-09-03 13:36:00</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#Pwn" title="Pwn">Pwn</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a href="https://www.anquanke.com/post/id/183877#h2-1" target="_blank" rel="noopener">raycp</a></p>
<p>相对于<code>small bins</code>来说，大于<code>small bins</code>最大chunk_size的chunk会进入到<code>large bins</code>中；而<code>large bins</code>与<code>small bins</code>、<code>fast bins</code>相比，管理方法是有很大区别的</p>
<p><code>large bins</code>分为63个<code>bin</code>，每个<code>bin</code>中的<code>chunk_size</code>并不是同样大的，而是每个bin中都是一个固定公差的等差数列，但是每个bin和每个bin的这个固定公差又是不一样的，这63个bin分成6组，数量分别是32、16、8、4、2、1，公差依此是64B、512B、4096B、32768B、262144B。</p>
<p>glibc源码定义largebins如下所示(虽然我也没看懂)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> largebin_index_32(sz)                                                \</span></span><br><span class="line">  (((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">6</span>) &lt;= <span class="number">38</span>) ?  <span class="number">56</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">6</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">9</span>) &lt;= <span class="number">20</span>) ?  <span class="number">91</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">9</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">12</span>) &lt;= <span class="number">10</span>) ? <span class="number">110</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">12</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">15</span>) &lt;= <span class="number">4</span>) ? <span class="number">119</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">15</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">18</span>) &lt;= <span class="number">2</span>) ? <span class="number">124</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">18</span>) :\</span><br><span class="line">   <span class="number">126</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> largebin_index_32_big(sz)                                            \</span></span><br><span class="line">  (((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">6</span>) &lt;= <span class="number">45</span>) ?  <span class="number">49</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">6</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">9</span>) &lt;= <span class="number">20</span>) ?  <span class="number">91</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">9</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">12</span>) &lt;= <span class="number">10</span>) ? <span class="number">110</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">12</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">15</span>) &lt;= <span class="number">4</span>) ? <span class="number">119</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">15</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">18</span>) &lt;= <span class="number">2</span>) ? <span class="number">124</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">18</span>) :\</span><br><span class="line">   <span class="number">126</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// XXX It remains to be seen whether it is good to keep the widths of</span></span><br><span class="line"><span class="comment">// XXX the buckets the same or whether it should be scaled by a factor</span></span><br><span class="line"><span class="comment">// XXX of two as well.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> largebin_index_64(sz)                                                \</span></span><br><span class="line">  (((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">6</span>) &lt;= <span class="number">48</span>) ?  <span class="number">48</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">6</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">9</span>) &lt;= <span class="number">20</span>) ?  <span class="number">91</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">9</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">12</span>) &lt;= <span class="number">10</span>) ? <span class="number">110</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">12</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">15</span>) &lt;= <span class="number">4</span>) ? <span class="number">119</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">15</span>) :\</span><br><span class="line">   ((((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">18</span>) &lt;= <span class="number">2</span>) ? <span class="number">124</span> + (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (sz)) &gt;&gt; <span class="number">18</span>) :\</span><br><span class="line">   <span class="number">126</span>)</span><br></pre></td></tr></table></figure>
<p>根据自己的理解得出下面结论：<br>| size | index |<br>| — | — |<br>| [0x400 , 0x440) | 64 |<br>| [0x440 , 0x480) | 65 |<br>| [0x480 , 0x4C0) | 66 |<br>| [0x4C0 , 0x500) | 67 |<br>| [0x500 , 0x540) | 68 |<br>| 等差 0x40 | … |<br>| [0xC00 , 0xC40) | 96 |<br>| [0xC40 , 0xE00) | 97 |<br>| [0xE00 , 0x1000) | 98 |<br>| [0x1000 , 0x1200) | 99 |<br>| [0x1200 , 0x1400) | 100 |<br>| [0x1400 , 0x1600) | 101 |<br>| 等差 0x200 | … |<br>| [0x2800 , 0x2A00) | 111 |<br>| [0x2A00 , 0x3000) | 112 |<br>| [0x3000 , 0x4000) | 113 |<br>| [0x4000 , 0x5000) | 114 |<br>| 等差 0x1000 | … |<br>| [0x9000 , 0xA000) | 119 |<br>| [0xA000 , 0x10000) | 120 |<br>| [0x10000 , 0x18000) | 121 |<br>| [0x18000 , 0x20000) | 122 |<br>| [0x20000 , 0x28000) | 123 |<br>| [0x28000 , 0x40000) | 124 |<br>| [0x40000 , 0x80000) | 125 |<br>| [0x80000 , …. ) | 126 |</p>
<p>在largebin中，每个bin中是有两个链表来维护，具体来调试一下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *gap;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *ptr0 = <span class="built_in">malloc</span>(<span class="number">0x400</span> - <span class="number">0x10</span>); <span class="comment">//A</span></span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr1 = <span class="built_in">malloc</span>(<span class="number">0x410</span> - <span class="number">0x10</span>); <span class="comment">//B</span></span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr2 = <span class="built_in">malloc</span>(<span class="number">0x420</span> - <span class="number">0x10</span>); <span class="comment">//C</span></span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr3 = <span class="built_in">malloc</span>(<span class="number">0x430</span> - <span class="number">0x10</span>); <span class="comment">//D</span></span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(ptr2);</span><br><span class="line">    <span class="built_in">free</span>(ptr3);</span><br><span class="line">    <span class="built_in">free</span>(ptr0);</span><br><span class="line">    <span class="built_in">free</span>(ptr1);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x440</span>); <span class="comment">//trigger that sort largebin from unsorted bin to largebins</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先我们申请chunk（大小全部落在<code>largebin</code>的第一个bin中，也就是[0x400 , 0x440) ），然后让其全部进入到unsorted bin中，然后再malloc一个不同大小的chunk，触发使刚刚的chunk进入到largebin中，根据再gdb中的调试信息画出结构图<br><img src="https://s2.ax1x.com/2019/09/03/nkVHhR.md.png" alt></p>
<p>从图中可以看出来fd_nextsize和bk_nextsize也起到了一定的作用，首先是fd和bk指针构成了一个双向链表，这个链表的作用就是将一个bin中所有的chunk都链在一起</p>
<p>而fd_nextsize和bk_nextsize构成的双向链表是为了把在同一个bin中大小不同的chunk给链接到一块，再来看一个例子</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *gap;</span><br><span class="line">    <span class="keyword">char</span> *ptr0 = <span class="built_in">malloc</span>(<span class="number">0x400</span> - <span class="number">0x10</span>); <span class="comment">//A</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"A:%p\n"</span>,ptr0);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr1 = <span class="built_in">malloc</span>(<span class="number">0x410</span> - <span class="number">0x10</span>); <span class="comment">//B</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"B:%p\n"</span>, ptr1);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr2 = <span class="built_in">malloc</span>(<span class="number">0x420</span> - <span class="number">0x10</span>); <span class="comment">//C</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"C:%p\n"</span>, ptr2);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr3 = <span class="built_in">malloc</span>(<span class="number">0x430</span> - <span class="number">0x10</span>); <span class="comment">//D</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"D:%p\n"</span>, ptr3);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr4 = <span class="built_in">malloc</span>(<span class="number">0x400</span> - <span class="number">0x10</span>); <span class="comment">//E</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"E:%p\n"</span>, ptr4);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr5 = <span class="built_in">malloc</span>(<span class="number">0x410</span> - <span class="number">0x10</span>); <span class="comment">//F</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"F:%p\n"</span>, ptr5);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr6 = <span class="built_in">malloc</span>(<span class="number">0x420</span> - <span class="number">0x10</span>); <span class="comment">//G</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"G:%p\n"</span>, ptr6);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr7 = <span class="built_in">malloc</span>(<span class="number">0x430</span> - <span class="number">0x10</span>); <span class="comment">//H</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"H:%p\n"</span>, ptr7);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *ptr8 = <span class="built_in">malloc</span>(<span class="number">0x400</span> - <span class="number">0x10</span>); <span class="comment">//I</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"I:%p\n"</span>, ptr8);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr9 = <span class="built_in">malloc</span>(<span class="number">0x410</span> - <span class="number">0x10</span>); <span class="comment">//J</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"J:%p\n"</span>, ptr9);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr10 = <span class="built_in">malloc</span>(<span class="number">0x420</span> - <span class="number">0x10</span>); <span class="comment">//K</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"K:%p\n"</span>, ptr10);</span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">char</span> *ptr11 = <span class="built_in">malloc</span>(<span class="number">0x430</span> - <span class="number">0x10</span>); <span class="comment">//L</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"K:%p\n"</span>, ptr11);</span><br><span class="line"></span><br><span class="line">    gap = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(ptr2); <span class="comment">//C</span></span><br><span class="line">    <span class="built_in">free</span>(ptr3); <span class="comment">//D</span></span><br><span class="line">    <span class="built_in">free</span>(ptr0); <span class="comment">//A</span></span><br><span class="line">    <span class="built_in">free</span>(ptr1); <span class="comment">//B</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(ptr7); <span class="comment">//H</span></span><br><span class="line">    <span class="built_in">free</span>(ptr6); <span class="comment">//G</span></span><br><span class="line">    <span class="built_in">free</span>(ptr5); <span class="comment">//F</span></span><br><span class="line">    <span class="built_in">free</span>(ptr4); <span class="comment">//E</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">free</span>(ptr11); <span class="comment">//L</span></span><br><span class="line">    <span class="built_in">free</span>(ptr10); <span class="comment">//K</span></span><br><span class="line">    <span class="built_in">free</span>(ptr9);  <span class="comment">//J</span></span><br><span class="line">    <span class="built_in">free</span>(ptr8); <span class="comment">//I</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x440</span>); <span class="comment">//trigger that sort largebin from unsorted bin to largebins</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据调式信息画出示意图，这幅图是通过fd和bk指针构成了一个双向链表<br><img src="https://s2.ax1x.com/2019/09/03/nkd7pq.md.png" alt></p>
<p>这幅图是通过fd_nextsize和bk_nextsize指针构成了一个双向链表<br><img src="https://s2.ax1x.com/2019/09/03/nkw7UH.md.png" alt></p>
<p>这两幅图表示的是同一个bin中的chunk，可以鲜明的看出来fd_nextsize和bk_nextsize指针的作用，fd_nextsize指针指向相邻下一个比它小的chunk地址，而bk_nextsize指针指向相邻上一个比它大的chunk地址</p>
<p>通过看glibc源码来看在<code>unsorted bin</code>中的chunk是如何分配到了smallbin和largebin中</p>
<p><code>/glibc-2.23/malloc/malloc.c:3532</code><br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* place chunk in bin */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (in_smallbin_range (size))<span class="comment">//这里首先验证时进入smallbins还是largebins</span></span><br><span class="line">  &#123;<span class="comment">//进入smallbins</span></span><br><span class="line">    victim_index = smallbin_index (size);</span><br><span class="line">    bck = bin_at (av, victim_index);</span><br><span class="line">    fwd = bck-&gt;fd;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  &#123;<span class="comment">//进入largebins</span></span><br><span class="line">    victim_index = largebin_index (size);<span class="comment">//获取要插入的bins对应的index</span></span><br><span class="line">    bck = bin_at (av, victim_index);<span class="comment">//获取该bin中最小的chunk</span></span><br><span class="line">    fwd = bck-&gt;fd;<span class="comment">//获取该bin中最小的chunk</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* maintain large bins in sorted order 按顺序维护大箱子*/</span></span><br><span class="line">    <span class="keyword">if</span> (fwd != bck)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">/* Or with inuse bit to speed comparisons */</span></span><br><span class="line">        size |= PREV_INUSE;</span><br><span class="line">        <span class="comment">/* if smaller than smallest, bypass loop below */</span></span><br><span class="line">        assert ((bck-&gt;bk-&gt;size &amp; NON_MAIN_ARENA) == <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (size) &lt; (<span class="keyword">unsigned</span> <span class="keyword">long</span>) (bck-&gt;bk-&gt;size))<span class="comment">//如果要插入的chunk的size小于当前bin中最小chunk的大小，则直接插入到最后面</span></span><br><span class="line">          &#123;</span><br><span class="line">            fwd = bck;</span><br><span class="line">            bck = bck-&gt;bk;</span><br><span class="line"></span><br><span class="line">            victim-&gt;fd_nextsize = fwd-&gt;fd;</span><br><span class="line">            victim-&gt;bk_nextsize = fwd-&gt;fd-&gt;bk_nextsize;</span><br><span class="line">            fwd-&gt;fd-&gt;bk_nextsize = victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span><br><span class="line">          &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          &#123;<span class="comment">//如果插入的chunk不为最小，则通过fd_nextsize从大到小遍历chunk，找到小于等于要插入chunk的位置</span></span><br><span class="line">            assert ((fwd-&gt;size &amp; NON_MAIN_ARENA) == <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">while</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) size &lt; fwd-&gt;size)</span><br><span class="line">              &#123;</span><br><span class="line">                fwd = fwd-&gt;fd_nextsize;</span><br><span class="line">                assert ((fwd-&gt;size &amp; NON_MAIN_ARENA) == <span class="number">0</span>);</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) size == (<span class="keyword">unsigned</span> <span class="keyword">long</span>) fwd-&gt;size)<span class="comment">//如果存在堆头，则插入到堆头的下一个节点</span></span><br><span class="line">              <span class="comment">/* Always insert in the second position.  */</span></span><br><span class="line">              fwd = fwd-&gt;fd;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">              &#123;否则这个chunk将会成为堆头，bk_nextsize和fd_nextsize将被置位</span><br><span class="line">                victim-&gt;fd_nextsize = fwd;</span><br><span class="line">                victim-&gt;bk_nextsize = fwd-&gt;bk_nextsize;</span><br><span class="line">                fwd-&gt;bk_nextsize = victim;</span><br><span class="line">                victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span><br><span class="line">              &#125;</span><br><span class="line">            bck = fwd-&gt;bk;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">else</span><span class="comment">//如果bin是空的话，直接设置fd_nextsize 和bk_nextsize 是自己本身</span></span><br><span class="line">      victim-&gt;fd_nextsize = victim-&gt;bk_nextsize = victim;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="unsortedbin中的chunk到largebin中的流程"><a href="#unsortedbin中的chunk到largebin中的流程" class="headerlink" title="unsortedbin中的chunk到largebin中的流程"></a>unsortedbin中的chunk到largebin中的流程</h4><ul>
<li>首先是先判断进入<code>smallbin</code>还是<code>largebin</code></li>
<li>若是进入<code>largebin</code>中，首先是获取到该chunk应进入到哪一个index的bin中，简单的来说就是获取index</li>
<li>获取该indexbin的最大chunk和最小chunk</li>
<li>判断最大chunk和最小chunk是否不相等，也就是判断这个bin是否为空</li>
<li>如果为空的话就直接将这个chunk这设置成堆头</li>
<li>如果不为空，就判断该chunk的size是不是最小的，若是最小的话直接插入到最后，若不是，则会按照fd_nextsize遍历，直到找到合适的位置</li>
<li>然后判断是不是堆头（是不是该大小的第一个chunk），如果是的话就设置好fd_nextsize 和bk_nextsize ，若不是的话都置为0</li>
</ul>
<h4 id="在largebin中的chunk是如何分配出去的"><a href="#在largebin中的chunk是如何分配出去的" class="headerlink" title="在largebin中的chunk是如何分配出去的"></a>在largebin中的chunk是如何分配出去的</h4><ul>
<li>先是更具申请的大小找到合适的largebin，然后比较是否大于第一个节点</li>
<li>若大于第一个节点，从最小的chunk开始反向遍历，直到找到第一个大于等于所需要的大小的chunk就退出循环</li>
<li>如果申请大小的chunk是存在多个节点，那么则申请堆头的下一个节点，不申请堆头，以此来减少对bk_nextsize和fd_nextsize的操作</li>
<li>然后进行unlink操作</li>
</ul>
<p><code>/glibc-2.23/malloc/malloc.c:3604</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/*</span></span><br><span class="line"><span class="comment">      If a large request, scan through the chunks of current bin in</span></span><br><span class="line"><span class="comment">      sorted order to find smallest that fits.  Use the skip list for this.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (!in_smallbin_range (nb))</span><br><span class="line">     &#123;</span><br><span class="line">       bin = bin_at (av, idx);</span><br><span class="line"></span><br><span class="line">       <span class="comment">/* skip scan if empty or largest chunk is too small */</span></span><br><span class="line">       <span class="keyword">if</span> ((victim = first (bin)) != bin &amp;&amp;</span><br><span class="line">           (<span class="keyword">unsigned</span> <span class="keyword">long</span>) (victim-&gt;size) &gt;= (<span class="keyword">unsigned</span> <span class="keyword">long</span>) (nb))</span><br><span class="line">         &#123;</span><br><span class="line">           victim = victim-&gt;bk_nextsize;</span><br><span class="line">           <span class="keyword">while</span> (((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (size = chunksize (victim)) &lt;</span><br><span class="line">                   (<span class="keyword">unsigned</span> <span class="keyword">long</span>) (nb)))</span><br><span class="line">             victim = victim-&gt;bk_nextsize;</span><br><span class="line"></span><br><span class="line">           <span class="comment">/* Avoid removing the first entry for a size so that the skip</span></span><br><span class="line"><span class="comment">              list does not have to be rerouted.  */</span></span><br><span class="line">           <span class="keyword">if</span> (victim != last (bin) &amp;&amp; victim-&gt;size == victim-&gt;fd-&gt;size)</span><br><span class="line">             victim = victim-&gt;fd;</span><br><span class="line"></span><br><span class="line">           remainder_size = size - nb;</span><br><span class="line">           unlink (av, victim, bck, fwd);</span><br><span class="line"></span><br><span class="line">           <span class="comment">/* Exhaust */</span></span><br><span class="line">           <span class="keyword">if</span> (remainder_size &lt; MINSIZE)</span><br><span class="line">             &#123;</span><br><span class="line">               set_inuse_bit_at_offset (victim, size);</span><br><span class="line">               <span class="keyword">if</span> (av != &amp;main_arena)</span><br><span class="line">                 victim-&gt;size |= NON_MAIN_ARENA;</span><br><span class="line">             &#125;</span><br><span class="line">           <span class="comment">/* Split */</span></span><br><span class="line">           <span class="keyword">else</span></span><br><span class="line">             &#123;</span><br><span class="line">               remainder = chunk_at_offset (victim, nb);</span><br><span class="line">               <span class="comment">/* We cannot assume the unsorted list is empty and therefore</span></span><br><span class="line"><span class="comment">                  have to perform a complete insert here.  */</span></span><br><span class="line">               bck = unsorted_chunks (av);</span><br><span class="line">               fwd = bck-&gt;fd;</span><br><span class="line"><span class="keyword">if</span> (__glibc_unlikely (fwd-&gt;bk != bck))</span><br><span class="line">                 &#123;</span><br><span class="line">                   errstr = <span class="string">"malloc(): corrupted unsorted chunks"</span>;</span><br><span class="line">                   <span class="keyword">goto</span> errout;</span><br><span class="line">                 &#125;</span><br><span class="line">               remainder-&gt;bk = bck;</span><br><span class="line">               remainder-&gt;fd = fwd;</span><br><span class="line">               bck-&gt;fd = remainder;</span><br><span class="line">               fwd-&gt;bk = remainder;</span><br><span class="line">               <span class="keyword">if</span> (!in_smallbin_range (remainder_size))</span><br><span class="line">                 &#123;</span><br><span class="line">                   remainder-&gt;fd_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">                   remainder-&gt;bk_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">               set_head (victim, nb | PREV_INUSE |</span><br><span class="line">                         (av != &amp;main_arena ? NON_MAIN_ARENA : <span class="number">0</span>));</span><br><span class="line">               set_head (remainder, remainder_size | PREV_INUSE);</span><br><span class="line">               set_foot (remainder, remainder_size);</span><br><span class="line">             &#125;</span><br><span class="line">           check_malloced_chunk (av, victim, nb);</span><br><span class="line">           <span class="keyword">void</span> *p = chunk2mem (victim);</span><br><span class="line">           alloc_perturb (p, bytes);</span><br><span class="line">           <span class="keyword">return</span> p;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
<p>largebin的unlink操作可以分为两类，第一类是unlink不是堆头的chunk，那就和unsortedbin是一样的，fd_nextsize和bk_nextsize指针并不参与unlink的操作；第二类是unlink是堆头的chunk，现在fd_nextsize和bk_nextsize就要出场了，那不仅要操作fd和bk指针，而且要操作fd_nextsize和bk_nextsize指针</p>
<p><code>/glibc-2.23/malloc/malloc.c:1414</code><br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> unlink(AV, P, BK, FD) &#123;                                            \</span></span><br><span class="line">    FD = P-&gt;fd;								      \</span><br><span class="line">    BK = P-&gt;bk;								      \</span><br><span class="line">    <span class="keyword">if</span> (__builtin_expect (FD-&gt;bk != P || BK-&gt;fd != P, <span class="number">0</span>))		      \</span><br><span class="line">      malloc_printerr (check_action, <span class="string">"corrupted double-linked list"</span>, P, AV);  \</span><br><span class="line">    <span class="keyword">else</span> &#123;								      \</span><br><span class="line">        FD-&gt;bk = BK;							      \</span><br><span class="line">        BK-&gt;fd = FD;							      \</span><br><span class="line">        <span class="keyword">if</span> (!in_smallbin_range (P-&gt;size)				      \</span><br><span class="line">            &amp;&amp; __builtin_expect (P-&gt;fd_nextsize != <span class="literal">NULL</span>, <span class="number">0</span>)) &#123;		      \</span><br><span class="line">	    <span class="keyword">if</span> (__builtin_expect (P-&gt;fd_nextsize-&gt;bk_nextsize != P, <span class="number">0</span>)	      \</span><br><span class="line">		|| __builtin_expect (P-&gt;bk_nextsize-&gt;fd_nextsize != P, <span class="number">0</span>))    \</span><br><span class="line">	      malloc_printerr (check_action,				      \</span><br><span class="line">			       <span class="string">"corrupted double-linked list (not small)"</span>,    \</span><br><span class="line">			       P, AV);					      \</span><br><span class="line">            <span class="keyword">if</span> (FD-&gt;fd_nextsize == <span class="literal">NULL</span>) &#123;				      \</span><br><span class="line">                <span class="keyword">if</span> (P-&gt;fd_nextsize == P)				      \</span><br><span class="line">                  FD-&gt;fd_nextsize = FD-&gt;bk_nextsize = FD;		      \</span><br><span class="line">                <span class="keyword">else</span> &#123;							      \</span><br><span class="line">                    FD-&gt;fd_nextsize = P-&gt;fd_nextsize;			      \</span><br><span class="line">                    FD-&gt;bk_nextsize = P-&gt;bk_nextsize;			      \</span><br><span class="line">                    P-&gt;fd_nextsize-&gt;bk_nextsize = FD;			      \</span><br><span class="line">                    P-&gt;bk_nextsize-&gt;fd_nextsize = FD;			      \</span><br><span class="line">                  &#125;							      \</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;							      \</span><br><span class="line">                P-&gt;fd_nextsize-&gt;bk_nextsize = P-&gt;bk_nextsize;		      \</span><br><span class="line">                P-&gt;bk_nextsize-&gt;fd_nextsize = P-&gt;fd_nextsize;		      \</span><br><span class="line">              &#125;								      \</span><br><span class="line">          &#125;								      \</span><br><span class="line">      &#125;									      \</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以看出来，相比<code>unsorted bin</code>的unlink操作只是多了对bk_nextsize 和fd_nextsize指针的操作。</p>
<blockquote>
<p>这里应该注意的是，当插入largebin时是通过fd_nextsize指针从大到小遍历的，而取出的时候是通过bk_nextsize指针从小到大进行遍历</p>
</blockquote>
<h2 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h2><h3 id="申请largebin的过程"><a href="#申请largebin的过程" class="headerlink" title="申请largebin的过程"></a>申请largebin的过程</h3><p>当我们可以控制已经到达largebin中的chunk时，我们对chunk的bk_nextsize指针进行伪造，就可以制定地址申请成为chunk</p>
<h3 id="unsorted-bin中进入到largebin中的时候"><a href="#unsorted-bin中进入到largebin中的时候" class="headerlink" title="unsorted bin中进入到largebin中的时候"></a>unsorted bin中进入到largebin中的时候</h3><h4 id="伪造fwd的bk-nextsize指针，"><a href="#伪造fwd的bk-nextsize指针，" class="headerlink" title="伪造fwd的bk_nextsize指针，"></a>伪造fwd的bk_nextsize指针，</h4><p>可以达到效果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">victim-&gt;bk_nextsize=target</span><br><span class="line">target-&gt;fd_nextsize(target+0x20)=victim</span><br></pre></td></tr></table></figure></p>
<h4 id="伪造fwd的bk指针"><a href="#伪造fwd的bk指针" class="headerlink" title="伪造fwd的bk指针"></a>伪造fwd的bk指针</h4><p>达到效果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bck = target</span><br><span class="line">target-&gt;fd(target+0x10)=victim</span><br></pre></td></tr></table></figure></p>

        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        转发请备注<a href="“https://luobuming.github.io”">一筐萝卜</a>的个人博客 <br>
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
       </p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
