<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        攻防世界逆向部分Writeup - 萝卜
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 你若盛开，清风自来！ </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            <i>萝卜</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#babyre"><span class="toc-text">babyre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-re"><span class="toc-text">easy_re</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pipe-函数"><span class="toc-text">pipe()函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#key"><span class="toc-text">key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reverse-box"><span class="toc-text">reverse-box</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zorropub"><span class="toc-text">zorropub</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRACKME"><span class="toc-text">CRACKME</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReverseMe-120"><span class="toc-text">ReverseMe-120</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyre-153"><span class="toc-text">easyre-153</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#notsequence"><span class="toc-text">notsequence</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 你若盛开，清风自来！ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        攻防世界逆向部分Writeup
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2019-06-05 21:49:42</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#WP" title="WP">WP</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <p>日常练习！<br><a id="more"></a></p>
<h3 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h3><p>file一下发现是64elf文件，拖到IDA中查看：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+0h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">181</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    envp = (<span class="keyword">const</span> <span class="keyword">char</span> **)(*((<span class="keyword">unsigned</span> __int8 *)judge + i) ^ <span class="number">0xC</span>u);</span><br><span class="line">    *((_BYTE *)judge + i) ^= <span class="number">0xC</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please input flag:"</span>, argv, envp);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%20s"</span>, &amp;s);</span><br><span class="line">  v5 = <span class="built_in">strlen</span>(&amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">14</span> &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)judge(&amp;s) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Right!"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Wrong!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>流程很简单，输入一个flag，然后长度限制为14，judge返回1，则是正确的flag。看到之前有一个for循环，作用是SMC，把代码还原出来，这里我用IDC脚本将代码直接在IDA中还原</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">auto start,<span class="built_in">i</span>,a;</span><br><span class="line">start = <span class="number">0x600b00</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">i</span>=<span class="number">0</span>;<span class="built_in">i</span>&lt;=<span class="number">181</span>;<span class="built_in">i</span>++)</span><br><span class="line">&#123;</span><br><span class="line">    a=Byte(start+<span class="built_in">i</span>)^<span class="number">0xc</span>;</span><br><span class="line">    PatchByte(start+<span class="built_in">i</span>,a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后查看judge函数：</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">55</span>                                      <span class="built_in">push</span>    rbp</span><br><span class="line">.data:<span class="number">0000000000600B01</span> <span class="number">48</span> <span class="number">89</span> E5                                mov     rbp, rsp</span><br><span class="line">.data:<span class="number">0000000000600B04</span> <span class="number">48</span> <span class="number">89</span> 7D D8                             mov     [rbp-28h], rdi</span><br><span class="line">.data:<span class="number">0000000000600B08</span> C6 <span class="number">45</span> E0 <span class="number">66</span>                             mov     byte ptr [rbp-20h], 66h</span><br><span class="line">.data:<span class="number">0000000000600B08</span>                         judge           endp ; sp-analysis failed</span><br><span class="line">.data:<span class="number">0000000000600B08</span></span><br><span class="line">.data:<span class="number">0000000000600B0C</span></span><br><span class="line">.data:<span class="number">0000000000600B0C</span>                         loc_600B0C:</span><br><span class="line">.data:<span class="number">0000000000600B0C</span> C6 <span class="number">45</span> E1 6D                             mov     byte ptr [rbp-1Fh], 6Dh</span><br><span class="line">.data:<span class="number">0000000000600B10</span> C6 <span class="number">45</span> E2 <span class="number">63</span>                             mov     byte ptr [rbp-1Eh], 63h</span><br><span class="line">.data:<span class="number">0000000000600B14</span> C6 <span class="number">45</span> E3 <span class="number">64</span>                             mov     byte ptr [rbp-1Dh], 64h</span><br><span class="line">.data:<span class="number">0000000000600B18</span> C6 <span class="number">45</span> E4 7F                             mov     byte ptr [rbp-1Ch], 7Fh</span><br><span class="line">.data:<span class="number">0000000000600B1C</span> C6 <span class="number">45</span> E5 6B                             mov     byte ptr [rbp-1Bh], 6Bh</span><br><span class="line">.data:<span class="number">0000000000600B20</span> C6 <span class="number">45</span> E6 <span class="number">37</span>                             mov     byte ptr [rbp-1Ah], 37h</span><br><span class="line">.data:<span class="number">0000000000600B24</span> C6 <span class="number">45</span> E7 <span class="number">64</span>                             mov     byte ptr [rbp-19h], 64h</span><br><span class="line">.data:<span class="number">0000000000600B28</span> C6 <span class="number">45</span> E8 3B                             mov     byte ptr [rbp-18h], 3Bh</span><br><span class="line">.data:<span class="number">0000000000600B2C</span> C6 <span class="number">45</span> E9 <span class="number">56</span>                             mov     byte ptr [rbp-17h], 56h</span><br><span class="line">.data:<span class="number">0000000000600B30</span> C6 <span class="number">45</span> EA <span class="number">60</span>                             mov     byte ptr [rbp-16h], 60h</span><br><span class="line">.data:<span class="number">0000000000600B34</span> C6 <span class="number">45</span> EB 3B                             mov     byte ptr [rbp-15h], 3Bh</span><br><span class="line">.data:<span class="number">0000000000600B38</span> C6 <span class="number">45</span> EC 6E                             mov     byte ptr [rbp-14h], 6Eh</span><br><span class="line">.data:<span class="number">0000000000600B3C</span> C6 <span class="number">45</span> ED <span class="number">70</span>                             mov     byte ptr [rbp-13h], 70h</span><br><span class="line">.data:<span class="number">0000000000600B40</span> C7 <span class="number">45</span> FC <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                    mov     dword ptr [rbp-<span class="number">4</span>], <span class="number">0</span></span><br><span class="line">.data:<span class="number">0000000000600B47</span> EB <span class="number">28</span>                                   jmp     short loc_600B71</span><br><span class="line">.data:<span class="number">0000000000600B49</span>                         ; ---------------------------------------------------------------------------</span><br><span class="line">.data:<span class="number">0000000000600B49</span></span><br><span class="line">.data:<span class="number">0000000000600B49</span>                         loc_600B49:                             ; CODE XREF: .data:<span class="number">0000000000600B75</span>↓j</span><br><span class="line">.data:<span class="number">0000000000600B49</span> 8B <span class="number">45</span> FC                                mov     eax, [rbp-<span class="number">4</span>]</span><br><span class="line">.data:<span class="number">0000000000600B4C</span> <span class="number">48</span> <span class="number">63</span> D0                                movsxd  rdx, eax</span><br><span class="line">.data:<span class="number">0000000000600B4F</span> <span class="number">48</span> 8B <span class="number">45</span> D8                             mov     rax, [rbp-28h]</span><br><span class="line">.data:<span class="number">0000000000600B53</span> <span class="number">48</span> <span class="number">01</span> D0                                add     rax, rdx</span><br><span class="line">.data:<span class="number">0000000000600B56</span> 8B <span class="number">55</span> FC                                mov     edx, [rbp-<span class="number">4</span>]</span><br><span class="line">.data:<span class="number">0000000000600B59</span> <span class="number">48</span> <span class="number">63</span> CA                                movsxd  rcx, edx</span><br><span class="line">.data:<span class="number">0000000000600B5C</span> <span class="number">48</span> 8B <span class="number">55</span> D8                             mov     rdx, [rbp-28h]</span><br><span class="line">.data:<span class="number">0000000000600B60</span> <span class="number">48</span> <span class="number">01</span> CA                                add     rdx, rcx</span><br><span class="line">.data:<span class="number">0000000000600B63</span> <span class="number">0F</span> B6 <span class="number">12</span>                                movzx   edx, byte ptr [rdx]</span><br><span class="line">.data:<span class="number">0000000000600B66</span> 8B 4D FC                                mov     ecx, [rbp-<span class="number">4</span>]</span><br><span class="line">.data:<span class="number">0000000000600B69</span> <span class="number">31</span> CA                                   xor     edx, ecx</span><br><span class="line">.data:<span class="number">0000000000600B6B</span> <span class="number">88</span> <span class="number">10</span>                                   mov     [rax], dl</span><br><span class="line">.data:<span class="number">0000000000600B6D</span> <span class="number">83</span> <span class="number">45</span> FC <span class="number">01</span>                             add     dword ptr [rbp-<span class="number">4</span>], <span class="number">1</span></span><br><span class="line">.data:<span class="number">0000000000600B71</span></span><br><span class="line">.data:<span class="number">0000000000600B71</span>                         loc_600B71:                             ; CODE XREF: .data:<span class="number">0000000000600B47</span>↑j</span><br><span class="line">.data:<span class="number">0000000000600B71</span> <span class="number">83</span> 7D FC <span class="number">0D</span>                             cmp     dword ptr [rbp-<span class="number">4</span>], <span class="number">13</span></span><br><span class="line">.data:<span class="number">0000000000600B75</span> 7E D2                                   jle     short loc_600B49</span><br><span class="line">.data:<span class="number">0000000000600B77</span> C7 <span class="number">45</span> FC <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                    mov     dword ptr [rbp-<span class="number">4</span>], <span class="number">0</span></span><br><span class="line">.data:<span class="number">0000000000600B7E</span> EB <span class="number">29</span>                                   jmp     short loc_600BA9</span><br><span class="line">.data:<span class="number">0000000000600B80</span>                         ; ---------------------------------------------------------------------------</span><br><span class="line">.data:<span class="number">0000000000600B80</span></span><br><span class="line">.data:<span class="number">0000000000600B80</span>                         loc_600B80:                             ; CODE XREF: .data:<span class="number">0000000000600BAD</span>↓j</span><br><span class="line">.data:<span class="number">0000000000600B80</span> 8B <span class="number">45</span> FC                                mov     eax, [rbp-<span class="number">4</span>]</span><br><span class="line">.data:<span class="number">0000000000600B83</span> <span class="number">48</span> <span class="number">63</span> D0                                movsxd  rdx, eax</span><br><span class="line">.data:<span class="number">0000000000600B86</span> <span class="number">48</span> 8B <span class="number">45</span> D8                             mov     rax, [rbp-28h]</span><br><span class="line">.data:<span class="number">0000000000600B8A</span> <span class="number">48</span> <span class="number">01</span> D0                                add     rax, rdx</span><br><span class="line">.data:<span class="number">0000000000600B8D</span> <span class="number">0F</span> B6 <span class="number">10</span>                                movzx   edx, byte ptr [rax]</span><br><span class="line">.data:<span class="number">0000000000600B90</span> 8B <span class="number">45</span> FC                                mov     eax, [rbp-<span class="number">4</span>]</span><br><span class="line">.data:<span class="number">0000000000600B93</span> <span class="number">48</span> <span class="number">98</span>                                   cdqe</span><br><span class="line">.data:<span class="number">0000000000600B95</span> <span class="number">0F</span> B6 <span class="number">44</span> <span class="number">05</span> E0                          movzx   eax, byte ptr [rbp+rax-20h]</span><br><span class="line">.data:<span class="number">0000000000600B9A</span> <span class="number">38</span> C2                                   cmp     dl, al</span><br><span class="line">.data:<span class="number">0000000000600B9C</span> <span class="number">74</span> <span class="number">07</span>                                   jz      short loc_600BA5</span><br><span class="line">.data:<span class="number">0000000000600B9E</span> B8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                          mov     eax, <span class="number">0</span></span><br><span class="line">.data:<span class="number">0000000000600BA3</span> EB <span class="number">0F</span>                                   jmp     short loc_600BB4</span><br><span class="line">.data:<span class="number">0000000000600BA5</span>                         ; ---------------------------------------------------------------------------</span><br><span class="line">.data:<span class="number">0000000000600BA5</span></span><br><span class="line">.data:<span class="number">0000000000600BA5</span>                         loc_600BA5:                             ; CODE XREF: .data:<span class="number">0000000000600B9C</span>↑j</span><br><span class="line">.data:<span class="number">0000000000600BA5</span> <span class="number">83</span> <span class="number">45</span> FC <span class="number">01</span>                             add     dword ptr [rbp-<span class="number">4</span>], <span class="number">1</span></span><br><span class="line">.data:<span class="number">0000000000600BA9</span></span><br><span class="line">.data:<span class="number">0000000000600BA9</span>                         loc_600BA9:                             ; CODE XREF: .data:<span class="number">0000000000600B7E</span>↑j</span><br><span class="line">.data:<span class="number">0000000000600BA9</span> <span class="number">83</span> 7D FC <span class="number">0D</span>                             cmp     dword ptr [rbp-<span class="number">4</span>], <span class="number">0Dh</span></span><br><span class="line">.data:<span class="number">0000000000600BAD</span> 7E D1                                   jle     short loc_600B80</span><br><span class="line">.data:<span class="number">0000000000600BAF</span> B8 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                          mov     eax, <span class="number">1</span></span><br><span class="line">.data:<span class="number">0000000000600BB4</span></span><br><span class="line">.data:<span class="number">0000000000600BB4</span>                         loc_600BB4:                             ; CODE XREF: .data:<span class="number">0000000000600BA3</span>↑j</span><br><span class="line">.data:<span class="number">0000000000600BB4</span> 5D                                      <span class="built_in">pop</span>     rbp</span><br><span class="line">.data:<span class="number">0000000000600BB5</span> C3                                      retn</span><br><span class="line">.data:<span class="number">0000000000600BB5</span>                         _data           ends</span><br></pre></td></tr></table></figure>
<p>发现IDA在f5的时候抛出错误，所以我们只能读懂汇编代码，汇编代码也不多</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="built_in">i</span>=<span class="number">0</span>;<span class="built_in">i</span>&lt;<span class="number">14</span>;<span class="built_in">i</span>++)</span><br><span class="line">&#123;</span><br><span class="line">	argv[<span class="built_in">i</span>]=argv[<span class="built_in">i</span>]^<span class="built_in">i</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">i</span>=<span class="number">0</span>;<span class="built_in">i</span>&lt;<span class="number">14</span>;<span class="built_in">i</span>++)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(argv[<span class="built_in">i</span>]!=current[<span class="built_in">i</span>])</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>生成flag：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">current = [<span class="number">0x66</span>,<span class="number">0x6D</span>,<span class="number">0x63</span>,<span class="number">0x64</span>,<span class="number">0x7F</span>,<span class="number">0x6B</span>,<span class="number">0x37</span>,<span class="number">0x64</span>,<span class="number">0x3B</span>,<span class="number">0x56</span>,<span class="number">0x60</span>,<span class="number">0x3B</span>,<span class="number">0x6E</span>,<span class="number">0x70</span>]</span><br><span class="line">for i <span class="keyword">in</span> range(len(current)):</span><br><span class="line">	print chr(current[i]^i),</span><br></pre></td></tr></table></figure>
<p>flag: flag{n1c3_j0b}</p>
<h3 id="easy-re"><a href="#easy-re" class="headerlink" title="easy_re"></a>easy_re</h3><p>file一下发现是32位ELF文件，然后用IDA打开发现好像是加过壳的。用DIE.exe来查一下发现改程序是经过UPX加壳后的程序，可以手动脱壳，也可以用UPX脱壳</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">➜  upx<span class="number">-3.91</span>-amd64_linux ./upx -d easy_re </span><br><span class="line">                       Ultimate Packer for eXecutables</span><br><span class="line">                          Copyright (C) <span class="number">1996</span> - <span class="number">2013</span></span><br><span class="line">UPX <span class="number">3.91</span>        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Sep <span class="number">30</span>th <span class="number">2013</span></span><br><span class="line"></span><br><span class="line">        File size         Ratio      Format      Name</span><br><span class="line">   --------------------   ------   -----------   -----------</span><br><span class="line">      <span class="number">7540</span> &lt;-      <span class="number">4352</span>   <span class="number">57.72</span>%    linux/<span class="number">386</span>    easy_re</span><br><span class="line"></span><br><span class="line">Unpacked <span class="number">1</span> file.</span><br><span class="line">➜  upx<span class="number">-3.91</span>-amd64_linux</span><br></pre></td></tr></table></figure>
<p>再用IDA打开就可以清晰的看出来代码流程了</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> pipedes[<span class="number">2</span>]; <span class="comment">// [esp+18h] [ebp-38h]</span></span><br><span class="line">  <span class="keyword">__pid_t</span> v5; <span class="comment">// [esp+20h] [ebp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+24h] [ebp-2Ch]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+2Eh] [ebp-22h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v8; <span class="comment">// [esp+4Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  pipe(pipedes);</span><br><span class="line">  v5 = fork();</span><br><span class="line">  <span class="keyword">if</span> ( !v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"\nOMG!!!! I forgot kid's id"</span>);</span><br><span class="line">    write(pipedes[<span class="number">1</span>], <span class="string">"69800876143568214356928753"</span>, <span class="number">0x1D</span>u);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Ready to exit     "</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  read(pipedes[<span class="number">0</span>], &amp;buf, <span class="number">0x1D</span>u);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v6);</span><br><span class="line">  <span class="keyword">if</span> ( v6 == v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (*(_DWORD *)((_BYTE *)lol + <span class="number">3</span>) &amp; <span class="number">0xFF</span>) == <span class="number">204</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">":D"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\nYou got the key\n "</span>);</span><br><span class="line">    lol(&amp;buf);</span><br><span class="line">  &#125;</span><br><span class="line">  wait(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="pipe-函数"><a href="#pipe-函数" class="headerlink" title="pipe()函数"></a>pipe()函数</h3><p>pipe函数是在linux编程上的一个函数，pipe是一种把两个进程之间的标准输入和标准输出连接起来的机制，从而提供一种让多个进程间通信的方法，当进程创建pipe时，每次都需要提供两个文件描述符来操作管道，其中一个进行写操作，另一个对管道进行读操作。对管道的读写与一般的IO系统函数一致，使用write()进行写入数据，使用read()读出数据.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pipe</span><span class="params">(<span class="keyword">int</span> filedes[<span class="number">2</span>])</span></span>;</span><br><span class="line"></span><br><span class="line">返回值：成功，返回<span class="number">0</span>，否则返回<span class="number">-1</span>。参数数组包含pipe使用的两个文件的描述符。fd[<span class="number">0</span>]:读管道，fd[<span class="number">1</span>]:写管道。</span><br></pre></td></tr></table></figure>
<p>在main函数中先是用pipe建立了一个管道，那么pipedes[1]就是写操作，pipedes[0]就是读操作。调用fork函数生成子进程，在子进程中将“69800876143568214356928753”送入管道中，然后退出子进程，进而在父进程中将管道中的字符串复制到buf变量中，然后入读一个数字，要求这个数字和子进程的PID一致才符合条件。lol函数是生成flag的函数。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl lol(_BYTE *<span class="built_in">a1</span>)</span><br><span class="line">&#123;</span><br><span class="line">  char v2<span class="comment">; // [esp+15h] [ebp-13h]</span></span><br><span class="line">  char v3<span class="comment">; // [esp+16h] [ebp-12h]</span></span><br><span class="line">  char v4<span class="comment">; // [esp+17h] [ebp-11h]</span></span><br><span class="line">  char v5<span class="comment">; // [esp+18h] [ebp-10h]</span></span><br><span class="line">  char v6<span class="comment">; // [esp+19h] [ebp-Fh]</span></span><br><span class="line">  char v7<span class="comment">; // [esp+1Ah] [ebp-Eh]</span></span><br><span class="line">  char v8<span class="comment">; // [esp+1Bh] [ebp-Dh]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">2</span> * <span class="built_in">a1</span>[<span class="number">1</span>]<span class="comment">;</span></span><br><span class="line">  v3 = <span class="built_in">a1</span>[<span class="number">4</span>] + <span class="built_in">a1</span>[<span class="number">5</span>]<span class="comment">;</span></span><br><span class="line">  v4 = <span class="built_in">a1</span>[<span class="number">8</span>] + <span class="built_in">a1</span>[<span class="number">9</span>]<span class="comment">;</span></span><br><span class="line">  v5 = <span class="number">2</span> * <span class="built_in">a1</span>[<span class="number">12</span>]<span class="comment">;</span></span><br><span class="line">  v6 = <span class="built_in">a1</span>[<span class="number">18</span>] + <span class="built_in">a1</span>[<span class="number">17</span>]<span class="comment">;</span></span><br><span class="line">  v7 = <span class="built_in">a1</span>[<span class="number">10</span>] + <span class="built_in">a1</span>[<span class="number">21</span>]<span class="comment">;</span></span><br><span class="line">  v8 = <span class="built_in">a1</span>[<span class="number">9</span>] + <span class="built_in">a1</span>[<span class="number">25</span>]<span class="comment">;</span></span><br><span class="line">  return printf(<span class="string">"flag_is_not_here"</span>)<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个函数的参数是buf变量，这个函数里面显示操作了这个字符串，最后输出了一句话，感觉不是太合乎情理，于是看汇编代码，发现隐藏了一部分代码：</p>
<p><img src="https://s2.ax1x.com/2019/02/24/k4vNX4.png" alt> </p>
<p>可以看出来左边的代码是将处理过的字符串输出了出来：<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">current = [<span class="number">0x36</span>,<span class="number">0x39</span>,<span class="number">0x38</span>,<span class="number">0x30</span>,<span class="number">0x30</span>,<span class="number">0x38</span>,<span class="number">0x37</span>,<span class="number">0x36</span>,<span class="number">0x31</span>,<span class="number">0x34</span>,<span class="number">0x33</span>,<span class="number">0x35</span>,<span class="number">0x36</span>,<span class="number">0x38</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x34</span>,<span class="number">0x33</span>,<span class="number">0x35</span>,<span class="number">0x36</span>,<span class="number">0x39</span>,<span class="number">0x32</span>,<span class="number">0x38</span>,<span class="number">0x37</span>,<span class="number">0x35</span>,<span class="number">0x33</span>]</span><br><span class="line"></span><br><span class="line">print chr(<span class="number">0x39</span>*<span class="number">2</span>),</span><br><span class="line">print chr(current[<span class="number">4</span>]+current[<span class="number">5</span>]),</span><br><span class="line">print chr(current[<span class="number">8</span>]+current[<span class="number">9</span>]),</span><br><span class="line">print chr(current[<span class="number">12</span>]*<span class="number">2</span>),</span><br><span class="line">print chr(current[<span class="number">18</span>]+current[<span class="number">17</span>]),</span><br><span class="line">print chr(current[<span class="number">10</span>]+current[<span class="number">21</span>]),</span><br><span class="line">print chr(current[<span class="number">9</span>]+current[<span class="number">25</span>]),</span><br><span class="line"></span><br><span class="line">out：</span><br><span class="line">rhelheg</span><br><span class="line">[Finished in <span class="number">0.0</span>s]</span><br></pre></td></tr></table></figure></p>
<h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><p>该程序是windows上的32位可执行文件，载入IDA中发现main函数中很复杂，通过查找字符串发现了几个相对醒目的字符串：</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?W?h?a?<span class="built_in">t</span> h?a?p?p?e?<span class="built_in">n</span>?</span><br><span class="line"><span class="symbol">C:</span>\Users\CSAW2016\haha\flag_dir\flag.txt</span><br><span class="line">Congrats You got it!</span><br><span class="line">=W=r=o=<span class="built_in">n</span>=g=K=e=y=</span><br><span class="line">string too long</span><br></pre></td></tr></table></figure>
<p>直接运行程序会返回：<br><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">➜</span>  <span class="string">.</span><span class="comment">/key</span><span class="string">.</span><span class="comment">exe</span></span><br><span class="line"><span class="comment">?W?h?a?t</span> <span class="comment">h?a?p?p?e?n?</span></span><br></pre></td></tr></table></figure></p>
<p>通过“C:\Users\CSAW2016\haha\flag_dir\flag.txt”找到引用这个字符串的地址我们可以发现该程序试图想从这个路径中读取数据，所以我们在本机上创建这个文件，然后再运行程序。</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  ./key.exe</span><br><span class="line">=W=r=o=<span class="built_in">n</span>=g=K=e=y=</span><br></pre></td></tr></table></figure>
<p>出现的和第一次不一样的输出，然后再看主函数：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">v13 = sub_1D20C0(&amp;v38, v11, v39, v12, v42);</span><br><span class="line"> v14 = <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"> <span class="keyword">if</span> ( v13 )</span><br><span class="line"> &#123;</span><br><span class="line">   v22 = <span class="string">"=W=r=o=n=g=K=e=y="</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line">   v15 = print(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"|------------------------------|"</span>);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v15, sub_1D2C50);</span><br><span class="line">   v16 = print(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"|==============================|"</span>);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v16, sub_1D2C50);</span><br><span class="line">   v17 = print(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"|==============================|"</span>);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v17, sub_1D2C50);</span><br><span class="line">   v18 = print(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"|==============================|"</span>);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v18, sub_1D2C50);</span><br><span class="line">   v19 = print(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"\\  /\\  /\\  /\\  /\\==============|"</span>);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v19, sub_1D2C50);</span><br><span class="line">   v20 = print(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">" \\/  \\/  \\/  \\/  \\=============|"</span>);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v20, sub_1D2C50);</span><br><span class="line">   v21 = print(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"                 |-------------|"</span>);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v21, sub_1D2C50);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::<span class="built_in">cout</span>, sub_1D2C50);</span><br><span class="line">   v14 = <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">   v22 = <span class="string">"Congrats You got it!"</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>要想使条件成立，那么需要v13不为0，v13是函数sub_1D20C0()的返回值，所以猜测这个函数是检查flag的函数，动态调试一下：<br><img src="https://s2.ax1x.com/2019/02/24/k5pNP1.jpg" alt><br>发现在调用这个函数之前，讲一个字符串压入了栈中，其实也就是flag。继续往下调试，发现了我们在文件中写的字符串：<br><img src="https://s2.ax1x.com/2019/02/24/k5p0KO.jpg" alt><br>进而发现对比的是我们输出的第一个和刚刚压入栈中字符串的第一个值，所以这里就可以断定刚刚的字符串就是flag。<br><img src="https://s2.ax1x.com/2019/02/24/k5pDqe.jpg" alt> </p>
<p>flag：idg_cni~bjbfi|gsxb</p>
<h3 id="reverse-box"><a href="#reverse-box" class="headerlink" title="reverse-box"></a>reverse-box</h3><p>在平台上题目描述不全，少了一个重要的提示信息</p>
<p>原题题目描述<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>./reverse_box <span class="variable">$&#123;</span>FLAG&#125;</span><br><span class="line"><span class="number">95</span>eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a</span><br></pre></td></tr></table></figure></p>
<p>也就是说，当输入争取的flag的时候，程序应该输出的是这一个字符串（如果少了这个信息，我请问怎么做，mmp）</p>
<p>主函数很简单：<br><img src="https://s2.ax1x.com/2019/05/14/EI6q3R.png" alt><br>会根据我们的输入当成索引在box里面输出对应的值</p>
<p>make_boxs函数：<br><img src="https://s2.ax1x.com/2019/05/14/EI6ju6.png" alt><br>根据时间中下srand的种子，然后生成一个随机数，然后把随机生成的这个数字带进去生成boxs的数据，可以看到，程序中将随机生成的种子转成了unsigned __int8类型，这个类型只有一个字节大小，所以范围是0～255,所以我们可以爆破一下，flag开头是“T”，对应的是0x95</p>
<p>第一处断点：0x80485b4<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">080485B4</span>                 cmp     [ebp+var_C], <span class="number">0</span></span><br><span class="line">.text:<span class="number">080485B8</span>                 jz      short loc_80485A7</span><br><span class="line">.text:<span class="number">080485BA</span>                 mov     eax, [ebp+var_C]</span><br></pre></td></tr></table></figure></p>
<p>断下之后将ebp-0xc的值变成0~255<br>第二处断点：0x8048704<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text:</span>080486FF                 <span class="keyword">movzx</span>   <span class="built_in">eax</span>, <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">esp</span>+<span class="built_in">eax</span>+<span class="number">1Ch</span>]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">08048704</span>                 <span class="keyword">movzx</span>   <span class="built_in">eax</span>, <span class="built_in">al</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">08048707</span>                 <span class="keyword">mov</span>     [<span class="built_in">esp</span>+<span class="number">4</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="symbol">.text:</span>0804870B                 <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">esp</span>], offset a02x <span class="comment">; "%02x"</span></span><br></pre></td></tr></table></figure></p>
<p>与输出的字符和0x95比较，若相等，则本次的box数据是正确的，将全部的数据输出出来<br>gdb脚本：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">set</span> <span class="variable">$i</span>=0</span><br><span class="line"><span class="builtin-name">set</span> <span class="variable">$total</span>=256</span><br><span class="line">b <span class="number">*0</span>x80485b4</span><br><span class="line">b <span class="number">*0</span>x8048704</span><br><span class="line"><span class="keyword">while</span> <span class="variable">$i</span>&lt;<span class="variable">$total</span></span><br><span class="line">  <span class="builtin-name">run</span> T</span><br><span class="line">  <span class="builtin-name">set</span> <span class="variable">$i</span>=<span class="variable">$i</span>+1</span><br><span class="line">  <span class="builtin-name">set</span> *(char*)(<span class="variable">$ebp</span>-0xc)=<span class="variable">$i</span></span><br><span class="line">  continue</span><br><span class="line">  <span class="keyword">if</span> <span class="variable">$eax</span>==0x95</span><br><span class="line">    x/256xb <span class="variable">$esp</span>+0x1c</span><br><span class="line">    <span class="builtin-name">set</span> <span class="variable">$i</span>=256</span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure></p>
<p>解题脚本：<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Breakpoint <span class="number">2</span>, <span class="number">0x08048704</span> <span class="keyword">in</span> ?? ()</span><br><span class="line"><span class="number">$1</span> = <span class="number">214</span></span><br><span class="line"><span class="number">0xffffd04c</span>:	<span class="number">0xd6</span>	<span class="number">0xc9</span>	<span class="number">0xc2</span>	<span class="number">0xce</span>	<span class="number">0x47</span>	<span class="number">0xde</span>	<span class="number">0xda</span>	<span class="number">0x70</span></span><br><span class="line"><span class="number">0xffffd054</span>:	<span class="number">0x85</span>	<span class="number">0xb4</span>	<span class="number">0xd2</span>	<span class="number">0x9e</span>	<span class="number">0x4b</span>	<span class="number">0x62</span>	<span class="number">0x1e</span>	<span class="number">0xc3</span></span><br><span class="line"><span class="number">0xffffd05c</span>:	<span class="number">0x7f</span>	<span class="number">0x37</span>	<span class="number">0x7c</span>	<span class="number">0xc8</span>	<span class="number">0x4f</span>	<span class="number">0xec</span>	<span class="number">0xf2</span>	<span class="number">0x45</span></span><br><span class="line"><span class="number">0xffffd064</span>:	<span class="number">0x18</span>	<span class="number">0x61</span>	<span class="number">0x17</span>	<span class="number">0x1a</span>	<span class="number">0x29</span>	<span class="number">0x11</span>	<span class="number">0xc7</span>	<span class="number">0x75</span></span><br><span class="line"><span class="number">0xffffd06c</span>:	<span class="number">0x02</span>	<span class="number">0x48</span>	<span class="number">0x26</span>	<span class="number">0x93</span>	<span class="number">0x83</span>	<span class="number">0x8a</span>	<span class="number">0x42</span>	<span class="number">0x79</span></span><br><span class="line"><span class="number">0xffffd074</span>:	<span class="number">0x81</span>	<span class="number">0x10</span>	<span class="number">0x50</span>	<span class="number">0x44</span>	<span class="number">0xc4</span>	<span class="number">0x6d</span>	<span class="number">0x84</span>	<span class="number">0xa0</span></span><br><span class="line"><span class="number">0xffffd07c</span>:	<span class="number">0xb1</span>	<span class="number">0x72</span>	<span class="number">0x96</span>	<span class="number">0x76</span>	<span class="number">0xad</span>	<span class="number">0x23</span>	<span class="number">0xb0</span>	<span class="number">0x2f</span></span><br><span class="line"><span class="number">0xffffd084</span>:	<span class="number">0xb2</span>	<span class="number">0xa7</span>	<span class="number">0x35</span>	<span class="number">0x57</span>	<span class="number">0x5e</span>	<span class="number">0x92</span>	<span class="number">0x07</span>	<span class="number">0xc0</span></span><br><span class="line"><span class="number">0xffffd08c</span>:	<span class="number">0xbc</span>	<span class="number">0x36</span>	<span class="number">0x99</span>	<span class="number">0xaf</span>	<span class="number">0xae</span>	<span class="number">0xdb</span>	<span class="number">0xef</span>	<span class="number">0x15</span></span><br><span class="line"><span class="number">0xffffd094</span>:	<span class="number">0xe7</span>	<span class="number">0x8e</span>	<span class="number">0x63</span>	<span class="number">0x06</span>	<span class="number">0x9c</span>	<span class="number">0x56</span>	<span class="number">0x9a</span>	<span class="number">0x31</span></span><br><span class="line"><span class="number">0xffffd09c</span>:	<span class="number">0xe6</span>	<span class="number">0x64</span>	<span class="number">0xb5</span>	<span class="number">0x58</span>	<span class="number">0x95</span>	<span class="number">0x49</span>	<span class="number">0x04</span>	<span class="number">0xee</span></span><br><span class="line"><span class="number">0xffffd0a4</span>:	<span class="number">0xdf</span>	<span class="number">0x7e</span>	<span class="number">0x0b</span>	<span class="number">0x8c</span>	<span class="number">0xff</span>	<span class="number">0xf9</span>	<span class="number">0xed</span>	<span class="number">0x7a</span></span><br><span class="line"><span class="number">0xffffd0ac</span>:	<span class="number">0x65</span>	<span class="number">0x5a</span>	<span class="number">0x1f</span>	<span class="number">0x4e</span>	<span class="number">0xf6</span>	<span class="number">0xf8</span>	<span class="number">0x86</span>	<span class="number">0x30</span></span><br><span class="line"><span class="number">0xffffd0b4</span>:	<span class="number">0xf0</span>	<span class="number">0x4c</span>	<span class="number">0xb7</span>	<span class="number">0xca</span>	<span class="number">0xe5</span>	<span class="number">0x89</span>	<span class="number">0x2a</span>	<span class="number">0x1d</span></span><br><span class="line"><span class="number">0xffffd0bc</span>:	<span class="number">0xe4</span>	<span class="number">0x16</span>	<span class="number">0xf5</span>	<span class="number">0x3a</span>	<span class="number">0x27</span>	<span class="number">0x28</span>	<span class="number">0x8d</span>	<span class="number">0x40</span></span><br><span class="line"><span class="number">0xffffd0c4</span>:	<span class="number">0x09</span>	<span class="number">0x03</span>	<span class="number">0x6f</span>	<span class="number">0x94</span>	<span class="number">0xa5</span>	<span class="number">0x4a</span>	<span class="number">0x46</span>	<span class="number">0x67</span></span><br><span class="line"><span class="number">0xffffd0cc</span>:	<span class="number">0x78</span>	<span class="number">0xb9</span>	<span class="number">0xa6</span>	<span class="number">0x59</span>	<span class="number">0xea</span>	<span class="number">0x22</span>	<span class="number">0xf1</span>	<span class="number">0xa2</span></span><br><span class="line"><span class="number">0xffffd0d4</span>:	<span class="number">0x71</span>	<span class="number">0x12</span>	<span class="number">0xcb</span>	<span class="number">0x88</span>	<span class="number">0xd1</span>	<span class="number">0xe8</span>	<span class="number">0xac</span>	<span class="number">0xc6</span></span><br><span class="line"><span class="number">0xffffd0dc</span>:	<span class="number">0xd5</span>	<span class="number">0x34</span>	<span class="number">0xfa</span>	<span class="number">0x69</span>	<span class="number">0x97</span>	<span class="number">0x9f</span>	<span class="number">0x25</span>	<span class="number">0x3d</span></span><br><span class="line"><span class="number">0xffffd0e4</span>:	<span class="number">0xf3</span>	<span class="number">0x5b</span>	<span class="number">0x0d</span>	<span class="number">0xa1</span>	<span class="number">0x6b</span>	<span class="number">0xeb</span>	<span class="number">0xbe</span>	<span class="number">0x6e</span></span><br><span class="line"><span class="number">0xffffd0ec</span>:	<span class="number">0x55</span>	<span class="number">0x87</span>	<span class="number">0x8f</span>	<span class="number">0xbf</span>	<span class="number">0xfc</span>	<span class="number">0xb3</span>	<span class="number">0x91</span>	<span class="number">0xe9</span></span><br><span class="line"><span class="number">0xffffd0f4</span>:	<span class="number">0x77</span>	<span class="number">0x66</span>	<span class="number">0x19</span>	<span class="number">0xd7</span>	<span class="number">0x24</span>	<span class="number">0x20</span>	<span class="number">0x51</span>	<span class="number">0xcc</span></span><br><span class="line"><span class="number">0xffffd0fc</span>:	<span class="number">0x52</span>	<span class="number">0x7d</span>	<span class="number">0x82</span>	<span class="number">0xd8</span>	<span class="number">0x38</span>	<span class="number">0x60</span>	<span class="number">0xfb</span>	<span class="number">0x1c</span></span><br><span class="line"><span class="number">0xffffd104</span>:	<span class="number">0xd9</span>	<span class="number">0xe3</span>	<span class="number">0x41</span>	<span class="number">0x5f</span>	<span class="number">0xd0</span>	<span class="number">0xcf</span>	<span class="number">0x1b</span>	<span class="number">0xbd</span></span><br><span class="line"><span class="number">0xffffd10c</span>:	<span class="number">0x0f</span>	<span class="number">0xcd</span>	<span class="number">0x90</span>	<span class="number">0x9b</span>	<span class="number">0xa9</span>	<span class="number">0x13</span>	<span class="number">0x01</span>	<span class="number">0x73</span></span><br><span class="line"><span class="number">0xffffd114</span>:	<span class="number">0x5d</span>	<span class="number">0x68</span>	<span class="number">0xc1</span>	<span class="number">0xaa</span>	<span class="number">0xfe</span>	<span class="number">0x08</span>	<span class="number">0x3e</span>	<span class="number">0x3f</span></span><br><span class="line"><span class="number">0xffffd11c</span>:	<span class="number">0xc5</span>	<span class="number">0x8b</span>	<span class="number">0x00</span>	<span class="number">0xd3</span>	<span class="number">0xfd</span>	<span class="number">0xb6</span>	<span class="number">0x43</span>	<span class="number">0xbb</span></span><br><span class="line"><span class="number">0xffffd124</span>:	<span class="number">0xd4</span>	<span class="number">0x80</span>	<span class="number">0xe2</span>	<span class="number">0x0c</span>	<span class="number">0x33</span>	<span class="number">0x74</span>	<span class="number">0xa8</span>	<span class="number">0x2b</span></span><br><span class="line"><span class="number">0xffffd12c</span>:	<span class="number">0x54</span>	<span class="number">0x4d</span>	<span class="number">0x2d</span>	<span class="number">0xa4</span>	<span class="number">0xdc</span>	<span class="number">0x6c</span>	<span class="number">0x3b</span>	<span class="number">0x21</span></span><br><span class="line"><span class="number">0xffffd134</span>:	<span class="number">0x2e</span>	<span class="number">0xab</span>	<span class="number">0x32</span>	<span class="number">0x5c</span>	<span class="number">0x7b</span>	<span class="number">0xe0</span>	<span class="number">0x9d</span>	<span class="number">0x6a</span></span><br><span class="line"><span class="number">0xffffd13c</span>:	<span class="number">0x39</span>	<span class="number">0x14</span>	<span class="number">0x3c</span>	<span class="number">0xb8</span>	<span class="number">0x0a</span>	<span class="number">0x53</span>	<span class="number">0xf7</span>	<span class="number">0xdd</span></span><br><span class="line"><span class="number">0xffffd144</span>:	<span class="number">0xf4</span>	<span class="number">0x2c</span>	<span class="number">0x98</span>	<span class="number">0xba</span>	<span class="number">0x05</span>	<span class="number">0xe1</span>	<span class="number">0x0e</span>	<span class="number">0xa3</span></span><br></pre></td></tr></table></figure></p>
<p>最后将flag还原出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">0xd6</span>,<span class="number">0xc9</span>,<span class="number">0xc2</span>,<span class="number">0xce</span>,<span class="number">0x47</span>,<span class="number">0xde</span>,<span class="number">0xda</span>,<span class="number">0x70</span>,<span class="number">0x85</span>,<span class="number">0xb4</span>,<span class="number">0xd2</span>,<span class="number">0x9e</span>,<span class="number">0x4b</span>,<span class="number">0x62</span>,<span class="number">0x1e</span>,<span class="number">0xc3</span>,<span class="number">0x7f</span>,<span class="number">0x37</span>,<span class="number">0x7c</span>,<span class="number">0xc8</span>,<span class="number">0x4f</span>,<span class="number">0xec</span>,<span class="number">0xf2</span>,<span class="number">0x45</span>,<span class="number">0x18</span>,<span class="number">0x61</span>,<span class="number">0x17</span>,<span class="number">0x1a</span>,<span class="number">0x29</span>,<span class="number">0x11</span>,<span class="number">0xc7</span>,<span class="number">0x75</span>,<span class="number">0x02</span>,<span class="number">0x48</span>,<span class="number">0x26</span>,<span class="number">0x93</span>,<span class="number">0x83</span>,<span class="number">0x8a</span>,<span class="number">0x42</span>,<span class="number">0x79</span>,<span class="number">0x81</span>,<span class="number">0x10</span>,<span class="number">0x50</span>,<span class="number">0x44</span>,<span class="number">0xc4</span>,<span class="number">0x6d</span>,<span class="number">0x84</span>,<span class="number">0xa0</span>,<span class="number">0xb1</span>,<span class="number">0x72</span>,<span class="number">0x96</span>,<span class="number">0x76</span>,<span class="number">0xad</span>,<span class="number">0x23</span>,<span class="number">0xb0</span>,<span class="number">0x2f</span>,<span class="number">0xb2</span>,<span class="number">0xa7</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0x5e</span>,<span class="number">0x92</span>,<span class="number">0x07</span>,<span class="number">0xc0</span>,<span class="number">0xbc</span>,<span class="number">0x36</span>,<span class="number">0x99</span>,<span class="number">0xaf</span>,<span class="number">0xae</span>,<span class="number">0xdb</span>,<span class="number">0xef</span>,<span class="number">0x15</span>,<span class="number">0xe7</span>,<span class="number">0x8e</span>,<span class="number">0x63</span>,<span class="number">0x06</span>,<span class="number">0x9c</span>,<span class="number">0x56</span>,<span class="number">0x9a</span>,<span class="number">0x31</span>,<span class="number">0xe6</span>,<span class="number">0x64</span>,<span class="number">0xb5</span>,<span class="number">0x58</span>,<span class="number">0x95</span>,<span class="number">0x49</span>,<span class="number">0x04</span>,<span class="number">0xee</span>,<span class="number">0xdf</span>,<span class="number">0x7e</span>,<span class="number">0x0b</span>,<span class="number">0x8c</span>,<span class="number">0xff</span>,<span class="number">0xf9</span>,<span class="number">0xed</span>,<span class="number">0x7a</span>,<span class="number">0x65</span>,<span class="number">0x5a</span>,<span class="number">0x1f</span>,<span class="number">0x4e</span>,<span class="number">0xf6</span>,<span class="number">0xf8</span>,<span class="number">0x86</span>,<span class="number">0x30</span>,<span class="number">0xf0</span>,<span class="number">0x4c</span>,<span class="number">0xb7</span>,<span class="number">0xca</span>,<span class="number">0xe5</span>,<span class="number">0x89</span>,<span class="number">0x2a</span>,<span class="number">0x1d</span>,<span class="number">0xe4</span>,<span class="number">0x16</span>,<span class="number">0xf5</span>,<span class="number">0x3a</span>,<span class="number">0x27</span>,<span class="number">0x28</span>,<span class="number">0x8d</span>,<span class="number">0x40</span>,<span class="number">0x09</span>,<span class="number">0x03</span>,<span class="number">0x6f</span>,<span class="number">0x94</span>,<span class="number">0xa5</span>,<span class="number">0x4a</span>,<span class="number">0x46</span>,<span class="number">0x67</span>,<span class="number">0x78</span>,<span class="number">0xb9</span>,<span class="number">0xa6</span>,<span class="number">0x59</span>,<span class="number">0xea</span>,<span class="number">0x22</span>,<span class="number">0xf1</span>,<span class="number">0xa2</span>,<span class="number">0x71</span>,<span class="number">0x12</span>,<span class="number">0xcb</span>,<span class="number">0x88</span>,<span class="number">0xd1</span>,<span class="number">0xe8</span>,<span class="number">0xac</span>,<span class="number">0xc6</span>,<span class="number">0xd5</span>,<span class="number">0x34</span>,<span class="number">0xfa</span>,<span class="number">0x69</span>,<span class="number">0x97</span>,<span class="number">0x9f</span>,<span class="number">0x25</span>,<span class="number">0x3d</span>,<span class="number">0xf3</span>,<span class="number">0x5b</span>,<span class="number">0x0d</span>,<span class="number">0xa1</span>,<span class="number">0x6b</span>,<span class="number">0xeb</span>,<span class="number">0xbe</span>,<span class="number">0x6e</span>,<span class="number">0x55</span>,<span class="number">0x87</span>,<span class="number">0x8f</span>,<span class="number">0xbf</span>,<span class="number">0xfc</span>,<span class="number">0xb3</span>,<span class="number">0x91</span>,<span class="number">0xe9</span>,<span class="number">0x77</span>,<span class="number">0x66</span>,<span class="number">0x19</span>,<span class="number">0xd7</span>,<span class="number">0x24</span>,<span class="number">0x20</span>,<span class="number">0x51</span>,<span class="number">0xcc</span>,<span class="number">0x52</span>,<span class="number">0x7d</span>,<span class="number">0x82</span>,<span class="number">0xd8</span>,<span class="number">0x38</span>,<span class="number">0x60</span>,<span class="number">0xfb</span>,<span class="number">0x1c</span>,<span class="number">0xd9</span>,<span class="number">0xe3</span>,<span class="number">0x41</span>,<span class="number">0x5f</span>,<span class="number">0xd0</span>,<span class="number">0xcf</span>,<span class="number">0x1b</span>,<span class="number">0xbd</span>,<span class="number">0x0f</span>,<span class="number">0xcd</span>,<span class="number">0x90</span>,<span class="number">0x9b</span>,<span class="number">0xa9</span>,<span class="number">0x13</span>,<span class="number">0x01</span>,<span class="number">0x73</span>,<span class="number">0x5d</span>,<span class="number">0x68</span>,<span class="number">0xc1</span>,<span class="number">0xaa</span>,<span class="number">0xfe</span>,<span class="number">0x08</span>,<span class="number">0x3e</span>,<span class="number">0x3f</span>,<span class="number">0xc5</span>,<span class="number">0x8b</span>,<span class="number">0x00</span>,<span class="number">0xd3</span>,<span class="number">0xfd</span>,<span class="number">0xb6</span>,<span class="number">0x43</span>,<span class="number">0xbb</span>,<span class="number">0xd4</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0x0c</span>,<span class="number">0x33</span>,<span class="number">0x74</span>,<span class="number">0xa8</span>,<span class="number">0x2b</span>,<span class="number">0x54</span>,<span class="number">0x4d</span>,<span class="number">0x2d</span>,<span class="number">0xa4</span>,<span class="number">0xdc</span>,<span class="number">0x6c</span>,<span class="number">0x3b</span>,<span class="number">0x21</span>,<span class="number">0x2e</span>,<span class="number">0xab</span>,<span class="number">0x32</span>,<span class="number">0x5c</span>,<span class="number">0x7b</span>,<span class="number">0xe0</span>,<span class="number">0x9d</span>,<span class="number">0x6a</span>,<span class="number">0x39</span>,<span class="number">0x14</span>,<span class="number">0x3c</span>,<span class="number">0xb8</span>,<span class="number">0x0a</span>,<span class="number">0x53</span>,<span class="number">0xf7</span>,<span class="number">0xdd</span>,<span class="number">0xf4</span>,<span class="number">0x2c</span>,<span class="number">0x98</span>,<span class="number">0xba</span>,<span class="number">0x05</span>,<span class="number">0xe1</span>,<span class="number">0x0e</span>,<span class="number">0xa3</span>]</span><br><span class="line"></span><br><span class="line">index = <span class="string">"95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a"</span></span><br><span class="line"><span class="comment">#https://docs.microsoft.com/zh-cn/previous-versions/s3f49ktz(v=vs.120)</span></span><br><span class="line">list1 = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,len(index),<span class="number">2</span>):</span><br><span class="line">	list1.append(eval(<span class="string">"0x"</span>+index[x:x+<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(list1)):</span><br><span class="line">	flag+=chr(data.index(list1[x]))</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<h3 id="zorropub"><a href="#zorropub" class="headerlink" title="zorropub"></a>zorropub</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(seq 1 65535); <span class="keyword">do</span> <span class="built_in">echo</span> -e <span class="string">"1\n<span class="variable">$i</span>"</span> | ./zorro_bin | grep -i nullcon ; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="CRACKME"><a href="#CRACKME" class="headerlink" title="CRACKME"></a>CRACKME</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">0x66</span>,<span class="number">0x31</span>,<span class="number">0x4B</span>,<span class="number">0x33</span>,<span class="number">0x7B</span>,<span class="number">0x63</span>,<span class="number">0x35</span>,<span class="number">0x3A</span>,<span class="number">0x65</span>,<span class="number">0x66</span>,<span class="number">0x6C</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x74</span>,<span class="number">0x34</span>,<span class="number">0x3B</span>,<span class="number">0x31</span>,<span class="number">0x74</span>,<span class="number">0x31</span>,<span class="number">0x7A</span>,<span class="number">0x61</span>,<span class="number">0x78</span>,<span class="number">0x70</span>,<span class="number">0x69</span>,<span class="number">0x6D</span>,<span class="number">0x39</span>,<span class="number">0x7D</span>,<span class="number">0x35</span>,<span class="number">0x2B</span>,<span class="number">0x3F</span>,<span class="number">0x67</span>,<span class="number">0x74</span>,<span class="number">0x75</span>,<span class="number">0x78</span>,<span class="number">0x3B</span>,<span class="number">0x3D</span>,<span class="number">0x76</span>,<span class="number">0x63</span>,<span class="number">0x39</span>,<span class="number">0x76</span>,<span class="number">0x7B</span>,<span class="number">0x76</span>,<span class="number">0x37</span>,<span class="number">0x2B</span>,<span class="number">0x62</span>,<span class="number">0x75</span>,<span class="number">0x68</span>,<span class="number">0x55</span>,<span class="number">0x7B</span>,<span class="number">0x62</span>,<span class="number">0x54</span>,<span class="number">0x3D</span>,<span class="number">0x2D</span>,<span class="number">0x61</span>,<span class="number">0x6D</span>,<span class="number">0x32</span>,<span class="number">0x71</span>,<span class="number">0x7D</span>,<span class="number">0x3D</span>,<span class="number">0x66</span>,<span class="number">0x68</span>,<span class="number">0x5B</span>,<span class="number">0x78</span>,<span class="number">0x6B</span>,<span class="number">0x7B</span>,<span class="number">0x79</span>,<span class="number">0x3F</span>,<span class="number">0x78</span>,<span class="number">0x72</span>,<span class="number">0x71</span>,<span class="number">0x65</span>,<span class="number">0x7B</span>,<span class="number">0x3F</span>,<span class="number">0x7D</span>,<span class="number">0x6C</span>,<span class="number">0x35</span>,<span class="number">0x2D</span>,<span class="number">0x73</span>,<span class="number">0x64</span>,<span class="number">0x32</span>,<span class="number">0x2D</span>,<span class="number">0x4D</span>,<span class="number">0x6F</span>,<span class="number">0x2B</span>,<span class="number">0x3A</span>,<span class="number">0x6A</span>,<span class="number">0x7B</span>,<span class="number">0x39</span>,<span class="number">0x3D</span>,<span class="number">0x73</span>,<span class="number">0x59</span>,<span class="number">0x5B</span>,<span class="number">0x64</span>,<span class="number">0x61</span>,<span class="number">0x6C</span>,<span class="number">0x76</span>,<span class="number">0x70</span>,<span class="number">0x78</span>,<span class="number">0x3F</span>,<span class="number">0x7A</span>,<span class="number">0x33</span>,<span class="number">0x7B</span>,<span class="number">0x3F</span>,<span class="number">0x6E</span>,<span class="number">0x6F</span>,<span class="number">0x7B</span>,<span class="number">0x5B</span>,<span class="number">0x6B</span>,<span class="number">0x35</span>,<span class="number">0x6C</span>,<span class="number">0x6C</span>,<span class="number">0x7B</span>,<span class="number">0x7A</span>,<span class="number">0x6A</span>,<span class="number">0x73</span>,<span class="number">0x75</span>,<span class="number">0x35</span>,<span class="number">0x5B</span>,<span class="number">0x6B</span>,<span class="number">0x66</span>,<span class="number">0x6C</span>,<span class="number">0x61</span>,<span class="number">0x2B</span>,<span class="number">0x72</span>,<span class="number">0x36</span>,<span class="number">0x5A</span>,<span class="number">0x67</span>,<span class="number">0x37</span>,<span class="number">0x32</span>,<span class="number">0x6F</span>,<span class="number">0x30</span>,<span class="number">0x73</span>,<span class="number">0x6B</span>,<span class="number">0x71</span>,<span class="number">0x36</span>,<span class="number">0x63</span>,<span class="number">0x47</span>,<span class="number">0x6C</span>,<span class="number">0x35</span>,<span class="number">0x63</span>,<span class="number">0x77</span>,<span class="number">0x5B</span>,<span class="number">0x3D</span>,<span class="number">0x64</span>,<span class="number">0x3F</span>,<span class="number">0x33</span>,<span class="number">0x76</span>,<span class="number">0x39</span>,<span class="number">0x71</span>,<span class="number">0x35</span>,<span class="number">0x2D</span>,<span class="number">0x76</span>,<span class="number">0x6B</span>,<span class="number">0x6A</span>,<span class="number">0x53</span>,<span class="number">0x76</span>,<span class="number">0x7B</span>,<span class="number">0x34</span>,<span class="number">0x73</span>,<span class="number">0x71</span>,<span class="number">0x74</span>,<span class="number">0x67</span>,<span class="number">0x3D</span>,<span class="number">0x66</span>,<span class="number">0x30</span>,<span class="number">0x63</span>,<span class="number">0x7A</span>,<span class="number">0x7B</span>,<span class="number">0x2B</span>,<span class="number">0x6A</span>,<span class="number">0x75</span>,<span class="number">0x72</span>,<span class="number">0x6A</span>,<span class="number">0x66</span>,<span class="number">0x6C</span>,<span class="number">0x5B</span>,<span class="number">0x74</span>,<span class="number">0x62</span>,<span class="number">0x5D</span>,<span class="number">0x6C</span>,<span class="number">0x72</span>,<span class="number">0x66</span>,<span class="number">0x46</span>,<span class="number">0x31</span>,<span class="number">0x3B</span>,<span class="number">0x32</span>,<span class="number">0x7D</span>,<span class="number">0x75</span>,<span class="number">0x64</span>,<span class="number">0x68</span>,<span class="number">0x62</span>,<span class="number">0x3F</span>,<span class="number">0x30</span>,<span class="number">0x67</span>,<span class="number">0x38</span>,<span class="number">0x7B</span>,<span class="number">0x6F</span>,<span class="number">0x6D</span>,<span class="number">0x3A</span>,<span class="number">0x54</span>,<span class="number">0x34</span>,<span class="number">0x64</span>,<span class="number">0x68</span>,<span class="number">0x3B</span>,<span class="number">0x7A</span>,<span class="number">0x3A</span>,<span class="number">0x6F</span>,<span class="number">0x7A</span>,<span class="number">0x2D</span>,<span class="number">0x44</span>,<span class="number">0x6E</span>,<span class="number">0x3D</span>,<span class="number">0x6D</span>,<span class="number">0x3D</span>,<span class="number">0x75</span>,<span class="number">0x78</span>,<span class="number">0x3B</span>,<span class="number">0x6F</span>,<span class="number">0x5B</span>,<span class="number">0x67</span>,<span class="number">0x73</span>,<span class="number">0x39</span>,<span class="number">0x7B</span>,<span class="number">0x2B</span>,<span class="number">0x7A</span>,<span class="number">0x71</span>,<span class="number">0x78</span>,<span class="number">0x2B</span>,<span class="number">0x73</span>,<span class="number">0x71</span>,<span class="number">0x2D</span>,<span class="number">0x64</span>,<span class="number">0x73</span>,<span class="number">0x78</span>,<span class="number">0x63</span>,<span class="number">0x74</span>,<span class="number">0x63</span>,<span class="number">0x76</span>,<span class="number">0x79</span>,<span class="number">0x6B</span>,<span class="number">0x55</span>,<span class="number">0x73</span>,<span class="number">0x32</span>,<span class="number">0x6F</span>,<span class="number">0x64</span>,<span class="number">0x64</span>,<span class="number">0x72</span>,<span class="number">0x74</span>,<span class="number">0x34</span>,<span class="number">0x33</span>,<span class="number">0x70</span>,<span class="number">0x77</span>,<span class="number">0x76</span>,<span class="number">0x3A</span>,<span class="number">0x66</span>,<span class="number">0x30</span>,<span class="number">0x3B</span>,<span class="number">0x6E</span>,<span class="number">0x6A</span>,<span class="number">0x6B</span>,<span class="number">0x72</span>,<span class="number">0x62</span>,<span class="number">0x39</span>,<span class="number">0x6C</span>,<span class="number">0x6F</span>,<span class="number">0x73</span>,<span class="number">0x36</span>,<span class="number">0x67</span>,<span class="number">0x30</span>,<span class="number">0x7B</span>,<span class="number">0x69</span>,<span class="number">0x68</span>,<span class="number">0x3F</span>,<span class="number">0x72</span>,<span class="number">0x71</span>,<span class="number">0x61</span>,<span class="number">0x6E</span>,<span class="number">0x74</span>,<span class="number">0x66</span>,<span class="number">0x78</span>,<span class="number">0x24</span>,<span class="number">0x73</span>,<span class="number">0x73</span>,<span class="number">0x6C</span>,<span class="number">0x71</span>,<span class="number">0x64</span>,<span class="number">0x3A</span>,<span class="number">0x72</span>,<span class="number">0x76</span>,<span class="number">0x71</span>,<span class="number">0x69</span>,<span class="number">0x78</span>,<span class="number">0x72</span>,<span class="number">0x3B</span>,<span class="number">0x6A</span>,<span class="number">0x7B</span>,<span class="number">0x3F</span>,<span class="number">0x6F</span>,<span class="number">0x3A</span>,<span class="number">0x73</span>,<span class="number">0x6E</span>,<span class="number">0x2B</span>,<span class="number">0x5B</span>,<span class="number">0x69</span>,<span class="number">0x5B</span>,<span class="number">0x79</span>,<span class="number">0x41</span>,<span class="number">0x31</span>,<span class="number">0x31</span>,<span class="number">0x3B</span>,<span class="number">0x67</span>,<span class="number">0x73</span>,<span class="number">0x6D</span>,<span class="number">0x72</span>,<span class="number">0x38</span>,<span class="number">0x6C</span>,<span class="number">0x6D</span>,<span class="number">0x30</span>,<span class="number">0x3F</span>,<span class="number">0x33</span>,<span class="number">0x7D</span>,<span class="number">0x3B</span>,<span class="number">0x2B</span>,<span class="number">0x69</span>,<span class="number">0x76</span>,<span class="number">0x2B</span>,<span class="number">0x54</span>,<span class="number">0x66</span>,<span class="number">0x3A</span>,<span class="number">0x34</span>,<span class="number">0x47</span>,<span class="number">0x74</span>,<span class="number">0x76</span>,<span class="number">0x32</span>,<span class="number">0x3A</span>,<span class="number">0x2D</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0x75</span>,<span class="number">0x70</span>,<span class="number">0x69</span>,<span class="number">0x30</span>,<span class="number">0x5D</span>,<span class="number">0x37</span>,<span class="number">0x3F</span>,<span class="number">0x37</span>,<span class="number">0x37</span>,<span class="number">0x3D</span>,<span class="number">0x3B</span>,<span class="number">0x71</span>,<span class="number">0x7A</span>,<span class="number">0x78</span>,<span class="number">0x7B</span>,<span class="number">0x6D</span>,<span class="number">0x2D</span>,<span class="number">0x57</span>,<span class="number">0x3B</span>,<span class="number">0x30</span>,<span class="number">0x76</span>,<span class="number">0x74</span>,<span class="number">0x75</span>,<span class="number">0x65</span>,<span class="number">0x68</span>,<span class="number">0x5D</span>,<span class="number">0x6B</span>,<span class="number">0x6F</span>,<span class="number">0x38</span>,<span class="number">0x64</span>,<span class="number">0x3F</span>,<span class="number">0x3D</span>,<span class="number">0x77</span>,<span class="number">0x3A</span>,<span class="number">0x66</span>,<span class="number">0x62</span>,<span class="number">0x68</span>,<span class="number">0x64</span>,<span class="number">0x7B</span>,<span class="number">0x45</span>,<span class="number">0x3A</span>,<span class="number">0x3B</span>,<span class="number">0x31</span>,<span class="number">0x39</span>,<span class="number">0x3F</span>,<span class="number">0x70</span>,<span class="number">0x3D</span>,<span class="number">0x6B</span>,<span class="number">0x3A</span>,<span class="number">0x62</span>,<span class="number">0x2B</span>,<span class="number">0x7D</span>,<span class="number">0x64</span>,<span class="number">0x6F</span>,<span class="number">0x68</span>,<span class="number">0x74</span>,<span class="number">0x36</span>,<span class="number">0x77</span>,<span class="number">0x70</span>,<span class="number">0x45</span>,<span class="number">0x71</span>,<span class="number">0x2D</span>,<span class="number">0x7A</span>,<span class="number">0x5D</span>,<span class="number">0x32</span>,<span class="number">0x71</span>,<span class="number">0x62</span>,<span class="number">0x56</span>,<span class="number">0x31</span>,<span class="number">0x7D</span>,<span class="number">0x64</span>,<span class="number">0x68</span>,<span class="number">0x34</span>,<span class="number">0x31</span>,<span class="number">0x36</span>,<span class="number">0x71</span>,<span class="number">0x77</span>,<span class="number">0x39</span>,<span class="number">0x3A</span>,<span class="number">0x78</span>,<span class="number">0x6D</span>,<span class="number">0x5B</span>,<span class="number">0x3B</span>,<span class="number">0x65</span>,<span class="number">0x64</span>,<span class="number">0x3B</span>,<span class="number">0x3A</span>,<span class="number">0x65</span>,<span class="number">0x63</span>,<span class="number">0x62</span>,<span class="number">0x2D</span>,<span class="number">0x30</span>,<span class="number">0x3A</span>,<span class="number">0x6E</span>,<span class="number">0x69</span>,<span class="number">0x2D</span>,<span class="number">0x73</span>,<span class="number">0x34</span>,<span class="number">0x75</span>,<span class="number">0x32</span>,<span class="number">0x6B</span>,<span class="number">0x66</span>,<span class="number">0x36</span>,<span class="number">0x5D</span>,<span class="number">0x32</span>,<span class="number">0x77</span>,<span class="number">0x6E</span>,<span class="number">0x34</span>,<span class="number">0x35</span>,<span class="number">0x61</span>,<span class="number">0x6D</span>,<span class="number">0x7A</span>,<span class="number">0x6A</span>,<span class="number">0x72</span>,<span class="number">0x75</span>,<span class="number">0x6E</span>,<span class="number">0x3D</span>,<span class="number">0x6F</span>,<span class="number">0x66</span>,<span class="number">0x6B</span>,<span class="number">0x78</span>,<span class="number">0x2D</span>,<span class="number">0x3D</span>,<span class="number">0x68</span>,<span class="number">0x6D</span>,<span class="number">0x67</span>,<span class="number">0x6F</span>,<span class="number">0x2D</span>,<span class="number">0x6C</span>,<span class="number">0x7A</span>,<span class="number">0x3B</span>,<span class="number">0x6A</span>,<span class="number">0x39</span>,<span class="number">0x30</span>,<span class="number">0x39</span>,<span class="number">0x3D</span>,<span class="number">0x72</span>,<span class="number">0x6D</span>,<span class="number">0x6F</span>,<span class="number">0x37</span>,<span class="number">0x78</span>,<span class="number">0x63</span>,<span class="number">0x6A</span>,<span class="number">0x34</span>,<span class="number">0x6C</span>,<span class="number">0x65</span>,<span class="number">0x30</span>,<span class="number">0x68</span>,<span class="number">0x78</span>,<span class="number">0x73</span>,<span class="number">0x5B</span>,<span class="number">0x69</span>,<span class="number">0x5D</span>,<span class="number">0x2D</span>,<span class="number">0x76</span>,<span class="number">0x6A</span>,<span class="number">0x6C</span>,<span class="number">0x5B</span>,<span class="number">0x3F</span>,<span class="number">0x6F</span>,<span class="number">0x31</span>,<span class="number">0x32</span>,<span class="number">0x3A</span>,<span class="number">0x73</span>,<span class="number">0x76</span>,<span class="number">0x34</span>,<span class="number">0x75</span>,<span class="number">0x70</span>,<span class="number">0x69</span>,<span class="number">0x6F</span>,<span class="number">0x37</span>,<span class="number">0x6D</span>,<span class="number">0x61</span>,<span class="number">0x31</span>,<span class="number">0x68</span>,<span class="number">0x52</span>,<span class="number">0x79</span>,<span class="number">0x37</span>,<span class="number">0x35</span>,<span class="number">0x35</span>,<span class="number">0x36</span>,<span class="number">0x2B</span>,<span class="number">0x35</span>,<span class="number">0x37</span>,<span class="number">0x6B</span>,<span class="number">0x72</span>,<span class="number">0x65</span>,<span class="number">0x76</span>,<span class="number">0x3A</span>,<span class="number">0x68</span>,<span class="number">0x4C</span>,<span class="number">0x51</span>,<span class="number">0x2B</span>,<span class="number">0x31</span>,<span class="number">0x63</span>,<span class="number">0x78</span>,<span class="number">0x36</span>,<span class="number">0x35</span>,<span class="number">0x7A</span>,<span class="number">0x35</span>,<span class="number">0x76</span>,<span class="number">0x35</span>,<span class="number">0x5D</span>,<span class="number">0x3B</span>,<span class="number">0x36</span>,<span class="number">0x6E</span>,<span class="number">0x3D</span>,<span class="number">0x5B</span>,<span class="number">0x70</span>,<span class="number">0x38</span>,<span class="number">0x33</span>,<span class="number">0x3B</span>,<span class="number">0x6E</span>,<span class="number">0x3D</span>,<span class="number">0x7B</span>,<span class="number">0x7A</span>,<span class="number">0x6D</span>,<span class="number">0x7B</span>,<span class="number">0x6B</span>,<span class="number">0x32</span>,<span class="number">0x70</span>]</span><br><span class="line">v5 = <span class="number">0</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line">for x <span class="keyword">in</span> range(<span class="number">33</span>):</span><br><span class="line">	flag+=chr(data[v5-<span class="number">1</span>+<span class="number">1</span>])</span><br><span class="line">	v5 = v5+<span class="number">10</span></span><br><span class="line">print flag</span><br><span class="line">#flag&#123;The-Y3ll0w-turb4ns-Upri$ing&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ReverseMe-120"><a href="#ReverseMe-120" class="headerlink" title="ReverseMe-120"></a>ReverseMe-120</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">data = <span class="string">"you_know_how_to_remove_junk_code"</span></span><br><span class="line"><span class="comment"># for x in data:</span></span><br><span class="line"><span class="comment"># 	print chr(ord(x)^0x25),</span></span><br><span class="line"><span class="keyword">print</span> base64.b64encode(<span class="string">"\JPzNKJRzMJRzQJzW@HJS@zOPKNzFJA@"</span>)</span><br><span class="line"><span class="keyword">print</span> base64.b64encode(<span class="string">"\xD7\x6d\xf8\xe7\xae\xfc"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="easyre-153"><a href="#easyre-153" class="headerlink" title="easyre-153"></a>easyre-153</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="string">"69800876143568214356928753"</span></span><br><span class="line"></span><br><span class="line">flag = data[<span class="number">1</span>]+data[<span class="number">1</span>]+data[<span class="number">4</span>]+data[<span class="number">5</span>]+data[<span class="number">8</span>]+data[<span class="number">9</span>]+data[<span class="number">12</span>]+data[<span class="number">12</span>]+data[<span class="number">18</span>]+data[<span class="number">17</span>]+data[<span class="number">10</span>]+data[<span class="number">21</span>]+data[<span class="number">9</span>]+data[<span class="number">25</span>]</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="keyword">print</span> chr(ord(<span class="string">"9"</span>)*<span class="number">2</span>),</span><br><span class="line"><span class="keyword">print</span> chr(ord(<span class="string">"0"</span>)+ord(<span class="string">"8"</span>)),</span><br><span class="line"><span class="keyword">print</span> chr(ord(<span class="string">"1"</span>)+ord(<span class="string">"4"</span>)),</span><br><span class="line"><span class="keyword">print</span> chr(ord(<span class="string">"6"</span>)+ord(<span class="string">"6"</span>)),</span><br><span class="line"><span class="keyword">print</span> chr(ord(<span class="string">"5"</span>)+ord(<span class="string">"3"</span>)),</span><br><span class="line"><span class="keyword">print</span> chr(ord(<span class="string">"3"</span>)+ord(<span class="string">"2"</span>)),</span><br><span class="line"><span class="keyword">print</span> chr(ord(<span class="string">"4"</span>)+ord(<span class="string">"3"</span>)),</span><br><span class="line"><span class="comment">#rhelheg</span></span><br></pre></td></tr></table></figure>
<h3 id="notsequence"><a href="#notsequence" class="headerlink" title="notsequence"></a>notsequence</h3><p>用IDA打开后发现有两个check函数，第一个check函数是限制表达式的值，第二个check函数是限制表达式的关系</p>
<p>通过C语言来打印出具体的下标值<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">	int </span>i,v6,v4,v3;</span><br><span class="line">	v6=0;</span><br><span class="line">	for(i=1;i&lt;20;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		v4=0;</span><br><span class="line">		v3=i-1;</span><br><span class="line">		while(19&gt;v3)</span><br><span class="line">		&#123;</span><br><span class="line">			</span><br><span class="line">			printf(<span class="string">"var_%d+"</span>, (v3*(v3+1))/2+v6);</span><br><span class="line">			</span><br><span class="line">			v3++;</span><br><span class="line">		&#125;</span><br><span class="line">		printf(<span class="string">"==var_%d\n"</span>,(v3*(v3+1))/2 +i );</span><br><span class="line">		v6++;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="built_in">	return </span>0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">	int </span>i,j,v3,v5;</span><br><span class="line">	v5=0;</span><br><span class="line">	for(i=0;i&lt;=1024;i=(v5*(v5+1))/2)</span><br><span class="line">	&#123;</span><br><span class="line">		v3=0;</span><br><span class="line">		for(j=0;j&lt;=v5;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			printf(<span class="string">"%d "</span>,i+j );</span><br><span class="line">		&#125;</span><br><span class="line">		printf(<span class="string">" = %d\n"</span>,1&lt;&lt;v5 );</span><br><span class="line">		v5++;</span><br><span class="line">		if(v5==20)</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="built_in">	return </span>0;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="built_in">	return </span>0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>尝试用Z3来解，发现解不出来，emmm<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">var_0 = Int(<span class="string">'var_0'</span>)</span><br><span class="line">……</span><br><span class="line">var_209 = Int(<span class="string">'var_209'</span>)</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line">solver.add(var_0+var_1+var_3+var_6+var_10+var_15+var_21+var_28+var_36+var_45+var_55+var_66+var_78+var_91+var_105+var_120+var_136+var_153+var_171==var_191)</span><br><span class="line">solver.add(var_2+var_4+var_7+var_11+var_16+var_22+var_29+var_37+var_46+var_56+var_67+var_79+var_92+var_106+var_121+var_137+var_154+var_172==var_192)</span><br><span class="line">solver.add(var_5+var_8+var_12+var_17+var_23+var_30+var_38+var_47+var_57+var_68+var_80+var_93+var_107+var_122+var_138+var_155+var_173==var_193)</span><br><span class="line">solver.add(var_9+var_13+var_18+var_24+var_31+var_39+var_48+var_58+var_69+var_81+var_94+var_108+var_123+var_139+var_156+var_174==var_194)</span><br><span class="line">solver.add(var_14+var_19+var_25+var_32+var_40+var_49+var_59+var_70+var_82+var_95+var_109+var_124+var_140+var_157+var_175==var_195)</span><br><span class="line">solver.add(var_20+var_26+var_33+var_41+var_50+var_60+var_71+var_83+var_96+var_110+var_125+var_141+var_158+var_176==var_196)</span><br><span class="line">solver.add(var_27+var_34+var_42+var_51+var_61+var_72+var_84+var_97+var_111+var_126+var_142+var_159+var_177==var_197)</span><br><span class="line">solver.add(var_35+var_43+var_52+var_62+var_73+var_85+var_98+var_112+var_127+var_143+var_160+var_178==var_198)</span><br><span class="line">solver.add(var_44+var_53+var_63+var_74+var_86+var_99+var_113+var_128+var_144+var_161+var_179==var_199)</span><br><span class="line">solver.add(var_54+var_64+var_75+var_87+var_100+var_114+var_129+var_145+var_162+var_180==var_200)</span><br><span class="line">solver.add(var_65+var_76+var_88+var_101+var_115+var_130+var_146+var_163+var_181==var_201)</span><br><span class="line">solver.add(var_77+var_89+var_102+var_116+var_131+var_147+var_164+var_182==var_202)</span><br><span class="line">solver.add(var_90+var_103+var_117+var_132+var_148+var_165+var_183==var_203)</span><br><span class="line">solver.add(var_104+var_118+var_133+var_149+var_166+var_184==var_204)</span><br><span class="line">solver.add(var_119+var_134+var_150+var_167+var_185==var_205)</span><br><span class="line">solver.add(var_135+var_151+var_168+var_186==var_206)</span><br><span class="line">solver.add(var_152+var_169+var_187==var_207)</span><br><span class="line">solver.add(var_170+var_188==var_208)</span><br><span class="line">solver.add(var_189==var_209)</span><br><span class="line"></span><br><span class="line">solver.add(var_0==<span class="number">1</span>)</span><br><span class="line">solver.add(var_1+var_2==<span class="number">2</span>)</span><br><span class="line">solver.add(var_3+var_4+var_5==<span class="number">4</span>)</span><br><span class="line">solver.add(var_6+var_7+var_8+var_9==<span class="number">8</span>)</span><br><span class="line">solver.add(var_10+var_11+var_12+var_13+var_14==<span class="number">16</span>)</span><br><span class="line">solver.add(var_15+var_16+var_17+var_18+var_19+var_20==<span class="number">32</span>)</span><br><span class="line">solver.add(var_21+var_22+var_23+var_24+var_25+var_26+var_27==<span class="number">64</span>)</span><br><span class="line">solver.add(var_28+var_29+var_30+var_31+var_32+var_33+var_34+var_35==<span class="number">128</span>)</span><br><span class="line">solver.add(var_36+var_37+var_38+var_39+var_40+var_41+var_42+var_43+var_44==<span class="number">256</span>)</span><br><span class="line">solver.add(var_45+var_46+var_47+var_48+var_49+var_50+var_51+var_52+var_53+var_54==<span class="number">512</span>)</span><br><span class="line">solver.add(var_55+var_56+var_57+var_58+var_59+var_60+var_61+var_62+var_63+var_64+var_65==<span class="number">1024</span>)</span><br><span class="line">solver.add(var_66+var_67+var_68+var_69+var_70+var_71+var_72+var_73+var_74+var_75+var_76+var_77==<span class="number">2048</span>)</span><br><span class="line">solver.add(var_78+var_79+var_80+var_81+var_82+var_83+var_84+var_85+var_86+var_87+var_88+var_89+var_90==<span class="number">4096</span>)</span><br><span class="line">solver.add(var_91+var_92+var_93+var_94+var_95+var_96+var_97+var_98+var_99+var_100+var_101+var_102+var_103+var_104==<span class="number">8192</span>)</span><br><span class="line">solver.add(var_105+var_106+var_107+var_108+var_109+var_110+var_111+var_112+var_113+var_114+var_115+var_116+var_117+var_118+var_119==<span class="number">16384</span>)</span><br><span class="line">solver.add(var_120+var_121+var_122+var_123+var_124+var_125+var_126+var_127+var_128+var_129+var_130+var_131+var_132+var_133+var_134+var_135==<span class="number">32768</span>)</span><br><span class="line">solver.add(var_136+var_137+var_138+var_139+var_140+var_141+var_142+var_143+var_144+var_145+var_146+var_147+var_148+var_149+var_150+var_151+var_152==<span class="number">65536</span>)</span><br><span class="line">solver.add(var_153+var_154+var_155+var_156+var_157+var_158+var_159+var_160+var_161+var_162+var_163+var_164+var_165+var_166+var_167+var_168+var_169+var_170==<span class="number">131072</span>)</span><br><span class="line">solver.add(var_171+var_172+var_173+var_174+var_175+var_176+var_177+var_178+var_179+var_180+var_181+var_182+var_183+var_184+var_185+var_186+var_187+var_188+var_189==<span class="number">262144</span>)</span><br><span class="line">solver.add(var_190+var_191+var_192+var_193+var_194+var_195+var_196+var_197+var_198+var_199+var_200+var_201+var_202+var_203+var_204+var_205+var_206+var_207+var_208+var_209==<span class="number">524288</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> solver.check()</span><br><span class="line"><span class="keyword">print</span> solver.model()</span><br></pre></td></tr></table></figure></p>
<p>然后发现表达式的关系是杨辉三角</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">def <span class="title">yhsj</span>(<span class="params">max</span>):</span></span><br><span class="line"><span class="function">    n</span>=<span class="number">0</span></span><br><span class="line">    row = [<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">while</span> (n&lt;max):</span><br><span class="line">        n+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">yield</span>(row)</span><br><span class="line">        row = [<span class="number">1</span>] + [row[k] + row[k + <span class="number">1</span>] <span class="function"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="title">range</span>(<span class="params">len(row</span>) - 1)] + [1]</span></span><br><span class="line"><span class="function">y</span>=yhsj(<span class="number">20</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> y:</span><br><span class="line">    print(i)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> <span class="keyword">out</span>：</span><br><span class="line"> [<span class="meta">1</span>]</span><br><span class="line">[<span class="meta">1, 1</span>]</span><br><span class="line">[<span class="meta">1, 2, 1</span>]</span><br><span class="line">[<span class="meta">1, 3, 3, 1</span>]</span><br><span class="line">[<span class="meta">1, 4, 6, 4, 1</span>]</span><br><span class="line">[<span class="meta">1, 5, 10, 10, 5, 1</span>]</span><br><span class="line">[<span class="meta">1, 6, 15, 20, 15, 6, 1</span>]</span><br><span class="line">[<span class="meta">1, 7, 21, 35, 35, 21, 7, 1</span>]</span><br><span class="line">[<span class="meta">1, 8, 28, 56, 70, 56, 28, 8, 1</span>]</span><br><span class="line">[<span class="meta">1, 9, 36, 84, 126, 126, 84, 36, 9, 1</span>]</span><br><span class="line">[<span class="meta">1, 10, 45, 120, 210, 252, 210, 120, 45, 10, 1</span>]</span><br><span class="line">[<span class="meta">1, 11, 55, 165, 330, 462, 462, 330, 165, 55, 11, 1</span>]</span><br><span class="line">[<span class="meta">1, 12, 66, 220, 495, 792, 924, 792, 495, 220, 66, 12, 1</span>]</span><br><span class="line">[<span class="meta">1, 13, 78, 286, 715, 1287, 1716, 1716, 1287, 715, 286, 78, 13, 1</span>]</span><br><span class="line">[<span class="meta">1, 14, 91, 364, 1001, 2002, 3003, 3432, 3003, 2002, 1001, 364, 91, 14, 1</span>]</span><br><span class="line">[<span class="meta">1, 15, 105, 455, 1365, 3003, 5005, 6435, 6435, 5005, 3003, 1365, 455, 105, 15, 1</span>]</span><br><span class="line">[<span class="meta">1, 16, 120, 560, 1820, 4368, 8008, 11440, 12870, 11440, 8008, 4368, 1820, 560, 120, 16, 1</span>]</span><br><span class="line">[<span class="meta">1, 17, 136, 680, 2380, 6188, 12376, 19448, 24310, 24310, 19448, 12376, 6188, 2380, 680, 136, 17, 1</span>]</span><br><span class="line">[<span class="meta">1, 18, 153, 816, 3060, 8568, 18564, 31824, 43758, 48620, 43758, 31824, 18564, 8568, 3060, 816, 153, 18, 1</span>]</span><br><span class="line">[<span class="meta">1, 19, 171, 969, 3876, 11628, 27132, 50388, 75582, 92378, 92378, 75582, 50388, 27132, 11628, 3876, 969, 171, 19, 1</span>]</span><br></pre></td></tr></table></figure>
<p>最后将md5加密即可<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1111211331146411510105116152015611721353521711828567056288119368412612684369111045120210252210120451011115516533046246233016555111112662204957929247924952206612111378286715128717161716128771528678131114913641001200230033432300320021001364911411151054551365300350056435643550053003136545510515111612056018204368800811440128701144080084368182056012016111713668023806188123761944824310243101944812376618823806801361711181538163060856818564318244375848620437583182418564856830608161531811191719693876116282713250388755829237892378755825038827132116283876969171191</span></span><br></pre></td></tr></table></figure></p>

        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        转发请备注<a href="“https://luobuming.github.io”">一筐萝卜</a>的个人博客 <br>
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
       </p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
